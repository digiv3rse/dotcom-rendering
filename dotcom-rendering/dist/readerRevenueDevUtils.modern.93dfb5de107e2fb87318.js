"use strict";(self.webpackChunk_guardian_dotcom_rendering=self.webpackChunk_guardian_dotcom_rendering||[]).push([[2509],{9658:(e,t,n)=>{n.d(t,{Hs:()=>i,Jt:()=>a,n1:()=>r});const o="gu.alreadyVisited",r=()=>{var e;const t=parseInt(null!==(e=localStorage.getItem(o))&&void 0!==e?e:"",10);return Number.isNaN(t)?0:t},a=e=>{localStorage.setItem(o,e.toString())},i=()=>{const e=r();a(e+1)}},4914:(e,t,n)=>{n.d(t,{Am:()=>U,BQ:()=>h,C6:()=>s,CC:()=>m,G9:()=>T,H2:()=>y,K3:()=>u,Pl:()=>M,S9:()=>S,T0:()=>v,Ty:()=>l,ZD:()=>D,cs:()=>R,nh:()=>P,qQ:()=>f,qw:()=>b,tq:()=>w,y0:()=>d});var o=n(8706),r=n(1614),a=n(3904),i=n(3179),c=n(7410);const s="gu_hide_support_messaging",l="gu_recurring_contributor",u="gu.contributions.recurring.contrib-timestamp.Monthly",d="gu.contributions.recurring.contrib-timestamp.Annual",m="gu.contributions.contrib-timestamp",g="gu.noRRBannerTimestamp",h="v3",p=()=>!("true"===(0,r.e)({name:s})),v=e=>{const t="true"===(0,r.e)({name:l}),n=null!==(0,r.e)({name:u,shouldMemoize:!0}),o=null!==(0,r.e)({name:d,shouldMemoize:!0});return e&&(t||n||o)},f=()=>{const e=(0,r.e)({name:"gu_one_off_contribution_date"}),t=(0,r.e)({name:m});if(!e&&!t)return;const n=e?Date.parse(e):0,o=t?parseInt(t,10):0;return n>o?n:o||void 0},w=()=>{const e=f();if(void 0===e)return;const t=new Date(e),n=t.getFullYear(),o=(t.getMonth()+1).toString().padStart(2,"0"),r=t.getDate().toString().padStart(2,"0");return"".concat(n,"-").concat(o,"-").concat(r)},C=()=>{const e=f();return void 0!==e&&((e,t)=>{const n=Date.now()-e;return Math.floor(n/864e5)})(e)<=90},S=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!p()||v(e)||C()},_=[1,3,7],I=[1,3,5,7],T=()=>new Promise((e=>{(0,r.e)({name:"gu-cmp-disabled",shouldMemoize:!0})&&e(!0),(0,o.onConsentChange)((t=>{let{ccpa:n,tcfv2:o,aus:r}=t;if(n||r)e(!0);else if(o){const t=_.every((e=>o.consents[e]));t||(window.localStorage.removeItem("gu.history.dailyArticleCount"),window.localStorage.removeItem("gu.history.weeklyArticleCount")),e(t)}}))})),U=async()=>!await T()||null!==(0,r.e)({name:"gu_article_count_opt_out"}),b=()=>{const[e,t]=(0,a.useState)("Pending");return(0,c.t)((()=>{U().then(t).catch((()=>t(!0)))}),[]),e},y=()=>new Promise((e=>{(0,r.e)({name:"gu-cmp-disabled",shouldMemoize:!0})&&e(!0),(0,o.onConsentChange)((t=>{let{ccpa:n,tcfv2:o,aus:r}=t;if(n||r)e(!0);else if(o){const t=I.every((e=>o.consents[e]));e(t)}}))})),M=()=>{const e=window.localStorage.getItem(g);if(e&&!Number.isNaN(parseInt(e,10))){const t=parseInt(e,10)+12e5>Date.now();return t||window.localStorage.removeItem(g),t}return!1},D=()=>window.localStorage.setItem(g,"".concat(Date.now())),P=e=>()=>new Promise((t=>{var n;setTimeout((()=>t(null)),1e3),(n=e,(0,i._)(n).then((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.primaryEmailAddress})).catch((e=>{window.guardian.modules.sentry.reportError(e,"getEmail")}))).then((e=>{t(e||null)}))})),R=()=>{const e=(0,r.e)({name:"GU_CO_COMPLETE",shouldMemoize:!0});if(!e)return;let t;try{t=JSON.parse(decodeURIComponent(e))}catch(e){}return t}},3179:(e,t,n)=>{n.d(t,{T:()=>s,_:()=>c});var o=n(5726);function r(e){if(!e.ok)throw Error(e.statusText||"getIdApiUserData | An api call returned HTTP status ".concat(e.status));return e}const a=e=>fetch(e,{credentials:"include"}).then(r).then((e=>e.json())),i={},c=e=>{if(!i.idapiUserMeResponse){const t=(0,o.p)(e,"user/me");i.idapiUserMeResponse=a(t)}return i.idapiUserMeResponse},s=e=>{if(!i.idapiUserIdentifiersResponse){const t=(0,o.p)(e,"user/me/identifiers");i.idapiUserIdentifiersResponse=a(t)}return i.idapiUserIdentifiersResponse}},2022:(e,t,n)=>{n.r(t),n.d(t,{changeGeolocation:()=>y,getForcedVariant:()=>M,showMeTheBanner:()=>T,showMeTheEpic:()=>I,showNextVariant:()=>U,showPreviousVariant:()=>b});var o=n(6930),r=n(5984),a=n(47),i=n(5104),c=n(4702);const s=e=>{let{name:t,value:n,daysToLive:s,isCrossSubdomain:l=!1}=e;const u=new Date;if(!(0,i.I)(t,n))throw new Error("".concat(o.P," ").concat(t,"=").concat(n));if(s?u.setUTCDate(u.getUTCDate()+s):(u.setUTCMonth(u.getUTCMonth()+5),u.setUTCDate(1)),document.cookie="".concat(t,"=").concat(n,"; path=/; expires=").concat(u.toUTCString(),";").concat((0,a.B)({isCrossSubdomain:l})),c.k.has(t)){const[e]=(0,r.H)(t);e&&c.k.set(t,e)}};var l=n(1614),u=n(2602),d=n(9103),m=n(9658),g=n(4914),h=n(6134);const p=[g.C6,g.Ty,g.K3,g.y0,g.CC],v=()=>{localStorage.removeItem("gu.prefs.engagementBannerLastClosedAt"),localStorage.removeItem("gu.prefs.subscriptionBannerLastClosedAt"),localStorage.removeItem("gu.noRRBannerTimestamp")},f="GU_mvt_id",w=1e6,C=()=>{var e;const t=parseInt(null!==(e=(0,l.e)({name:f}))&&void 0!==e?e:"10",10);t&&s(t===w?{name:f,value:"1"}:{name:f,value:"".concat(t+1)})},S=()=>{var e;const t=parseInt(null!==(e=(0,l.e)({name:f}))&&void 0!==e?e:"10",10);t&&s(0===t?{name:f,value:w.toString()}:{name:f,value:"".concat(t-1)})},_=(e,t)=>{t?alert('This page has "Prevent membership/contribution appeals" ticked in Composer. Please try a different page'):(p.forEach((e=>(e=>{let{name:t,currentDomainOnly:n=!1}=e;const o="expires=Thu, 01 Jan 1970 00:00:01 GMT;",r="path=/;";document.cookie="".concat(t,"=;").concat(r).concat(o),n||(document.cookie="".concat(t,"=;").concat(r).concat(o," domain=").concat((0,u.W)(),";"))})({name:e}))),localStorage.removeItem("gu.contributions.views"),e&&s({name:g.CC,value:Date.now().toString()}),window.location.reload())},I=function(){_(arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1?arguments[1]:void 0)},T=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;v(),(0,m.Jt)(2),_(e,t)},U=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;C(),_(e,t)},b=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;S(),_(e,t)},y=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;(0,h.A)().then((n=>{const o=window.prompt("Enter two-letter geolocation code (e.g. GB, US, AU). Current is ".concat(null!=n?n:"null","."));"UK"===o?alert("'UK' is not a valid geolocation - please use 'GB' instead!"):o&&(d.t.local.set("gu.geo.override",o),_(e,t))})).catch((e=>{console.error("changeGeolocation - error: ".concat(String(e)))}))},M=e=>{if(URLSearchParams){const t=new URLSearchParams(window.location.search).get("force-".concat(e));if(t)return t}return null}},7410:(e,t,n)=>{n.d(t,{t:()=>r});var o=n(3904);const r=(e,t)=>{const[n,r]=(0,o.useState)(!1),a=t.every((e=>void 0!==e));(0,o.useEffect)((()=>{!n&&a&&(e(),r(!0))}),[n,a,e])}},5726:(e,t,n)=>{n.d(t,{p:()=>r});const o=/\b\/{2,}/g,r=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.join("/").replace(o,"/")}}}]);
//# sourceMappingURL=readerRevenueDevUtils.modern.93dfb5de107e2fb87318.js.map