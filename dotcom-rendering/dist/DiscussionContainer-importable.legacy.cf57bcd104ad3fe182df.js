"use strict";(self.webpackChunk_guardian_dotcom_rendering=self.webpackChunk_guardian_dotcom_rendering||[]).push([[9480],{1625:(e,n,t)=>{t.d(n,{F:()=>r});var s=t(9123),r=function(e,n){var t={componentType:"identityauthentication",componentId:e};return n&&(t.viewId=n),"componentEventParams=".concat(encodeURIComponent((0,s.A)(t)))}},9123:(e,n,t)=>{t.d(n,{A:()=>s});var s=function(e){return Object.keys(e).map((function(n){var t=e[n],s=Array.isArray(t)?t.map((function(e){return encodeURIComponent(e)})).join(","):encodeURIComponent(t);return"".concat(n,"=").concat(s)})).join("&")}},23:(e,n,t)=>{t.r(n),t.d(n,{DiscussionContainer:()=>U});var s=t(4649),r=t(7800),o=t(4857),i=t(5809),c=t(43),a=t(3746),d=t(3742),u=t(9525),l=t(2933),p=t(4872),m=t(2249),h=t(3904),f=t(5578),g=t(7791),x=t(824),v=t.n(x),j=function(){var e,n,t,s,r,o;try{var i,c,a;o=JSON.parse(null!==(i=localStorage.getItem("gu.prefs.discussion.order"))&&void 0!==i?i:"{}"),s=JSON.parse(null!==(c=localStorage.getItem("gu.prefs.discussion.threading"))&&void 0!==c?c:"{}"),r=JSON.parse(null!==(a=localStorage.getItem("gu.prefs.discussion.pagesize"))&&void 0!==a?a:"{}")}catch(e){return{orderBy:"newest",pageSize:25,threads:"collapsed"}}return{orderBy:null!==(e=o)&&void 0!==e&&e.value?o.value:"newest",threads:null!==(n=s)&&void 0!==n&&n.value?s.value:"collapsed",pageSize:null!==(t=r)&&void 0!==t&&t.value?r.value:25}},y=function(e){return{orderBy:"recommendations"===e.orderBy?"mostRecommended":e.orderBy,pageSize:String(e.pageSize),displayThreaded:String("collapsed"===e.threads||"expanded"===e.threads)}},b=function(){var e=(0,g.Z)(v().mark((function e(n,t){var s,r,o;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=(0,d.p)(n,"comment",t.toString(),"context"),r=j(),o=new URLSearchParams(y(r)),e.abrupt("return",fetch(s+"?"+o.toString()).then((function(e){if(!e.ok)throw Error(e.statusText||"getCommentContext | An api call returned HTTP status ".concat(e.status));return e})).then((function(e){return e.json()})).catch((function(e){window.guardian.modules.sentry.reportError(e,"get-comment-page")})));case 4:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),C=t(6276),O=t(9692),w=t(4026),S=t(8770),_=(0,c.css)("background-image:linear-gradient(\n\t\t0deg,\n\t\t",u.n$[100],",\n\t\t",u.n$[100]," 40%,\n\t\trgba(255, 255, 255, 0)\n\t);height:80px;position:absolute;bottom:0;right:0;width:100%;display:block;"),D={name:"xdxtqc",styles:"max-height:280px;min-height:280px;overflow:hidden"},P={name:"bjn8wh",styles:"position:relative"},T=function(e){var n=e.format,t=e.discussionApiUrl,s=e.shortUrlId,o=e.discussionD2Uid,u=e.discussionApiClientHeader,g=e.enableDiscussionSwitch,x=e.user,v=e.idApiUrl,j=(0,h.useState)(),y=(0,i.Z)(j,2),T=y[0],k=y[1],E=(0,h.useState)(),I=(0,i.Z)(E,2),M=I[0],N=I[1],U=(0,h.useState)(),F=(0,i.Z)(U,2),A=F[0],G=F[1],Z=(0,h.useState)(!1),z=(0,i.Z)(Z,2),R=z[0],B=z[1],L=(0,h.useState)(function(){if("undefined"!=typeof window){var e=window.location.hash;if(e.includes("comment")){var n=e.split("-"),t=(0,i.Z)(n,2)[1];if(t)return parseInt(t,10)}}}()),H=(0,i.Z)(L,2),q=H[0],J=H[1],K=(0,O.D)((0,d.p)(t,"discussion",s)),$=K.commentCount,V=K.isClosedForComments,W=(0,f.b)(n),X="undefined"!=typeof window&&"#comments"===window.location.hash;return(0,h.useEffect)((function(){void 0!==q&&b(t,q).then((function(e){k(e.page),N(e.pageSize),G(e.orderBy),B(!0)})).catch((function(e){return console.error("getCommentContext - error: ".concat(String(e)))}))}),[t,q]),(0,h.useEffect)((function(){X&&B(!0)}),[X]),(0,h.useEffect)((function(){document.querySelectorAll(".discussion > .pending").forEach((function(e){e.classList.add("reveal"),e.classList.remove("pending")}))}),[]),(0,h.useEffect)((function(){0!==$&&1!==$&&2!==$||B(!0)}),[$]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{css:[P,C.U,!R&&D],className:"discussion",children:(0,r.jsxs)("div",{className:"pending",children:[(0,r.jsx)(w.c,{when:"above",breakpoint:"leftCol",children:(0,r.jsx)("div",{"data-cy":"discussion",css:(0,c.css)("padding-bottom:",l.D[2],"px;"),children:(0,r.jsx)(S.K,{palette:W,enableDiscussionSwitch:g,user:x,commentCount:$,isClosedForComments:V})})}),(0,r.jsx)(a.g,{user:x,baseUrl:t,pillar:n.theme,initialPage:T,pageSizeOverride:M,isClosedForComments:!!V||!g,orderByOverride:A,shortUrl:s,additionalHeaders:{"D2-X-UID":o,"GU-Client":u},expanded:R,commentToScrollTo:q,onPermalinkClick:function(e){return"undefined"==typeof window||(window.location.hash="#comment-".concat(e),J(e)),!1},apiKey:"dotcom-rendering",onExpand:function(){B(!0)},idApiUrl:v}),!R&&(0,r.jsx)("div",{id:"discussion-overlay",css:_})]})}),!R&&(0,r.jsx)(m.o,{format:n,onClick:function(){var e;B(!0),e=new CustomEvent("comments-expanded"),document.dispatchEvent(e)},icon:(0,r.jsx)(p.G,{}),children:"View more comments"})]})},k=t(6325);function E(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,s)}return t}var I=function(e){var n=e.discussionApiUrl,t=(0,k.h)((0,d.p)(n,"profile/me?strict_sanctions_check=false"),{},{credentials:"include"}).data;return t?(0,r.jsx)(T,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?E(Object(t),!0).forEach((function(n){(0,s.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):E(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({user:t.userProfile},e)):null};function M(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,s)}return t}function N(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?M(Object(t),!0).forEach((function(n){(0,s.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):M(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var U=function(e){return(0,o.e)({name:"GU_U",shouldMemoize:!0})?(0,r.jsx)(I,N({},e)):(0,r.jsx)(T,N({},e))}},4026:(e,n,t)=>{t.d(n,{c:()=>i});var s=t(7800),r=t(43),o=t(5246),i=function(e){var n,t=e.children,i=e.when,c=e.breakpoint,a=e.el;return n="below"===i?(0,r.css)(o.C4[c],"{display:none;}"):(0,r.css)(o.Dp[c],"{display:none;}"),"li"===a?(0,s.jsx)("li",{css:n,children:t}):(0,s.jsx)("span",{css:n,children:t})}},8770:(e,n,t)=>{t.d(n,{K:()=>b});var s=t(7800),r=t(43),o=t(2933),i=t(5246),c=t(7162),a=t(2522),d=t(9525),u=t(1625),l=(0,r.css)("padding-top:",o.D[1],"px;padding-bottom:",o.D[1],"px;"),p=(0,r.css)("border-radius:70px;width:60px;height:60px;",i.C4.desktop,"{width:36px;height:36px;}"),m=(0,r.css)("padding-bottom:",o.D[1],"px;padding-right:",o.D[2],"px;"),h=(0,r.css)(c.Se.xxsmall({fontWeight:"bold"}),";padding-bottom:",o.D[1],"px;"),f=(0,r.css)(c.OS.small()," ",i.C4.desktop,"{",c.OS.xxsmall(),";}color:",a.fL.supporting,";padding-bottom:",o.D[1],"px;"),g=(0,r.css)(c.Se.xxxsmall()," color:",a.fL.supporting,";padding-bottom:",o.D[1],"px;"),x=(0,r.css)("font-weight:700;color:",a.fL.primary,";"),v=function(e){return(0,r.css)("color:",e.text.signInLink,";text-decoration:none;border-bottom:1px solid ",a.Cg.secondary,";transition:border-color 0.15s ease-out;:hover{border-color:",d.r[300],";}")},j=(0,r.css)("display:flex;flex-direction:column;",i.C4.desktop,"{flex-direction:row;}"),y=function(e){var n=e.count;return(0,s.jsxs)("h2",{css:h,children:["comments"," ",(0,s.jsxs)("span",{css:(0,r.css)("color:",d.n$[60],";"),children:["(",null!=n?n:"â€¦",")"]})]})},b=function(e){var n=e.commentCount,t=e.palette,r=e.enableDiscussionSwitch,o=e.user,i=e.isClosedForComments,c=(null==o?void 0:o.privateFields)&&!o.privateFields.canPostComment;return r?c?(0,s.jsxs)("div",{css:l,children:[(0,s.jsx)(y,{count:n}),(0,s.jsxs)("span",{css:g,children:["Commenting has been disabled for this account (",(0,s.jsx)("a",{href:"https://www.theguardian.com/community-faqs#321a",css:v(t),children:"why?"})," ",")"]})]}):o&&i?(0,s.jsxs)("div",{css:l,children:[(0,s.jsx)(y,{count:n}),(0,s.jsx)("span",{css:g,children:"This discussion is closed for comments"})]}):!o&&i?(0,s.jsxs)("div",{css:l,children:[(0,s.jsx)(y,{count:n}),(0,s.jsxs)("span",{css:g,children:["This discussion is now closed for comments but you can still"," ",(0,s.jsx)("a",{href:"https://profile.theguardian.com/signin?INTCMP=DOTCOM_COMMENTS_SIGNIN&".concat((0,u.F)("signin_to_comment")),css:v(t),children:"sign in"})," ","or"," ",(0,s.jsx)("a",{href:"https://profile.theguardian.com/register?INTCMP=DOTCOM_COMMENTS_REG&".concat((0,u.F)("register_to_comment")),css:v(t),children:"create your Guardian account"})," ","to join the discussion next time"]})]}):o?(0,s.jsxs)("div",{css:l,children:[(0,s.jsx)(y,{count:n}),(0,s.jsxs)("div",{css:j,children:[(0,s.jsx)("div",{css:m,children:(0,s.jsx)("img",{src:o.secureAvatarUrl||"https://avatar.guim.co.uk/no-user-image.gif",alt:o.displayName||"Guardian User",css:p})}),(0,s.jsxs)("div",{css:f,children:["Signed in as",(0,s.jsx)("div",{css:x,children:o.displayName||"Guardian User"})]})]})]}):(0,s.jsxs)("div",{css:l,children:[(0,s.jsx)(y,{count:n}),(0,s.jsxs)("span",{css:g,children:[(0,s.jsx)("a",{href:"https://profile.theguardian.com/signin?INTCMP=DOTCOM_COMMENTS_SIGNIN&".concat((0,u.F)("signin_to_comment")),css:v(t),children:"Sign in"})," ","or"," ",(0,s.jsx)("a",{href:"https://profile.theguardian.com/register?INTCMP=DOTCOM_COMMENTS_REG&".concat((0,u.F)("register_to_comment")),css:v(t),children:"create your Guardian account"})," ","to join the discussion"]})]}):o?(0,s.jsxs)("div",{css:l,children:[(0,s.jsx)(y,{count:n}),(0,s.jsx)("span",{css:g,children:"Commenting has been disabled at this time"})]}):(0,s.jsxs)("div",{css:l,children:[(0,s.jsx)(y,{count:n}),(0,s.jsxs)("span",{css:g,children:["Commenting has been disabled at this time but you can still"," ",(0,s.jsx)("a",{href:"https://profile.theguardian.com/signin?INTCMP=DOTCOM_COMMENTS_SIGNIN&".concat((0,u.F)("signin_to_comment")),css:v(t),children:"sign in"})," ","or"," ",(0,s.jsx)("a",{href:"https://profile.theguardian.com/register?INTCMP=DOTCOM_COMMENTS_REG&".concat((0,u.F)("register_to_comment")),css:v(t),children:"create your Guardian account"})," ","to join the discussion when it's back"]})]})}},6276:(e,n,t)=>{t.d(n,{U:()=>c});var s,r,o=t(669),i=t(43),c=(0,i.css)(".reveal{animation:",(0,i.keyframes)(s||(s=(0,o.Z)(["\n\t\t\t0% { opacity: 0; }\n\t\t\t100% { opacity: 1; }\n\t\t"])))," 1s ease-out;}.reveal-slowly{animation:",(0,i.keyframes)(r||(r=(0,o.Z)(["\n\t\t\t0% { opacity: 0; }\n\t\t\t100% { opacity: 1; }\n\t\t"])))," 4s ease-out;}.pending{display:none;}")},6325:(e,n,t)=>{t.d(n,{h:()=>o});var s=t(6131);function r(e){if(!e.ok)throw Error(e.statusText||"useApi | An api call returned HTTP status ".concat(e.status));return e}var o=function(e,n,t){var o=(0,s.ZP)(e,function(e){return function(n){return fetch(n,e).then(r).then((function(e){return e.json()}))}}(t),n),i=o.data,c=o.error;return{data:i,error:c,loading:!!e&&!c&&!i}}},9692:(e,n,t)=>{t.d(n,{D:()=>r});var s=t(6325),r=function(e){var n=(0,s.h)(e,{dedupingInterval:8e3}).data;return{commentCount:null==n?void 0:n.discussion.commentCount,isClosedForComments:null==n?void 0:n.discussion.isClosedForComments}}}}]);
//# sourceMappingURL=DiscussionContainer-importable.legacy.cf57bcd104ad3fe182df.js.map