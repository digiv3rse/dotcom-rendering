"use strict";(self.webpackChunk_guardian_dotcom_rendering=self.webpackChunk_guardian_dotcom_rendering||[]).push([[5191],{8059:(e,t,n)=>{n.d(t,{R:()=>v,o:()=>f});var r=n(5809),o=n(7791),i=n(824),a=n.n(i),u=n(232),c=n(1846),s=n(3904),l=n(9175),d=n(2460),f=function(){var e=(0,o.Z)(a().mark((function e(t,n){var r,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,l.Am)();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",void 0);case 4:return window.guardian.weeklyArticleCount||((0,c.DF)(u.t.local,t,n.split(",")),window.guardian.weeklyArticleCount=(0,c.lL)(u.t.local)),window.guardian.dailyArticleCount||((0,d.HN)(),window.guardian.dailyArticleCount=(0,d.lu)()),e.abrupt("return",{weeklyArticleHistory:null!==(r=window.guardian.weeklyArticleCount)&&void 0!==r?r:[],dailyArticleHistory:null!==(o=window.guardian.dailyArticleCount)&&void 0!==o?o:[]});case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),v=function(e,t){var n=(0,s.useState)("Pending"),o=(0,r.Z)(n,2),i=o[0],a=o[1];return(0,s.useEffect)((function(){f(e,t).then(a).catch((function(){return a(void 0)}))}),[e,t]),i}},2351:(e,t,n)=>{n.r(t),n.d(t,{LiveBlogEpic:()=>C});var r=n(4649),o=n(5809),i=n(7800),a=n(43),u=n(4857),c=n(6621),s=n(232),l=n(2933),d=n(1846),f=n(3904),v=n(8059),p=n(3203),g=n(9175),m=n(6358),w=n(8576),h=n(6131);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var O=function(e){var t=e.url,n=e.name,r=e.props,u=function(e){var t=e.url,n=e.name,r=(0,f.useState)(),i=(0,o.Z)(r,2),a=i[0],u=i[1];return(0,f.useEffect)((function(){(0,w.R)(),window.guardianPolyfilledImport(t).then((function(e){u((function(){return e[n]}))})).catch((function(e){var t="Error importing LiveBlog epic: ".concat(String(e));window.guardian.modules.sentry.reportError(new Error(t),"liveblog-epic")}))}),[t,n]),{Epic:a}}({url:t,name:n}),s=u.Epic;return void 0===s?null:((0,c.c)("dotcom","LiveBlogEpic has the Epic"),(0,i.jsx)("aside",{css:(0,a.css)("margin-bottom:",l.D[3],"px;"),children:(0,i.jsx)(s,b({},r))}))},k=function(e){var t=e.payload,n=function(e,t){return n="liveblog-epic",r=function(){return(0,d.Ec)(e,t)},o=(0,h.ZP)(n,r),i=o.data,(a=o.error)&&window.guardian.modules.sentry.reportError(a,"rr-epic"),i;var n,r,o,i,a}(e.contributionsServiceUrl,t);if(null==n||!n.data||0===Object.keys(n).length)return null;(0,c.c)("dotcom","LiveBlogEpic has a module");var r=b(b({},n.data.module.props),{},{submitComponentEvent:p.X4});return(0,i.jsx)(O,{url:n.data.module.url,name:n.data.module.name,props:r})};function E(e,t){var n;null===(n=e.parentNode)||void 0===n||n.insertBefore(t,e.nextSibling)}var C=function(e){var t=e.section,n=e.shouldHideReaderRevenue,r=e.isPaidContent,a=e.tags,l=e.contributionsServiceUrl,p=e.pageId,w=e.keywordIds;(0,c.c)("dotcom","LiveBlogEpic started");var h=function(e){var t,n=e.shouldHideReaderRevenue,r=e.section,i=e.isPaidContent,a=e.tags,l=e.pageId,p=e.keywordIds,w=(0,v.R)(l,p),h=(0,g.qw)(),y=function(){var e=(0,f.useState)(),t=(0,o.Z)(e,2),n=t[0],r=t[1];return(0,f.useEffect)((function(){(0,m.A)().then((function(e){r(e)})).catch((function(e){var t="Error fetching country code: ".concat(String(e));window.guardian.modules.sentry.reportError(new Error(t),"liveblog-epic")}))}),[]),n}(),b=Number((0,u.e)({name:"GU_mvt_id",shouldMemoize:!0}))||0,O=!!(0,u.e)({name:"GU_U",shouldMemoize:!0});if("Pending"!==w&&"Pending"!==h&&((0,c.c)("dotcom","LiveBlogEpic has consent state"),y))return(0,c.c)("dotcom","LiveBlogEpic has countryCode"),{tracking:{ophanPageId:window.guardian.config.ophan.pageViewId,platformId:"GUARDIAN_WEB",clientName:"dcr",referrerUrl:window.location.origin+window.location.pathname},targeting:{contentType:"LiveBlog",sectionId:r,shouldHideReaderRevenue:n,isMinuteArticle:!0,isPaidContent:i,tags:a,showSupportMessaging:!(0,g.S9)(O),isRecurringContributor:(0,g.T0)(O),lastOneOffContributionDate:null!==(t=(0,g.qQ)())&&void 0!==t?t:void 0,mvtId:b,countryCode:y,epicViewLog:(0,d.Es)(s.t.local),weeklyArticleHistory:null==w?void 0:w.weeklyArticleHistory,hasOptedOutOfArticleCount:h,modulesVersion:"v3",url:window.location.origin+window.location.pathname}}}({shouldHideReaderRevenue:n,section:t,isPaidContent:r,tags:a,pageId:p,keywordIds:w});if(!h)return null;var y=document.createElement("article");if(window.location.href.includes("#block-")){y.classList.add("pending");var b=window.location.hash.slice(1),O=document.getElementById(b);O&&E(O,y),y.classList.add("reveal"),y.classList.remove("pending")}else{var C=Math.floor(3*Math.random())+1,S=document.querySelectorAll("article.block")[C];S&&E(S,y)}return(0,f.createPortal)((0,i.jsx)(k,{payload:h,contributionsServiceUrl:l}),y)}},9175:(e,t,n)=>{n.d(t,{Am:()=>I,BQ:()=>h,C6:()=>f,CC:()=>m,G9:()=>A,H2:()=>R,K3:()=>p,Pl:()=>D,S9:()=>C,T0:()=>b,Ty:()=>v,ZD:()=>_,cs:()=>U,nh:()=>M,qQ:()=>O,qw:()=>j,tq:()=>k,y0:()=>g});var r=n(5809),o=n(7791),i=n(824),a=n.n(i),u=n(5226),c=n(4857),s=n(3904),l=n(2516),d=n(3287),f="gu_hide_support_messaging",v="gu_recurring_contributor",p="gu.contributions.recurring.contrib-timestamp.Monthly",g="gu.contributions.recurring.contrib-timestamp.Annual",m="gu.contributions.contrib-timestamp",w="gu.noRRBannerTimestamp",h="v3",y=function(){return!("true"===(0,c.e)({name:f}))},b=function(e){var t="true"===(0,c.e)({name:v}),n=null!==(0,c.e)({name:p,shouldMemoize:!0}),r=null!==(0,c.e)({name:g,shouldMemoize:!0});return e&&(t||n||r)},O=function(){var e=(0,c.e)({name:"gu_one_off_contribution_date"}),t=(0,c.e)({name:m});if(e||t){var n=e?Date.parse(e):0,r=t?parseInt(t,10):0;return n>r?n:r||void 0}},k=function(){var e=O();if(void 0!==e){var t=new Date(e),n=t.getFullYear(),r=(t.getMonth()+1).toString().padStart(2,"0"),o=t.getDate().toString().padStart(2,"0");return"".concat(n,"-").concat(r,"-").concat(o)}},E=function(){var e,t=O();return void 0!==t&&(e=Date.now()-t,Math.floor(e/864e5)<=90)},C=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!y()||b(e)||E()},S=[1,3,7],P=[1,3,5,7],A=function(){return new Promise((function(e){(0,c.e)({name:"gu-cmp-disabled",shouldMemoize:!0})&&e(!0),(0,u.onConsentChange)((function(t){var n=t.ccpa,r=t.tcfv2,o=t.aus;if(n||o)e(!0);else if(r){var i=S.every((function(e){return r.consents[e]}));i||(window.localStorage.removeItem("gu.history.dailyArticleCount"),window.localStorage.removeItem("gu.history.weeklyArticleCount")),e(i)}}))}))},I=function(){var e=(0,o.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A();case 2:return t=e.sent,e.abrupt("return",!t||null!==(0,c.e)({name:"gu_article_count_opt_out"}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),j=function(){var e=(0,s.useState)("Pending"),t=(0,r.Z)(e,2),n=t[0],o=t[1];return(0,d.t)((function(){I().then(o).catch((function(){return o(!0)}))}),[]),n},R=function(){return new Promise((function(e){(0,c.e)({name:"gu-cmp-disabled",shouldMemoize:!0})&&e(!0),(0,u.onConsentChange)((function(t){var n=t.ccpa,r=t.tcfv2,o=t.aus;if(n||o)e(!0);else if(r){var i=P.every((function(e){return r.consents[e]}));e(i)}}))}))},D=function(){var e=window.localStorage.getItem(w);if(e&&!Number.isNaN(parseInt(e,10))){var t=parseInt(e,10)+12e5>Date.now();return t||window.localStorage.removeItem(w),t}return!1},_=function(){return window.localStorage.setItem(w,"".concat(Date.now()))},M=function(e){return function(){return new Promise((function(t){var n;setTimeout((function(){return t(null)}),1e3),(n=e,(0,l._)(n).then((function(e){var t;return null===(t=e.user)||void 0===t?void 0:t.primaryEmailAddress})).catch((function(e){window.guardian.modules.sentry.reportError(e,"getEmail")}))).then((function(e){t(e||null)}))}))}},U=function(){var e=(0,c.e)({name:"GU_CO_COMPLETE",shouldMemoize:!0});if(e){var t;try{t=JSON.parse(decodeURIComponent(e))}catch(e){}return t}}},2460:(e,t,n)=>{n.d(t,{HN:()=>a,lu:()=>o,x2:()=>i});var r="gu.history.dailyArticleCount",o=function(){var e=localStorage.getItem(r);if(e)try{var t=JSON.parse(e).value;if(!t.length)throw new Error("Invalid gu.history.dailyArticleCount value");return t}catch(e){return void localStorage.removeItem(r)}},i=function(){return Math.floor(Date.now()/864e5)},a=function(){var e,t,n=null!==(e=o())&&void 0!==e?e:[],a=i();if((null===(t=n[0])||void 0===t?void 0:t.day)===a)n[0].count+=1;else{n.unshift({day:a,count:1});var u=a-60,c=n.findIndex((function(e){return e.day&&e.day<u}));c>0&&n.splice(c)}localStorage.setItem(r,JSON.stringify({value:n}))}},2516:(e,t,n)=>{n.d(t,{T:()=>c,_:()=>u});var r=n(3742);function o(e){if(!e.ok)throw Error(e.statusText||"getIdApiUserData | An api call returned HTTP status ".concat(e.status));return e}var i=function(e){return fetch(e,{credentials:"include"}).then(o).then((function(e){return e.json()}))},a={},u=function(e){if(!a.idapiUserMeResponse){var t=(0,r.p)(e,"user/me");a.idapiUserMeResponse=i(t)}return a.idapiUserMeResponse},c=function(e){if(!a.idapiUserIdentifiersResponse){var t=(0,r.p)(e,"user/me/identifiers");a.idapiUserIdentifiersResponse=i(t)}return a.idapiUserIdentifiersResponse}},8576:(e,t,n)=>{n.d(t,{R:()=>u});var r=n(43),o=n(7800),i=n(3904),a=!1,u=function(){a||(window.guardian.automat={emotionReact:r,emotionReactJsxRuntime:o,react:i.default},a=!0)}},3287:(e,t,n)=>{n.d(t,{t:()=>i});var r=n(5809),o=n(3904),i=function(e,t){var n=(0,o.useState)(!1),i=(0,r.Z)(n,2),a=i[0],u=i[1],c=t.every((function(e){return void 0!==e}));(0,o.useEffect)((function(){!a&&c&&(e(),u(!0))}),[a,c,e])}},3742:(e,t,n)=>{n.d(t,{p:()=>o});var r=/\b\/{2,}/g,o=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.join("/").replace(r,"/")}},2933:(e,t,n)=>{n.d(t,{D:()=>o,K:()=>i});var r=n(2335),o={1:4,2:8,3:12,4:16,5:20,6:24,9:36,12:48,24:96},i={1:"".concat((0,r.Q)(o[1]),"rem"),2:"".concat((0,r.Q)(o[2]),"rem"),3:"".concat((0,r.Q)(o[3]),"rem"),4:"".concat((0,r.Q)(o[4]),"rem"),5:"".concat((0,r.Q)(o[5]),"rem"),6:"".concat((0,r.Q)(o[6]),"rem"),9:"".concat((0,r.Q)(o[9]),"rem"),12:"".concat((0,r.Q)(o[12]),"rem"),24:"".concat((0,r.Q)(o[24]),"rem")}},2335:(e,t,n)=>{n.d(t,{Q:()=>r});var r=function(e){return e/16}},1846:(e,t,n)=>{n.d(t,{DF:()=>d,Ec:()=>p,Eg:()=>g,Es:()=>a,Nh:()=>m,Pg:()=>w,bv:()=>v,lL:()=>c});var r=n(4649);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var a=function(e){return e.get("gu.contributions.views")||void 0},u=function(e){var t=e.getDay()||7;return Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()-(t-1))/864e5},c=function(e){return e.get("gu.history.weeklyArticleCount")||void 0},s=new Set(["environment/climate-change","environment/climate-crisis","environment/environment","science/science","politics/politics","us-news/us-politics","australia-news/australian-politics","world/world","world/europe-news","world/russia","books/books","culture/culture","world/coronavirus-outbreak","world/race","inequality/inequality","technology/technology","business/business"]),l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.forEach((function(e){var n;s.has(e)&&(t[e]=(null!==(n=t[e])&&void 0!==n?n:0)+1)})),t},d=function(e,t,n){if(!function(e,t){var n=u(new Date),o=e.get("gu.history.articleCountsThisWeek");if(o&&o.week===n){var a=o.articles[t]||0;return e.set("gu.history.articleCountsThisWeek",{week:n,articles:i(i({},o.articles),{},(0,r.Z)({},t,a+1))}),a>0}return e.set("gu.history.articleCountsThisWeek",{week:n,articles:(0,r.Z)({},t,1)}),!1}(e,t)){var o=u(new Date),a=e.get("gu.history.weeklyArticleCount")||[],c=a[0];if(c&&c.week&&c.week===o)c.count+=1,c.tags=l(n,c.tags),e.set("gu.history.weeklyArticleCount",a);else{a.unshift({week:o,count:1,tags:l(n,{})});var s=o-365,d=a.filter((function(e){return e.week>=s}));e.set("gu.history.weeklyArticleCount",d)}}},f=function(e,t,n){var r=function(e){if(URLSearchParams){var t=new URLSearchParams(window.location.search).get("force-"+e);if(t)return t}return null}(e);return fetch("".concat(t,"/").concat(e).concat(r?"?force="+r:""),{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((function(t){if(!t.ok)throw Error(t.statusText||"Supporter Revenue ".concat(e," | Api call returned HTTP status ").concat(t.status));return t})).then((function(e){return e.json()}))},v=function(e,t){return f("epic",e,t)},p=function(e,t){return f("liveblog-epic",e,t)},g=function(e,t){return f("banner",e,t)},m=function(e,t){return f("puzzles",e,t)},w=function(e,t){return f("header",e,t)}}}]);
//# sourceMappingURL=LiveBlogEpic-importable.legacy.19ac812a31bc547b7a42.js.map