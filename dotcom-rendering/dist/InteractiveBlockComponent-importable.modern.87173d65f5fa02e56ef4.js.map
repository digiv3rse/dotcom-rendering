{"version":3,"file":"InteractiveBlockComponent-importable.modern.87173d65f5fa02e56ef4.js","mappings":"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","sources":["webpack://@guardian/dotcom-rendering/./src/static/icons/camera.svg","webpack://@guardian/dotcom-rendering/./src/static/icons/video-icon.svg","webpack://@guardian/dotcom-rendering/./src/web/components/Caption.tsx","webpack://@guardian/dotcom-rendering/./src/web/components/Figure.tsx","webpack://@guardian/dotcom-rendering/./src/web/components/InteractiveBlockComponent.importable.tsx","webpack://@guardian/dotcom-rendering/./src/web/components/Placeholder.tsx","webpack://@guardian/dotcom-rendering/./src/web/layouts/lib/interactiveLegacyStyling.ts","webpack://@guardian/dotcom-rendering/./src/web/lib/center.ts","webpack://@guardian/dotcom-rendering/./src/web/lib/useOnce.ts"],"sourcesContent":["\nmodule.exports = {\"attributes\":{\"width\":\"18\",\"height\":\"13\",\"viewBox\":\"0 0 18 13\"},\"content\":\"<path d=\\\"M18 3.5v8l-1.5 1.5h-15l-1.5-1.5v-8l1.5-1.5h3.5l2-2h4l2 2h3.5l1.5 1.5zm-9 7.5c1.9 0 3.5-1.6 3.5-3.5s-1.6-3.5-3.5-3.5-3.5 1.6-3.5 3.5 1.6 3.5 3.5 3.5z\\\"/>\"}\nvar desvg = require('@kossnocorp/desvg/react')\nmodule.exports = desvg(module.exports)\n","\nmodule.exports = {\"attributes\":{\"width\":\"36\",\"height\":\"23\",\"viewBox\":\"0 0 36 23\"},\"content\":\"<path d=\\\"M3.2 0l-3.2 3.3v16.4l3.3 3.3h18.7v-23h-18.8m30.4 1l-8.6 8v5l8.6 8h2.4v-21h-2.4\\\"/>\"}\nvar desvg = require('@kossnocorp/desvg/react')\nmodule.exports = desvg(module.exports)\n","import { css } from '@emotion/react';\nimport type { ArticleFormat } from '@guardian/libs';\nimport { ArticleDesign, ArticleDisplay, ArticleSpecial } from '@guardian/libs';\nimport {\n\tbetween,\n\tfrom,\n\tspace,\n\ttextSans,\n\tuntil,\n} from '@guardian/source-foundations';\nimport CameraSvg from '../../static/icons/camera.svg';\nimport VideoSvg from '../../static/icons/video-icon.svg';\nimport type { Palette } from '../../types/palette';\nimport { decidePalette } from '../lib/decidePalette';\n\ntype Props = {\n\tcaptionText?: string;\n\tformat: ArticleFormat;\n\tpadCaption?: boolean;\n\tcredit?: string;\n\tdisplayCredit?: boolean;\n\tshouldLimitWidth?: boolean;\n\tisOverlaid?: boolean;\n\tisLeftCol?: boolean;\n\tmediaType?: MediaType;\n\tisMainMedia?: boolean;\n};\n\ntype IconProps = {\n\tpalette: Palette;\n\tformat: ArticleFormat;\n};\n\nconst captionStyle = (palette: Palette) => css`\n\t${textSans.xsmall()};\n\tline-height: 135%;\n\tpadding-top: 6px;\n\tword-wrap: break-all;\n\tcolor: ${palette.text.caption};\n`;\n\nconst bottomMarginStyles = css`\n\tmargin-bottom: 6px;\n`;\n\nconst overlaidBottomPadding = (format: ArticleFormat) => {\n\tif (\n\t\tformat.display === ArticleDisplay.Showcase &&\n\t\tformat.design === ArticleDesign.Review\n\t) {\n\t\treturn css`\n\t\t\tpadding-bottom: 2.5rem;\n\t\t`;\n\t}\n\treturn css`\n\t\tpadding-bottom: 0.375rem;\n\t`;\n};\n\nconst overlaidStyles = (palette: Palette, format: ArticleFormat) => css`\n\tposition: absolute;\n\tleft: 0;\n\tright: 0;\n\tbottom: 0;\n\tbackground: rgba(18, 18, 18, 0.8);\n\n\tspan {\n\t\tcolor: ${palette.text.overlaidCaption};\n\t\tfont-size: 0.75rem;\n\t\tline-height: 1rem;\n\t}\n\n\tsvg {\n\t\tfill: ${palette.text.overlaidCaption};\n\t}\n\tcolor: ${palette.text.overlaidCaption};\n\tfont-size: 0.75rem;\n\tline-height: 1rem;\n\tpadding-top: 0.375rem;\n\tpadding-right: 2.5rem;\n\tpadding-left: 0.75rem;\n\t${overlaidBottomPadding(format)};\n\n\tflex-grow: 1;\n\tmin-height: 2.25rem;\n`;\n\nconst limitedWidth = css`\n\t${from.leftCol} {\n\t\twidth: 140px;\n\t\t/* use absolute position here to allow the article text to push up alongside\n           the caption when it is limited in width */\n\t\tposition: absolute;\n\t}\n\t${from.wide} {\n\t\twidth: 220px;\n\t}\n`;\n\nconst veryLimitedWidth = css`\n\t${from.leftCol} {\n\t\twidth: 120px;\n\t\t/* use absolute position here to allow the article text to push up alongside\n           the caption when it is limited in width */\n\t\tposition: absolute;\n\t}\n\t${from.wide} {\n\t\twidth: 184px;\n\t}\n`;\n\nconst captionPadding = css`\n\tpadding-left: 8px;\n\tpadding-right: 8px;\n`;\n\nconst tabletCaptionPadding = css`\n\t${until.desktop} {\n\t\t${captionPadding}\n\t}\n`;\n\nconst videoPadding = css`\n\t${until.mobileLandscape} {\n\t\tmargin-left: 10px;\n\t}\n\t${between.mobileLandscape.and.phablet} {\n\t\tmargin-left: ${space[5]}px;\n\t}\n`;\n\nconst bigLeftMargin = css`\n\twidth: inherit;\n\tmargin-left: ${space[9]}px;\n\t${until.wide} {\n\t\tmargin-left: 20px;\n\t\tmargin-right: 20px;\n\t}\n\t${until.mobileLandscape} {\n\t\tmargin-left: 10px;\n\t\tmargin-right: 10px;\n\t}\n`;\n\nconst hideIconBelowLeftCol = css`\n\t${until.leftCol} {\n\t\tdisplay: none;\n\t}\n`;\n\nconst pictureRatio = (13 / 18) * 100;\nconst videoRatio = (23 / 36) * 100;\n\nconst iconStyle = (palette: Palette) => css`\n\tfill: ${palette.fill.cameraCaptionIcon};\n\tmargin-right: ${space[1]}px;\n\tdisplay: inline-block;\n\tposition: relative;\n\twidth: 1em;\n\tvertical-align: baseline;\n\t::before {\n\t\tcontent: ' ';\n\t\tdisplay: block;\n\t\tpadding-top: ${pictureRatio}%;\n\t}\n\tsvg {\n\t\ttop: 0px;\n\t\tright: 0px;\n\t\tbottom: 0px;\n\t\tleft: 0px;\n\t\twidth: 100%;\n\t\tposition: absolute;\n\t\theight: 100%;\n\t}\n`;\n\nconst videoIconStyle = css`\n\twidth: 1.1em;\n\t::before {\n\t\tpadding-top: ${videoRatio}%;\n\t}\n`;\n\nconst captionLink = (palette: Palette) => css`\n\ta {\n\t\tcolor: ${palette.text.captionLink};\n\t\ttext-decoration: none;\n\t}\n\ta:hover {\n\t\ttext-decoration: underline;\n\t}\n\tstrong {\n\t\tfont-weight: bold;\n\t}\n`;\n\nconst CameraIcon = ({ palette, format }: IconProps) => {\n\treturn (\n\t\t<span\n\t\t\tcss={[\n\t\t\t\ticonStyle(palette),\n\t\t\t\tformat.display === ArticleDisplay.Immersive &&\n\t\t\t\t\thideIconBelowLeftCol,\n\t\t\t]}\n\t\t>\n\t\t\t<CameraSvg />\n\t\t</span>\n\t);\n};\n\nconst VideoIcon = ({ palette, format }: IconProps) => {\n\treturn (\n\t\t<span\n\t\t\tcss={[\n\t\t\t\ticonStyle(palette),\n\t\t\t\tformat.display === ArticleDisplay.Immersive &&\n\t\t\t\t\thideIconBelowLeftCol,\n\t\t\t\tvideoIconStyle,\n\t\t\t]}\n\t\t>\n\t\t\t<VideoSvg />\n\t\t</span>\n\t);\n};\n\nexport const Caption = ({\n\tcaptionText,\n\tformat,\n\tpadCaption = false,\n\tcredit,\n\tdisplayCredit = true,\n\tshouldLimitWidth = false,\n\tisOverlaid,\n\tisLeftCol,\n\tmediaType = 'Gallery',\n\tisMainMedia = false,\n}: Props) => {\n\t// Sometimes captions come thorough as a single blank space, so we trim here to ignore those\n\tconst noCaption = !captionText?.trim();\n\tconst noCredit = !credit;\n\tconst hideCredit = !displayCredit;\n\tif (noCaption && (noCredit || hideCredit)) return null;\n\n\tconst palette = decidePalette(format);\n\tconst isBlog =\n\t\tformat.design === ArticleDesign.LiveBlog ||\n\t\tformat.design === ArticleDesign.DeadBlog;\n\n\tconst defaultCaption = (\n\t\t<figcaption\n\t\t\tcss={[\n\t\t\t\tcaptionStyle(palette),\n\t\t\t\tshouldLimitWidth && limitedWidth,\n\t\t\t\tisOverlaid\n\t\t\t\t\t? overlaidStyles(palette, format)\n\t\t\t\t\t: bottomMarginStyles,\n\t\t\t\tisMainMedia && isBlog && tabletCaptionPadding,\n\t\t\t\tpadCaption && captionPadding,\n\t\t\t\tmediaType === 'Video' && videoPadding,\n\t\t\t]}\n\t\t>\n\t\t\t{mediaType === 'Video' ? (\n\t\t\t\t<VideoIcon palette={palette} format={format} />\n\t\t\t) : (\n\t\t\t\t<CameraIcon palette={palette} format={format} />\n\t\t\t)}\n\t\t\t{!!captionText && (\n\t\t\t\t<span\n\t\t\t\t\tcss={captionLink(palette)}\n\t\t\t\t\tdangerouslySetInnerHTML={{\n\t\t\t\t\t\t__html: captionText || '',\n\t\t\t\t\t}}\n\t\t\t\t\tkey=\"caption\"\n\t\t\t\t/>\n\t\t\t)}\n\t\t\t{!!credit && displayCredit && ` ${credit}`}\n\t\t</figcaption>\n\t);\n\n\tswitch (format.design) {\n\t\tcase ArticleDesign.PhotoEssay:\n\t\t\tif (format.theme === ArticleSpecial.Labs && isLeftCol) {\n\t\t\t\treturn defaultCaption;\n\t\t\t}\n\t\t\treturn (\n\t\t\t\t<figcaption\n\t\t\t\t\tcss={[\n\t\t\t\t\t\tcss`\n\t\t\t\t\t\t\t${textSans.xxsmall({ lineHeight: 'tight' })};\n\t\t\t\t\t\t\tcolor: ${palette.text.caption};\n\t\t\t\t\t\t\twidth: 100%;\n\t\t\t\t\t\t\tmargin-top: ${space[3]}px;\n\t\t\t\t\t\t\tli:not(:first-child) {\n\t\t\t\t\t\t\t\tmargin-top: ${space[3]}px;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tli {\n\t\t\t\t\t\t\t\tpadding-top: ${space[2]}px;\n\t\t\t\t\t\t\t\tborder-top: 1px solid ${palette.text.caption};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t`,\n\t\t\t\t\t\tbottomMarginStyles,\n\t\t\t\t\t\tpadCaption && captionPadding,\n\t\t\t\t\t\tshouldLimitWidth && veryLimitedWidth,\n\t\t\t\t\t\tshouldLimitWidth && bigLeftMargin,\n\t\t\t\t\t]}\n\t\t\t\t>\n\t\t\t\t\t{!!captionText && (\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tcss={captionLink(palette)}\n\t\t\t\t\t\t\tdangerouslySetInnerHTML={{\n\t\t\t\t\t\t\t\t__html: captionText || '',\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tkey=\"caption\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t{!!credit && displayCredit && ` ${credit}`}\n\t\t\t\t</figcaption>\n\t\t\t);\n\t\tdefault:\n\t\t\treturn defaultCaption;\n\t}\n};\n","import { css } from '@emotion/react';\nimport { ArticleDesign } from '@guardian/libs';\nimport { from, space, until } from '@guardian/source-foundations';\nimport type { FEElement, RoleType } from '../../types/content';\n\ntype Props = {\n\tchildren: React.ReactNode;\n\tformat: ArticleFormat;\n\tisMainMedia: boolean;\n\trole?: RoleType | 'richLink';\n\tid?: string;\n\tclassName?: string;\n\ttype?: FEElement['_type'];\n};\n\nconst roleCss = {\n\tinline: css`\n\t\tmargin-top: ${space[3]}px;\n\t\tmargin-bottom: ${space[3]}px;\n\t`,\n\n\tsupporting: css`\n\t\tclear: left;\n\t\tmargin-top: ${space[3]}px;\n\t\tmargin-bottom: ${space[3]}px;\n\t\t${from.tablet} {\n\t\t\tposition: relative;\n\t\t\tfloat: left;\n\t\t\twidth: 300px;\n\t\t\tmargin-right: 20px;\n\t\t\tline-height: 0;\n\t\t\tmargin-top: ${space[2]}px;\n\t\t}\n\t\t${from.leftCol} {\n\t\t\tmargin-left: -160px;\n\t\t}\n\t\t${from.wide} {\n\t\t\twidth: 380px;\n\t\t\tmargin-left: -240px;\n\t\t}\n\t`,\n\n\timmersive: css`\n\t\tmargin-top: ${space[3]}px;\n\t\tmargin-bottom: ${space[3]}px;\n\t\t${until.tablet} {\n\t\t\tmargin-left: -20px;\n\t\t\tmargin-right: -20px;\n\t\t}\n\t\t${until.mobileLandscape} {\n\t\t\tmargin-left: -10px;\n\t\t\tmargin-right: -10px;\n\t\t}\n\t\t${from.tablet} {\n\t\t\tmargin-left: -20px;\n\t\t\tmargin-right: -100px;\n\t\t}\n\t\t${from.desktop} {\n\t\t\tmargin-left: -20px;\n\t\t\tmargin-right: -340px;\n\t\t}\n\t\t${from.leftCol} {\n\t\t\tmargin-left: -160px;\n\t\t\tmargin-right: -320px;\n\t\t}\n\t\t${from.wide} {\n\t\t\tmargin-left: -240px;\n\t\t\tmargin-right: -400px;\n\t\t}\n\t`,\n\n\tshowcase: css`\n\t\tmargin-top: ${space[3]}px;\n\t\tmargin-bottom: ${space[3]}px;\n\t\tposition: relative;\n\t\t${from.leftCol} {\n\t\t\tmargin-left: -160px;\n\t\t}\n\t\t${from.wide} {\n\t\t\tmargin-left: -240px;\n\t\t}\n\t`,\n\n\tthumbnail: css`\n\t\tmargin-top: ${space[2]}px;\n\t\tmargin-bottom: ${space[2]}px;\n\t\tfloat: left;\n\t\tclear: left;\n\t\twidth: 120px;\n\t\tmargin-right: 20px;\n\t\t${from.tablet} {\n\t\t\twidth: 140px;\n\t\t}\n\t\t${from.wide} {\n\t\t\tmargin-left: -240px;\n\t\t}\n\t\t${from.leftCol} {\n\t\t\tposition: relative;\n\t\t\tmargin-left: -160px;\n\t\t}\n\t`,\n\n\t// This is a special use case where we want RichLinks to appear wider when in the left col\n\trichLink: css`\n\t\tmargin-bottom: ${space[1]}px;\n\t\tfloat: left;\n\t\tclear: left;\n\t\twidth: 140px;\n\t\tmargin-right: 20px;\n\t\t${from.tablet} {\n\t\t\twidth: 140px;\n\t\t}\n\t\t${from.leftCol} {\n\t\t\tposition: relative;\n\t\t\tmargin-left: -160px;\n\t\t\twidth: 140px;\n\t\t}\n\t\t${from.wide} {\n\t\t\tmargin-left: -240px;\n\t\t\twidth: 220px;\n\t\t}\n\t`,\n\n\thalfWidth: css`\n\t\tmargin-top: ${space[3]}px;\n\t\tmargin-bottom: ${space[3]}px;\n\t\twidth: 50%;\n\t\tfloat: left;\n\t\tclear: left;\n\t\tmargin-right: 16px;\n\t`,\n};\n\n// Used for vast majority of layouts.\nexport const defaultRoleStyles = (\n\trole: RoleType | 'richLink',\n\tformat: ArticleFormat,\n) => {\n\tswitch (role) {\n\t\tcase 'inline':\n\t\t\treturn roleCss.inline;\n\t\tcase 'supporting':\n\t\t\treturn roleCss.supporting;\n\t\tcase 'immersive':\n\t\t\treturn roleCss.immersive;\n\t\tcase 'showcase':\n\t\t\treturn roleCss.showcase;\n\t\tcase 'thumbnail':\n\t\t\tswitch (format.design) {\n\t\t\t\tcase ArticleDesign.LiveBlog:\n\t\t\t\tcase ArticleDesign.DeadBlog:\n\t\t\t\t\t// In blogs we don't want to use negative left margins\n\t\t\t\t\treturn css`\n\t\t\t\t\t\t${roleCss.thumbnail}\n\t\t\t\t\t\t/* It's important we use the media query here to ensure we override the default values */\n\t\t\t\t\t\t${from.leftCol} {\n\t\t\t\t\t\t\tmargin-left: 0px;\n\t\t\t\t\t\t}\n\t\t\t\t\t`;\n\t\t\t\tdefault:\n\t\t\t\t\treturn roleCss.thumbnail;\n\t\t\t}\n\t\tcase 'richLink':\n\t\t\treturn roleCss.richLink;\n\t\tcase 'halfWidth':\n\t\t\treturn roleCss.halfWidth;\n\t\tdefault:\n\t\t\treturn roleCss.inline;\n\t}\n};\n\nconst mainMediaFigureStyles = css`\n\theight: 100%;\n`;\n\nexport const Figure = ({\n\trole = 'inline',\n\tformat,\n\tchildren,\n\tid,\n\tisMainMedia,\n\tclassName = '',\n\ttype,\n}: Props) => {\n\tif (isMainMedia) {\n\t\t// Don't add in-body styles for main media elements\n\t\t// TODO: If we want to support other element types having role position, such\n\t\t// as showcase twitter embeds, then we should remove the role positioning which\n\t\t// currently lives in ImageComponent and hoist it up to here, the same as we're\n\t\t// doing using decidePosition for in-body elements\n\t\treturn (\n\t\t\t<figure id={id} key={id} css={mainMediaFigureStyles}>\n\t\t\t\t{children}\n\t\t\t</figure>\n\t\t);\n\t}\n\n\treturn (\n\t\t<figure\n\t\t\tid={id}\n\t\t\tcss={defaultRoleStyles(role, format)}\n\t\t\tdata-spacefinder-role={role}\n\t\t\tdata-spacefinder-type={type}\n\t\t\tclassName={className}\n\t\t>\n\t\t\t{children}\n\t\t</figure>\n\t);\n};\n","import { css } from '@emotion/react';\nimport { ArticleSpecial } from '@guardian/libs';\nimport { body, space, textSans } from '@guardian/source-foundations';\nimport libDebounce from 'lodash.debounce';\nimport { useRef, useState } from 'react';\nimport type { RoleType } from '../../types/content';\nimport type { Palette } from '../../types/palette';\nimport { interactiveLegacyFigureClasses } from '../layouts/lib/interactiveLegacyStyling';\nimport { decidePalette } from '../lib/decidePalette';\nimport { useOnce } from '../lib/useOnce';\nimport { Caption } from './Caption';\nimport { defaultRoleStyles } from './Figure';\nimport { Placeholder } from './Placeholder';\n\ntype Props = {\n\turl?: string;\n\tscriptUrl?: string;\n\talt?: string;\n\trole?: RoleType;\n\tcaption?: string;\n\tformat: ArticleFormat;\n\telementId?: string;\n\tisMainMedia: boolean;\n};\n\n/*\nHISTORY\n\nA CAPI response for an interactive elements looks like:\n{\n\t\"type\": \"interactive\",\n\t\"assets\": [],\n\t\"interactiveTypeData\": {\n\t\t\"originalUrl\": \"https://interactive.guim.co.uk/charts/embed/jan/2019-01-05T14:22:01/embed.html\",\n\t\t\"source\": \"Guardian\",\n\t\t\"alt\": \"china 1978 gdp\",\n\t\t\"scriptUrl\": \"https://interactive.guim.co.uk/embed/iframe-wrapper/0.1/boot.js\",\n\t\t\"html\": \"<a href=\\\"https://interactive.guim.co.uk/charts/embed/jan/2019-01-05T14:22:01/embed.html\\\">china 1978 gdp</a>\",\n\t\t\"scriptName\": \"iframe-wrapper\",\n\t\t\"iframeUrl\": \"https://interactive.guim.co.uk/charts/embed/jan/2019-01-05T14:22:01/embed.html\",\n\t\t\"role\": \"supporting\",\n\t\t\"isMandatory\": false\n\t\t}\n}\n\nOn Frontend, the HTML that we send to the browser is:\n<figure class=\"element element-interactive interactive element--supporting\" data-interactive=\"https://interactive.guim.co.uk/embed/iframe-wrapper/0.1/boot.js\" data-canonical-url=\"https://interactive.guim.co.uk/charts/embed/jan/2019-01-05T14:22:01/embed.html\" data-alt=\"china 1978 gdp\">\n\t<a href=\"https://interactive.guim.co.uk/charts/embed/jan/2019-01-05T14:22:01/embed.html\" data-link-name=\"in body link\" class=\"u-underline\">china 1978 gdp</a>\n</figure>\n\nhttps://github.com/guardian/frontend/blob/e38da96c59eaaef143b9f89b2318eab9dcf2fc5a/common/app/views/fragments/inlineJSNonBlocking.scala.html#L52\nWe use the curl AMD loader to load the boot script from the data-interactive attribute:\n\trequire([el.getAttribute('data-interactive')], function (interactive) {\n\t\tinteractive.boot(el, document, window.guardian.config);\n\t}\n\nPulling from Kibana, 99% of articles use the standard iframe-wrapper/1.0/boot.js\nA vast minority of pre interactive atom use a customised boot.js\nhttps://gist.github.com/gtrufitt/c8f08caef0ae810a42fde5a4c0549ad0\n\n\nTHE STANDARD BOOT.js\nboot.js is defined from https://github.com/guardian/interactive-boot-scripts/blob/master/iframe-wrapper/boot.js\nand is sent with all interactive elements in the scriptUrl from CAPI to do a two simple things:\n- Create an iframe using the href of the anchor and set the src\n- Add event listener to the window to listen for 'message' of the following types\n\t- set-height\n\t- navigate\n\t- scroll-to\n\t- get-location\n\t- get-position\n\t- monitor-position\n\nIt has not been updated since 2016.\n\nMIGRATION FROM FRONTEND\n- For the standard boot.js, we have re-written the behavior in modern JS to avoid the requirement of an AMD loader\nand to avoid loading the boot.js file.\n- For all other files that do not load the standard boot.js, we'll add a AMD loader to the page\n\nFor the remaining few we dynamically load and AMD loader and support the contract as defined with curl AMD loader\n\n*/\nconst decideHeight = (role: RoleType) => {\n\tswitch (role) {\n\t\tcase 'supporting':\n\t\t\treturn 200;\n\t\tdefault:\n\t\t\treturn 500;\n\t}\n};\nconst getMinHeight = (role: RoleType, loaded: boolean) => {\n\tif (loaded) {\n\t\treturn `auto`;\n\t}\n\treturn `${decideHeight(role)}px`;\n};\nconst wrapperStyle = ({\n\tformat,\n\trole,\n\tloaded,\n\tpalette,\n}: {\n\tformat: ArticleFormat;\n\trole: RoleType;\n\tloaded: boolean;\n\tpalette: Palette;\n}) => css`\n\t${format.theme === ArticleSpecial.Labs ? textSans.medium() : body.medium()};\n\tbackground-color: ${palette.background.article};\n\tmin-height: ${getMinHeight(role, loaded)};\n\tposition: relative;\n`;\n\nconst placeholderLinkStyle = css`\n\tposition: absolute;\n\tbottom: ${space[1]}px;\n\tleft: ${space[1]}px;\n`;\n\n// https://interactive.guim.co.uk/embed/iframe-wrapper/0.1/boot.js\nconst setupWindowListeners = (iframe: HTMLIFrameElement) => {\n\t// Calls func on trailing edge of the wait period\n\n\tconst postMessage = (message: Record<string, unknown>) => {\n\t\tif (iframe.contentWindow) {\n\t\t\tiframe.contentWindow.postMessage(JSON.stringify(message), '*');\n\t\t}\n\t};\n\n\twindow.addEventListener(\n\t\t'message',\n\t\t(event) => {\n\t\t\tif (event.source !== iframe.contentWindow) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet message: Record<string, unknown> | undefined;\n\t\t\ttry {\n\t\t\t\tmessage = JSON.parse(event.data);\n\t\t\t} catch (e) {\n\t\t\t\twindow.guardian.modules.sentry.reportError(\n\t\t\t\t\t// @ts-expect-error\n\t\t\t\t\te,\n\t\t\t\t\t'Json parse Failed on in interactiveBlockComponent',\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (message === undefined) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst postPositionMessage = (subscribe?: boolean) => {\n\t\t\t\tconst iframeBox = iframe.getBoundingClientRect();\n\t\t\t\tpostMessage({\n\t\t\t\t\tid: message?.id || '',\n\t\t\t\t\ttype: message?.type || '',\n\t\t\t\t\tsubscribe: !!subscribe,\n\t\t\t\t\tiframeTop: iframeBox.top,\n\t\t\t\t\tiframeRight: iframeBox.right,\n\t\t\t\t\tiframeBottom: iframeBox.bottom,\n\t\t\t\t\tiframeLeft: iframeBox.left,\n\t\t\t\t\tinnerHeight: window.innerHeight,\n\t\t\t\t\tinnerWidth: window.innerWidth,\n\t\t\t\t\tpageYOffset: window.pageYOffset,\n\t\t\t\t});\n\t\t\t};\n\n\t\t\t// Actions\n\t\t\tswitch (message.type) {\n\t\t\t\tcase 'set-height':\n\t\t\t\t\tif (typeof message.value === 'number') {\n\t\t\t\t\t\tiframe.height = message.value.toString();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'navigate':\n\t\t\t\t\tif (typeof message.value === 'string') {\n\t\t\t\t\t\tdocument.location.href = message.value;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'scroll-to':\n\t\t\t\t\tif (\n\t\t\t\t\t\ttypeof message.x === 'number' &&\n\t\t\t\t\t\ttypeof message.y === 'number'\n\t\t\t\t\t) {\n\t\t\t\t\t\twindow.scrollTo(message.x, message.y);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'get-location':\n\t\t\t\t\tpostMessage({\n\t\t\t\t\t\tid: message.id,\n\t\t\t\t\t\ttype: message.type,\n\t\t\t\t\t\thash: window.location.hash,\n\t\t\t\t\t\thost: window.location.host,\n\t\t\t\t\t\thostname: window.location.hostname,\n\t\t\t\t\t\thref: window.location.href,\n\t\t\t\t\t\torigin: window.location.origin,\n\t\t\t\t\t\tpathname: window.location.pathname,\n\t\t\t\t\t\tport: window.location.port,\n\t\t\t\t\t\tprotocol: window.location.protocol,\n\t\t\t\t\t\tsearch: window.location.search,\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'get-position':\n\t\t\t\t\tpostPositionMessage();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'monitor-position':\n\t\t\t\t\t// Send initial position\n\t\t\t\t\tpostPositionMessage(true);\n\n\t\t\t\t\t// Send updated position on scroll or resize\n\t\t\t\t\twindow.addEventListener(\n\t\t\t\t\t\t'scroll',\n\t\t\t\t\t\tlibDebounce(() => {\n\t\t\t\t\t\t\tpostPositionMessage(true);\n\t\t\t\t\t\t}, 50),\n\t\t\t\t\t);\n\t\t\t\t\twindow.addEventListener(\n\t\t\t\t\t\t'resize',\n\t\t\t\t\t\tlibDebounce(() => {\n\t\t\t\t\t\t\tpostPositionMessage(true);\n\t\t\t\t\t\t}, 50),\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\t\tfalse,\n\t);\n};\n\nexport const InteractiveBlockComponent = ({\n\turl,\n\tscriptUrl,\n\talt,\n\trole = 'inline',\n\tcaption,\n\tformat,\n\telementId = '',\n\tisMainMedia,\n}: Props) => {\n\tconst wrapperRef = useRef<HTMLDivElement>(null);\n\tconst placeholderLinkRef = useRef<HTMLAnchorElement>(null);\n\tconst [loaded, setLoaded] = useState(false);\n\tconst palette = decidePalette(format);\n\tuseOnce(() => {\n\t\t// We've brought the behavior from boot.js into this file to avoid loading 2 extra scripts\n\t\tif (\n\t\t\tscriptUrl ===\n\t\t\t\t'https://interactive.guim.co.uk/embed/iframe-wrapper/0.1/boot.js' &&\n\t\t\turl &&\n\t\t\tplaceholderLinkRef.current\n\t\t) {\n\t\t\tconst iframe = document.createElement('iframe');\n\t\t\tiframe.style.width = '100%';\n\t\t\tiframe.style.border = 'none';\n\t\t\tiframe.height = decideHeight(role).toString();\n\t\t\tiframe.title = caption ?? alt ?? 'Interactive Content';\n\t\t\tif (url.startsWith('http:')) {\n\t\t\t\tiframe.src = url.replace('http:', 'https:');\n\t\t\t} else {\n\t\t\t\tiframe.src = url;\n\t\t\t}\n\n\t\t\tsetupWindowListeners(iframe);\n\n\t\t\twrapperRef.current?.appendChild(iframe);\n\n\t\t\tsetLoaded(true);\n\t\t} else if (scriptUrl) {\n\t\t\t// We're going to use curl AMD loader to load the script that the\n\t\t\t// interactive has given us.\n\t\t\twindow.require(\n\t\t\t\t[scriptUrl],\n\t\t\t\t(interactive: {\n\t\t\t\t\tboot: (\n\t\t\t\t\t\tel: HTMLDivElement,\n\t\t\t\t\t\tdocument: Document,\n\t\t\t\t\t\tconfig: unknown,\n\t\t\t\t\t) => void;\n\t\t\t\t}) => {\n\t\t\t\t\tif (wrapperRef.current !== null) {\n\t\t\t\t\t\tinteractive.boot(\n\t\t\t\t\t\t\twrapperRef.current,\n\t\t\t\t\t\t\tdocument,\n\t\t\t\t\t\t\twindow.guardian.config,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t);\n\n\t\t\tsetLoaded(true);\n\t\t}\n\t}, [loaded]);\n\n\treturn (\n\t\t<>\n\t\t\t<figure\n\t\t\t\tid={elementId} // boot scripts use id when inserting interactive content\n\t\t\t\tref={wrapperRef}\n\t\t\t\tcss={[\n\t\t\t\t\tdefaultRoleStyles(role, format),\n\t\t\t\t\twrapperStyle({ format, role, loaded, palette }),\n\t\t\t\t]}\n\t\t\t\tclassName={interactiveLegacyFigureClasses(\n\t\t\t\t\t'model.dotcomrendering.pageElements.InteractiveBlockElement',\n\t\t\t\t\trole,\n\t\t\t\t)}\n\t\t\t\tdata-alt={alt} // for compatibility with custom boot scripts\n\t\t\t\tdata-cypress={`interactive-element-${encodeURI(alt ?? '')}`}\n\t\t\t\tdata-spacefinder-role={role}\n\t\t\t>\n\t\t\t\t{!loaded && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<Placeholder // removed by HydrateInteractiveOnce\n\t\t\t\t\t\t\theight={decideHeight(role)}\n\t\t\t\t\t\t\tshouldShimmer={false}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\tref={placeholderLinkRef}\n\t\t\t\t\t\t\tdata-name=\"placeholder\" // removed by HydrateInteractiveOnce\n\t\t\t\t\t\t\tcss={placeholderLinkStyle}\n\t\t\t\t\t\t\thref={url}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{alt}\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</figure>\n\t\t\t{!!caption && (\n\t\t\t\t<Caption\n\t\t\t\t\tcaptionText={caption}\n\t\t\t\t\tformat={format}\n\t\t\t\t\tisMainMedia={isMainMedia}\n\t\t\t\t/>\n\t\t\t)}\n\t\t</>\n\t);\n};\n","import { css, keyframes } from '@emotion/react';\nimport { neutral, space } from '@guardian/source-foundations';\n\nconst BACKGROUND_COLOUR = neutral[93];\n\ntype Props = {\n\theight: number;\n\trootId?: string;\n\twidth?: number;\n\tspaceBelow?: 1 | 2 | 3 | 4 | 5 | 6 | 9;\n\tspaceLeft?: 1 | 2 | 3 | 4 | 5 | 6 | 9;\n\tshouldShimmer?: boolean;\n\tbackgroundColor?: string;\n};\n\nconst shimmer = keyframes`\n  0% {\n    background-position: -1500px 0;\n  }\n  100% {\n    background-position: 1500px 0;\n  }\n`;\n\nconst shimmerStyles = (backgroundColor: string) => css`\n\tanimation: ${shimmer} 2s infinite linear;\n\tbackground: linear-gradient(\n\t\tto right,\n\t\t${backgroundColor} 4%,\n\t\twhite 25%,\n\t\t${backgroundColor} 36%\n\t);\n\tbackground-size: 1500px 100%;\n`;\n\nexport const Placeholder = ({\n\theight,\n\trootId,\n\twidth,\n\tspaceBelow,\n\tspaceLeft,\n\tshouldShimmer = true,\n\tbackgroundColor = BACKGROUND_COLOUR,\n}: Props) => (\n\t<div\n\t\tid={rootId}\n\t\tcss={css`\n\t\t\tflex-grow: 1;\n\t\t`}\n\t\tdata-name=\"placeholder\"\n\t>\n\t\t<div\n\t\t\tcss={css`\n\t\t\t\theight: ${height}px;\n\t\t\t\twidth: ${width !== undefined ? `${width}px` : '100%'};\n\t\t\t\tmargin-bottom: ${spaceBelow && space[spaceBelow]}px;\n\t\t\t\tmargin-left: ${spaceLeft && space[spaceLeft]}px;\n\t\t\t\tbackground-color: ${backgroundColor};\n\n\t\t\t\t${shouldShimmer && shimmerStyles(backgroundColor)}\n\t\t\t`}\n\t\t/>\n\t</div>\n);\n","import { css } from '@emotion/react';\nimport { ArticleDesign } from '@guardian/libs';\nimport { from, until } from '@guardian/source-foundations';\nimport type { RoleType } from '../../../types/content';\nimport { center } from '../../lib/center';\n\nexport const isInteractive = (design: ArticleDesign): boolean =>\n\tdesign === ArticleDesign.Interactive;\n\nexport const interactiveLegacyFigureClasses = (\n\telementType: string,\n\trole?: RoleType,\n): string => {\n\tconst elementClasses: { [key: string]: string } = {\n\t\t'model.dotcomrendering.pageElements.InteractiveAtomBlockElement':\n\t\t\t'element-atom',\n\t\t'model.dotcomrendering.pageElements.InteractiveBlockElement':\n\t\t\t'element-interactive',\n\t};\n\n\tconst roleClass = role ? ` element-${role}` : '';\n\tconst elementClass = elementClasses[elementType] ?? '';\n\tconst legacyRoleClass = role ? ` element--${role}` : '';\n\treturn `element ${elementClass}${legacyRoleClass}${roleClass}`;\n};\n\n// Classes present in Frontend that we add for legacy interactives.\nexport const interactiveLegacyClasses = {\n\tcontentInteractive: 'content--interactive',\n\tcontentLabels: 'content__labels',\n\tcontentLabelsNotImmersive: 'content__labels--not-immersive',\n\tcontentMainColumn: 'content__main-column--interactive',\n\theadline: 'content__headline',\n\tlabelLink: 'content__label__link',\n\tmetaContainer: 'content__meta-container_dcr',\n\tstandFirst: 'content__standfirst',\n\tbyline: 'byline',\n\tshareIcons: 'meta__social',\n\tshareAndCommentCounts: 'meta__comment',\n\n\t// some legacy interactives do not use the content--interactive container\n\t// to ensure all editorial content has correct font, we need to target this too\n\tinteractiveWrapper: 'interactive-wrapper',\n};\n\n// Styles expected by interactives from the Frontend days. These shouldn't be\n// used for new interactives though.\nexport const interactiveGlobalStyles = css`\n\t/* Scope this as tightly as possible. Otherwise, e.g. box-model will break\n\tfooter. */\n\tbody article {\n\t\t*:before,\n\t\t*:after {\n\t\t\tbox-sizing: content-box;\n\t\t}\n\n\t\t.fc-container__inner,\n\t\t.gs-container {\n\t\t\t${center}\n\t\t}\n\n\t\t/* There is room for better solution where we don't have to load global styles onto the body.\n\t\t\tFor now this works, but we shouldn't support for it for newly made interactives. */\n\t\t.${interactiveLegacyClasses.contentInteractive},\n\t\t\t.${interactiveLegacyClasses.interactiveWrapper} {\n\t\t\tmargin-bottom: 1rem;\n\n\t\t\t/* stylelint-disable */\n\t\t\tfont-family: GuardianTextEgyptian, Guardian Text Egyptian Web,\n\t\t\t\tGeorgia, serif;\n\t\t\t/* stylelint-enable */\n\n\t\t\tfont-size: 1.0625rem;\n\t\t\tline-height: 1.5;\n\t\t\tfont-weight: 400;\n\t\t}\n\n\t\tbutton,\n\t\tinput,\n\t\toptgroup,\n\t\tselect,\n\t\ttextarea {\n\t\t\tcolor: inherit;\n\t\t}\n\n\t\tbutton,\n\t\thtml input[type='button'],\n\t\tinput[type='reset'],\n\t\tinput[type='submit'] {\n\t\t\tcursor: pointer;\n\t\t}\n\n\t\t/* Start social icon support */\n\t\t.meta__social {\n\t\t\tpadding-top: 0.375rem;\n\t\t}\n\n\t\t.social__item {\n\t\t\tfloat: left;\n\t\t\tmin-width: 2rem;\n\t\t\tpadding: 0 0.1875rem 0.375rem 0;\n\t\t\tcursor: pointer;\n\n\t\t\t.inline-icon__fallback {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\n\t\t\t.inline-icon {\n\t\t\t\tbackground-color: transparent;\n\t\t\t\tborder: 1px solid #dcdcdc; /* stylelint-disable-line */\n\t\t\t\ttransition: fill 0.3s ease, background-color 0.3s ease;\n\t\t\t}\n\n\t\t\t.social-icon {\n\t\t\t\twhite-space: nowrap;\n\t\t\t\toverflow: hidden;\n\t\t\t\ttext-overflow: ellipsis;\n\t\t\t\tborder: 0;\n\t\t\t\tmin-width: 2rem;\n\t\t\t\tmax-width: 100%;\n\t\t\t\twidth: auto;\n\t\t\t\theight: 2rem;\n\t\t\t\tsvg {\n\t\t\t\t\theight: 88%;\n\t\t\t\t\twidth: 88%;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t.rounded-icon {\n\t\t\t\tborder-radius: 62.5rem;\n\t\t\t\tdisplay: inline-block;\n\t\t\t\tvertical-align: middle;\n\t\t\t\tposition: relative;\n\t\t\t}\n\n\t\t\t.centered-icon svg {\n\t\t\t\ttop: 0;\n\t\t\t\tbottom: 0;\n\t\t\t\tright: 0;\n\t\t\t\tleft: 0;\n\t\t\t\tmargin: auto;\n\t\t\t\tposition: absolute;\n\t\t\t}\n\t\t}\n\n\t\t.content__dateline {\n\t\t\tfont-size: 0.75rem;\n\t\t\tline-height: 1rem;\n\t\t\tposition: relative;\n\t\t\tbox-sizing: border-box;\n\t\t\tpadding-top: 0.125rem;\n\t\t\tmargin-bottom: 0.375rem;\n\t\t}\n\t\t/* End social icon support */\n\n\t\t/* Typically required for ad display. */\n\t\t${until.tablet} {\n\t\t\t.hide-until-tablet {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t}\n\n\t\t${from.tablet} {\n\t\t\t.mobile-only {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t}\n\n\t\t.interactive-atom {\n\t\t\tposition: relative;\n\t\t}\n\n\t\tol,\n\t\tul {\n\t\t\tpadding: 0;\n\t\t\tmargin-left: 1.5625rem;\n\t\t}\n\t}\n`;\n","import { css } from '@emotion/react';\nimport { from } from '@guardian/source-foundations';\n\nexport const center = css`\n\tposition: relative;\n\tmargin: auto;\n\n\t${from.tablet} {\n\t\tmax-width: 740px;\n\t}\n\n\t${from.desktop} {\n\t\tmax-width: 980px;\n\t}\n\n\t${from.leftCol} {\n\t\tmax-width: 1140px;\n\t}\n\n\t${from.wide} {\n\t\tmax-width: 1300px;\n\t}\n`;\n","import { useEffect, useState } from 'react';\n\n/**\n * Ensures that the given task is only run once and only after all items in waitFor are defined\n * @param {Function} task - The task to execute once\n * @param {Array} waitFor - An array of variables that must be defined before the task is executed\n * */\nexport const useOnce = (task: () => void, waitFor: unknown[]): void => {\n\tconst [alreadyRun, setAlreadyRun] = useState(false);\n\tconst isReady = waitFor.every((dep) => dep !== undefined);\n\tuseEffect(() => {\n\t\tif (!alreadyRun && isReady) {\n\t\t\ttask();\n\t\t\tsetAlreadyRun(true);\n\t\t}\n\t}, [alreadyRun, isReady, task]);\n};\n"],"names":["module","exports","desvg","captionStyle","palette","css","textSans","text","caption","bottomMarginStyles","overlaidStyles","format","overlaidCaption","display","ArticleDisplay","design","ArticleDesign","overlaidBottomPadding","limitedWidth","from","veryLimitedWidth","captionPadding","tabletCaptionPadding","until","videoPadding","between","space","bigLeftMargin","hideIconBelowLeftCol","iconStyle","fill","cameraCaptionIcon","videoIconStyle","captionLink","CameraIcon","span","CameraSvg","VideoIcon","VideoSvg","Caption","captionText","padCaption","credit","displayCredit","shouldLimitWidth","isOverlaid","isLeftCol","mediaType","isMainMedia","trim","decidePalette","isBlog","defaultCaption","figcaption","dangerouslySetInnerHTML","__html","theme","ArticleSpecial","lineHeight","roleCss","inline","supporting","immersive","showcase","thumbnail","richLink","halfWidth","defaultRoleStyles","role","decideHeight","wrapperStyle","loaded","body","background","article","getMinHeight","placeholderLinkStyle","InteractiveBlockComponent","url","scriptUrl","alt","elementId","wrapperRef","useRef","placeholderLinkRef","setLoaded","useState","useOnce","current","iframe","document","createElement","style","width","border","height","toString","title","startsWith","src","replace","postMessage","message","contentWindow","JSON","stringify","window","addEventListener","event","source","parse","data","e","guardian","modules","sentry","reportError","undefined","postPositionMessage","subscribe","iframeBox","getBoundingClientRect","id","type","iframeTop","top","iframeRight","right","iframeBottom","bottom","iframeLeft","left","innerHeight","innerWidth","pageYOffset","value","location","href","x","y","scrollTo","hash","host","hostname","origin","pathname","port","protocol","search","libDebounce","setupWindowListeners","appendChild","require","interactive","boot","config","figure","ref","className","interactiveLegacyFigureClasses","data-alt","data-cypress","encodeURI","data-spacefinder-role","Placeholder","shouldShimmer","a","data-name","BACKGROUND_COLOUR","neutral","shimmer","keyframes","shimmerStyles","backgroundColor","rootId","spaceBelow","spaceLeft","div","elementType","roleClass","elementClasses","elementClass","legacyRoleClass","interactiveLegacyClasses","contentInteractive","contentLabels","contentLabelsNotImmersive","contentMainColumn","headline","labelLink","metaContainer","standFirst","byline","shareIcons","shareAndCommentCounts","interactiveWrapper","center","task","waitFor","alreadyRun","setAlreadyRun","isReady","every","dep","useEffect"],"sourceRoot":""}