{"version":3,"file":"LiveBlogEpic-importable.modern.e61ac84eb3c47a29f35e.js","mappings":"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","sources":["webpack://@guardian/dotcom-rendering/./src/lib/articleCount.ts","webpack://@guardian/dotcom-rendering/./src/web/components/LiveBlogEpic.importable.tsx","webpack://@guardian/dotcom-rendering/./src/web/lib/useSDC.ts","webpack://@guardian/dotcom-rendering/./src/web/lib/contributions.ts","webpack://@guardian/dotcom-rendering/./src/web/lib/dailyArticleCount.ts","webpack://@guardian/dotcom-rendering/./src/web/lib/getIdapiUserData.ts","webpack://@guardian/dotcom-rendering/./src/web/lib/setAutomat.ts","webpack://@guardian/dotcom-rendering/./src/web/lib/useOnce.ts","webpack://@guardian/dotcom-rendering/../node_modules/@guardian/libs/esm/joinUrl/joinUrl.js","webpack://@guardian/dotcom-rendering/../node_modules/@guardian/source-foundations/esm/space/space.js","webpack://@guardian/dotcom-rendering/../node_modules/@guardian/source-foundations/esm/utils/px-to-rem.js","webpack://@guardian/dotcom-rendering/../node_modules/@guardian/support-dotcom-components/dist/index.esm.js"],"sourcesContent":["import { storage } from '@guardian/libs';\nimport {\n\tgetWeeklyArticleHistory,\n\tincrementWeeklyArticleCount,\n} from '@guardian/support-dotcom-components';\nimport type { WeeklyArticleHistory } from '@guardian/support-dotcom-components/dist/dotcom/src/types';\nimport { useEffect, useState } from 'react';\nimport { hasOptedOutOfArticleCount } from '../web/lib/contributions';\nimport type { DailyArticleHistory } from '../web/lib/dailyArticleCount';\nimport {\n\tgetDailyArticleCount,\n\tincrementDailyArticleCount,\n} from '../web/lib/dailyArticleCount';\n\nexport interface ArticleCounts {\n\tweeklyArticleHistory: WeeklyArticleHistory;\n\tdailyArticleHistory: DailyArticleHistory;\n}\n\n// We should monitor this function call to ensure it only happens within an\n// article pages when other pages are supported by DCR.\nexport const getArticleCounts = async (\n\tpageId: string,\n\tkeywordIds: string,\n): Promise<ArticleCounts | undefined> => {\n\tif (await hasOptedOutOfArticleCount()) return undefined;\n\n\t// hasOptedOut needs to be done before we check if articleCount is set in the window\n\t// This is because a potential race condition where one invocation of getArticleCounts\n\t// is waiting for hasOptedOut another invocation might receive it and increment the article count.\n\tif (!window.guardian.weeklyArticleCount) {\n\t\tincrementWeeklyArticleCount(\n\t\t\tstorage.local,\n\t\t\tpageId,\n\t\t\tkeywordIds.split(','),\n\t\t);\n\n\t\twindow.guardian.weeklyArticleCount = getWeeklyArticleHistory(\n\t\t\tstorage.local,\n\t\t);\n\t}\n\tif (!window.guardian.dailyArticleCount) {\n\t\tincrementDailyArticleCount();\n\t\twindow.guardian.dailyArticleCount = getDailyArticleCount();\n\t}\n\n\treturn {\n\t\tweeklyArticleHistory: window.guardian.weeklyArticleCount ?? [],\n\t\tdailyArticleHistory: window.guardian.dailyArticleCount ?? [],\n\t};\n};\n\nexport const useArticleCounts = (\n\tpageId: string,\n\tkeywordIds: string,\n): ArticleCounts | undefined | 'Pending' => {\n\tconst [articleCounts, setArticleCounts] = useState<\n\t\tArticleCounts | undefined | 'Pending'\n\t>('Pending');\n\n\tuseEffect(() => {\n\t\tgetArticleCounts(pageId, keywordIds)\n\t\t\t.then(setArticleCounts)\n\t\t\t.catch(() => setArticleCounts(undefined));\n\t}, [pageId, keywordIds]);\n\n\treturn articleCounts;\n};\n","import { css } from '@emotion/react';\nimport type { CountryCode } from '@guardian/libs';\nimport { getCookie, log, storage } from '@guardian/libs';\nimport { space } from '@guardian/source-foundations';\nimport { getEpicViewLog } from '@guardian/support-dotcom-components';\nimport type { EpicPayload } from '@guardian/support-dotcom-components/dist/dotcom/src/types';\nimport React, { useEffect, useState } from 'react';\nimport { createPortal } from 'react-dom';\nimport { useArticleCounts } from '../../lib/articleCount';\nimport type { TagType } from '../../types/tag';\nimport { submitComponentEvent } from '../browser/ophan/ophan';\nimport {\n\tgetLastOneOffContributionTimestamp,\n\tisRecurringContributor,\n\tshouldHideSupportMessaging,\n\tuseHasOptedOutOfArticleCount,\n} from '../lib/contributions';\nimport { getLocaleCode } from '../lib/getCountryCode';\nimport { setAutomat } from '../lib/setAutomat';\nimport { useSDCLiveblogEpic } from '../lib/useSDC';\n\ntype Props = {\n\tsection: string;\n\tshouldHideReaderRevenue: boolean;\n\tisPaidContent: boolean;\n\ttags: TagType[];\n\tcontributionsServiceUrl: string;\n\tpageId: string;\n\tkeywordIds: string;\n};\n\nconst useCountryCode = () => {\n\tconst [countryCode, setCountryCode] = useState<CountryCode | null>();\n\n\tuseEffect(() => {\n\t\tgetLocaleCode()\n\t\t\t.then((cc) => {\n\t\t\t\tsetCountryCode(cc);\n\t\t\t})\n\t\t\t.catch((e) => {\n\t\t\t\tconst msg = `Error fetching country code: ${String(e)}`;\n\t\t\t\twindow.guardian.modules.sentry.reportError(\n\t\t\t\t\tnew Error(msg),\n\t\t\t\t\t'liveblog-epic',\n\t\t\t\t);\n\t\t\t});\n\t}, []);\n\n\treturn countryCode;\n};\n\nconst useEpic = ({ url, name }: { url: string; name: string }) => {\n\t// Using state here to store the Epic component that gets imported allows\n\t// us to render it with React (instead of inserting it into the dom manually)\n\tconst [Epic, setEpic] =\n\t\tuseState<React.ElementType<{ [key: string]: unknown }>>();\n\n\tuseEffect(() => {\n\t\tsetAutomat();\n\t\twindow\n\t\t\t.guardianPolyfilledImport(url)\n\t\t\t.then((epicModule) => {\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-unsafe-return -- required for dynamic import\n\t\t\t\tsetEpic(() => epicModule[name]); // useState requires functions to be wrapped\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tconst msg = `Error importing LiveBlog epic: ${String(err)}`;\n\t\t\t\twindow.guardian.modules.sentry.reportError(\n\t\t\t\t\tnew Error(msg),\n\t\t\t\t\t'liveblog-epic',\n\t\t\t\t);\n\t\t\t});\n\t}, [url, name]);\n\n\treturn { Epic };\n};\n\n/**\n * usePayload\n *\n * takes a series of CAPI values, reads consent, the users country, some cookie\n * values and then constructs a config object with `tracking` and `targeting`\n * properties\n *\n * @returns the payload object required to make the POST request to contributions\n */\nconst usePayload = ({\n\tshouldHideReaderRevenue,\n\tsection,\n\tisPaidContent,\n\ttags,\n\tpageId,\n\tkeywordIds,\n}: {\n\tshouldHideReaderRevenue: boolean;\n\tsection: string;\n\tisPaidContent: boolean;\n\ttags: TagType[];\n\tpageId: string;\n\tkeywordIds: string;\n}): EpicPayload | undefined => {\n\tconst articleCounts = useArticleCounts(pageId, keywordIds);\n\tconst hasOptedOutOfArticleCount = useHasOptedOutOfArticleCount();\n\tconst countryCode = useCountryCode();\n\tconst mvtId =\n\t\tNumber(getCookie({ name: 'GU_mvt_id', shouldMemoize: true })) || 0;\n\tconst isSignedIn = !!getCookie({ name: 'GU_U', shouldMemoize: true });\n\n\tif (articleCounts === 'Pending') return;\n\tif (hasOptedOutOfArticleCount === 'Pending') return;\n\tlog('dotcom', 'LiveBlogEpic has consent state');\n\tif (!countryCode) return;\n\tlog('dotcom', 'LiveBlogEpic has countryCode');\n\n\treturn {\n\t\ttracking: {\n\t\t\tophanPageId: window.guardian.config.ophan.pageViewId,\n\t\t\tplatformId: 'GUARDIAN_WEB',\n\t\t\tclientName: 'dcr',\n\t\t\treferrerUrl: window.location.origin + window.location.pathname,\n\t\t},\n\t\ttargeting: {\n\t\t\tcontentType: 'LiveBlog',\n\t\t\tsectionId: section,\n\t\t\tshouldHideReaderRevenue,\n\t\t\tisMinuteArticle: true,\n\t\t\tisPaidContent,\n\t\t\ttags,\n\t\t\tshowSupportMessaging: !shouldHideSupportMessaging(isSignedIn),\n\t\t\tisRecurringContributor: isRecurringContributor(isSignedIn),\n\t\t\tlastOneOffContributionDate:\n\t\t\t\tgetLastOneOffContributionTimestamp() ?? undefined,\n\t\t\tmvtId,\n\t\t\tcountryCode,\n\t\t\tepicViewLog: getEpicViewLog(storage.local),\n\t\t\tweeklyArticleHistory: articleCounts?.weeklyArticleHistory,\n\t\t\thasOptedOutOfArticleCount,\n\t\t\tmodulesVersion: 'v3',\n\t\t\turl: window.location.origin + window.location.pathname,\n\t\t},\n\t};\n};\n\n/**\n * Render\n *\n * Dynamically imports and renders a given module\n *\n * @param props\n * @param props.url string - The url of the component\n * @param props.name tring - The name of the component\n * @param props.props object - The props of the component\n * @returns The resulting react component\n */\nconst Render = ({\n\turl,\n\tname,\n\tprops,\n}: {\n\turl: string;\n\tname: string;\n\tprops: { [key: string]: unknown };\n}) => {\n\tconst { Epic } = useEpic({ url, name });\n\n\tif (Epic === undefined) return null;\n\tlog('dotcom', 'LiveBlogEpic has the Epic');\n\n\treturn (\n\t\t<aside\n\t\t\tcss={css`\n\t\t\t\tmargin-bottom: ${space[3]}px;\n\t\t\t`}\n\t\t>\n\t\t\t{}\n\t\t\t<Epic {...props} />\n\t\t</aside>\n\t);\n};\n\n/**\n * Using the payload, make a fetch request to contributions service\n *\n * @param payload - unknown\n * @param contributionsServiceUrl - string\n */\nconst Fetch = ({\n\tpayload,\n\tcontributionsServiceUrl,\n}: {\n\tpayload: EpicPayload;\n\tcontributionsServiceUrl: string;\n}) => {\n\tconst response = useSDCLiveblogEpic(contributionsServiceUrl, payload);\n\n\t// If we didn't get a module in response (or we're still waiting) do nothing. If\n\t// no epic should be shown the response is equal to {}, hence the Object.keys\n\tif (!response?.data || Object.keys(response).length === 0) {\n\t\treturn null;\n\t}\n\tlog('dotcom', 'LiveBlogEpic has a module');\n\n\t// Add submitComponentEvent function to props to enable Ophan tracking in the component\n\tconst props = {\n\t\t...response.data.module.props,\n\t\tsubmitComponentEvent,\n\t};\n\n\t// Take any returned module and render it\n\treturn (\n\t\t<Render\n\t\t\turl={response.data.module.url}\n\t\t\tname={response.data.module.name}\n\t\t\tprops={props}\n\t\t/>\n\t);\n};\n\nfunction insertAfter(referenceNode: HTMLElement, newNode: Element) {\n\treferenceNode.parentNode?.insertBefore(newNode, referenceNode.nextSibling);\n}\n\n/**\n * LiveBlogEpic is the support epic which appears in-between blocks in blogs\n *\n * There are three main steps to create this epic:\n *\n * 1. usePayload - Build the payload. The config object we send to contributions\n * 2. Fetch - POST the payload to the contributions endpoint\n * 3. Render - Take the url, props and name data we got in response to our fetch and dynamically import\n *    and render the Epic component using it\n */\nexport const LiveBlogEpic = ({\n\tsection,\n\tshouldHideReaderRevenue,\n\tisPaidContent,\n\ttags,\n\tcontributionsServiceUrl,\n\tpageId,\n\tkeywordIds,\n}: Props) => {\n\tlog('dotcom', 'LiveBlogEpic started');\n\n\t// First construct the payload\n\tconst payload = usePayload({\n\t\tshouldHideReaderRevenue,\n\t\tsection,\n\t\tisPaidContent,\n\t\ttags,\n\t\tpageId,\n\t\tkeywordIds,\n\t});\n\tif (!payload) return null;\n\n\t/**\n\t * Here we decide where to insert the epic.\n\t *\n\t * If the url contains a permalink then we\n\t * want to insert it immediately after that block to prevent any CLS issues.\n\t *\n\t * Otherwise, we choose a random position near the top of the blog\n\t */\n\tconst epicPlaceholder = document.createElement('article');\n\tif (window.location.href.includes('#block-')) {\n\t\t// Because we're using a permalink there's a possibility the epic will render in\n\t\t// view. To prevent confusing layout shift we initially hide the message so that\n\t\t// we can reveal (animate in) it once it has been rendered\n\t\tepicPlaceholder.classList.add('pending');\n\t\tconst blockId = window.location.hash.slice(1);\n\t\tconst blockLinkedTo = document.getElementById(blockId);\n\t\tif (blockLinkedTo) {\n\t\t\tinsertAfter(blockLinkedTo, epicPlaceholder);\n\t\t}\n\t\tepicPlaceholder.classList.add('reveal');\n\t\tepicPlaceholder.classList.remove('pending');\n\t} else {\n\t\t// This is a simple page load so we simply insert the epic somewhere near the top\n\t\t// of the blog\n\t\tconst randomPosition = Math.floor(Math.random() * 3) + 1; // 1, 2 or 3\n\t\tconst aBlockNearTheTop =\n\t\t\tdocument.querySelectorAll<HTMLElement>('article.block')[\n\t\t\t\trandomPosition\n\t\t\t];\n\t\tif (aBlockNearTheTop) {\n\t\t\tinsertAfter(aBlockNearTheTop, epicPlaceholder);\n\t\t}\n\t}\n\n\treturn createPortal(\n\t\t<Fetch\n\t\t\tpayload={payload}\n\t\t\tcontributionsServiceUrl={contributionsServiceUrl}\n\t\t/>,\n\t\tepicPlaceholder,\n\t);\n};\n","import type { ModuleDataResponse } from '@guardian/support-dotcom-components';\nimport {\n\tgetBanner,\n\tgetEpic,\n\tgetLiveblogEpic,\n\tgetPuzzlesBanner,\n} from '@guardian/support-dotcom-components';\nimport type {\n\tBannerPayload,\n\tEpicPayload,\n} from '@guardian/support-dotcom-components/dist/dotcom/src/types';\nimport useSWRImmutable from 'swr';\n\nconst useSDC = <T>(\n\tkey: string,\n\tfetcher: (baseUrl: string, payload: T) => Promise<ModuleDataResponse>,\n): ModuleDataResponse | undefined => {\n\tconst { data, error } = useSWRImmutable(key, fetcher);\n\tif (error) {\n\t\twindow.guardian.modules.sentry.reportError(error, 'rr-epic');\n\t}\n\treturn data;\n};\n\n/**\n * Hooks for making requests to the support-dotcom-components API\n */\ntype UseSDC<T> = (\n\tbaseUrl: string,\n\tpayload: T,\n) => ModuleDataResponse | undefined;\n\nexport const useSDCEpic: UseSDC<EpicPayload> = (baseUrl, payload) =>\n\tuseSDC('epic', () => getEpic(baseUrl, payload));\n\nexport const useSDCLiveblogEpic: UseSDC<EpicPayload> = (baseUrl, payload) =>\n\tuseSDC('liveblog-epic', () => getLiveblogEpic(baseUrl, payload));\n\nexport const useSDCBanner: UseSDC<BannerPayload> = (baseUrl, payload) =>\n\tuseSDC('banner', () => getBanner(baseUrl, payload));\n\nexport const useSDCPuzzlesBanner: UseSDC<BannerPayload> = (baseUrl, payload) =>\n\tuseSDC('puzzles', () => getPuzzlesBanner(baseUrl, payload));\n","import { onConsentChange } from '@guardian/consent-management-platform';\nimport { getCookie } from '@guardian/libs';\nimport type { HeaderPayload } from '@guardian/support-dotcom-components/dist/dotcom/src/types';\nimport { useState } from 'react';\nimport type { FEArticleType } from '../../types/frontend';\nimport type { IdApiUserData } from './getIdapiUserData';\nimport { getIdApiUserData } from './getIdapiUserData';\nimport { useOnce } from './useOnce';\n\n// User Atributes API cookies (dropped on sign-in)\nexport const HIDE_SUPPORT_MESSAGING_COOKIE = 'gu_hide_support_messaging';\nexport const RECURRING_CONTRIBUTOR_COOKIE = 'gu_recurring_contributor';\nexport const ONE_OFF_CONTRIBUTION_DATE_COOKIE = 'gu_one_off_contribution_date';\nexport const OPT_OUT_OF_ARTICLE_COUNT_COOKIE = 'gu_article_count_opt_out';\n\n// Support Frontend cookies (dropped when contribution is made)\nexport const SUPPORT_RECURRING_CONTRIBUTOR_MONTHLY_COOKIE =\n\t'gu.contributions.recurring.contrib-timestamp.Monthly';\nexport const SUPPORT_RECURRING_CONTRIBUTOR_ANNUAL_COOKIE =\n\t'gu.contributions.recurring.contrib-timestamp.Annual';\nexport const SUPPORT_ONE_OFF_CONTRIBUTION_COOKIE =\n\t'gu.contributions.contrib-timestamp';\n\n//  Local storage keys\nconst DAILY_ARTICLE_COUNT_KEY = 'gu.history.dailyArticleCount';\nconst WEEKLY_ARTICLE_COUNT_KEY = 'gu.history.weeklyArticleCount';\nexport const NO_RR_BANNER_TIMESTAMP_KEY = 'gu.noRRBannerTimestamp'; // timestamp of when we were last told not to show a RR banner\n\n// See https://github.com/guardian/support-dotcom-components/blob/main/module-versions.md\nexport const MODULES_VERSION = 'v3';\n\n// Cookie set by the User Attributes API upon signing in.\n// Value computed server-side and looks at all of the user's active products,\n// including but not limited to recurring & one-off contributions,\n// paper & digital subscriptions, as well as user tiers (GU supporters/staff/partners/patrons).\n// https://github.com/guardian/members-data-api/blob/3a72dc00b9389968d91e5930686aaf34d8040c52/membership-attribute-service/app/models/Attributes.scala\nconst shouldShowSupportMessaging = (): boolean => {\n\tconst hideSupportMessaging =\n\t\tgetCookie({ name: HIDE_SUPPORT_MESSAGING_COOKIE }) === 'true';\n\n\treturn !hideSupportMessaging;\n};\n\n// Determine if user is a recurring contributor by checking if they are signed in\n// AND have at least one of the relevant cookies.\n// We need to look at both User Attributes and Frontend Support cookies\n// as the former might not reflect the latest contributor status, since it's set upon signing in.\n// Frontend Support cookies are set when a contribution is made.\nexport const isRecurringContributor = (isSignedIn: boolean): boolean => {\n\t// Attributes cookie - we want this to have a specific value\n\tconst isRecurringContributorFromAttrs =\n\t\tgetCookie({ name: RECURRING_CONTRIBUTOR_COOKIE }) === 'true';\n\n\t// Support cookies - we only care whether these exist\n\tconst hasMonthlyContributionCookie =\n\t\tgetCookie({\n\t\t\tname: SUPPORT_RECURRING_CONTRIBUTOR_MONTHLY_COOKIE,\n\t\t\tshouldMemoize: true,\n\t\t}) !== null;\n\tconst hasAnnualContributionCookie =\n\t\tgetCookie({\n\t\t\tname: SUPPORT_RECURRING_CONTRIBUTOR_ANNUAL_COOKIE,\n\t\t\tshouldMemoize: true,\n\t\t}) !== null;\n\n\treturn (\n\t\tisSignedIn &&\n\t\t(isRecurringContributorFromAttrs ||\n\t\t\thasMonthlyContributionCookie ||\n\t\t\thasAnnualContributionCookie)\n\t);\n};\n\n// looks at attribute and support cookies\n// ONE_OFF_CONTRIBUTION_DATE_COOKIE (attributes cookie, when loggin in)\n// SUPPORT_ONE_OFF_CONTRIBUTION_COOKIE (support cookie, when making one-off contribution)\n// Get the date of the latest one-off contribution by looking at the two relevant cookies\n// and returning a Unix epoch string of the latest date found.\nexport const getLastOneOffContributionTimestamp = (): number | undefined => {\n\t// Attributes cookie - expects YYYY-MM-DD\n\tconst contributionDateFromAttributes = getCookie({\n\t\tname: ONE_OFF_CONTRIBUTION_DATE_COOKIE,\n\t});\n\n\t// Support cookies - expects Unix epoch\n\tconst contributionDateFromSupport = getCookie({\n\t\tname: SUPPORT_ONE_OFF_CONTRIBUTION_COOKIE,\n\t});\n\n\tif (!contributionDateFromAttributes && !contributionDateFromSupport) {\n\t\treturn undefined;\n\t}\n\n\t// Parse dates into common format so they can be compared\n\tconst parsedDateFromAttributes = contributionDateFromAttributes\n\t\t? Date.parse(contributionDateFromAttributes)\n\t\t: 0;\n\tconst parsedDateFromSupport = contributionDateFromSupport\n\t\t? parseInt(contributionDateFromSupport, 10)\n\t\t: 0;\n\n\t// Return most recent date\n\t// Condition only passed if 'parsedDateFromAttributes' is NOT NaN\n\tif (parsedDateFromAttributes > parsedDateFromSupport) {\n\t\treturn parsedDateFromAttributes;\n\t}\n\n\treturn parsedDateFromSupport || undefined; // This guards against 'parsedDateFromSupport' being NaN\n};\n\nexport const getLastOneOffContributionDate = (): string | undefined => {\n\tconst timestamp = getLastOneOffContributionTimestamp();\n\n\tif (timestamp === undefined) {\n\t\treturn undefined;\n\t}\n\n\tconst date = new Date(timestamp);\n\tconst year = date.getFullYear();\n\tconst month = (date.getMonth() + 1).toString().padStart(2, '0');\n\tconst day = date.getDate().toString().padStart(2, '0');\n\n\treturn `${year}-${month}-${day}`;\n};\n\nconst dateDiffDays = (from: number, to: number): number => {\n\tconst oneDayMs = 1000 * 60 * 60 * 24;\n\tconst diffMs = to - from;\n\treturn Math.floor(diffMs / oneDayMs);\n};\n\nconst AskPauseDays = 90;\n\nexport const isRecentOneOffContributor = (): boolean => {\n\tconst lastContributionDate = getLastOneOffContributionTimestamp();\n\tif (lastContributionDate !== undefined) {\n\t\tconst now = Date.now();\n\t\treturn dateDiffDays(lastContributionDate, now) <= AskPauseDays;\n\t}\n\n\treturn false;\n};\n\nexport const shouldHideSupportMessaging = (isSignedIn = false): boolean =>\n\t!shouldShowSupportMessaging() ||\n\tisRecurringContributor(isSignedIn) ||\n\tisRecentOneOffContributor();\n\nexport const REQUIRED_CONSENTS_FOR_ARTICLE_COUNT = [1, 3, 7];\nconst REQUIRED_CONSENTS_FOR_BROWSER_ID = [1, 3, 5, 7];\n\nexport const hasArticleCountOptOutCookie = (): boolean =>\n\tgetCookie({ name: OPT_OUT_OF_ARTICLE_COUNT_COOKIE }) !== null;\n\nconst removeArticleCountsFromLocalStorage = () => {\n\twindow.localStorage.removeItem(DAILY_ARTICLE_COUNT_KEY);\n\twindow.localStorage.removeItem(WEEKLY_ARTICLE_COUNT_KEY);\n};\n\nexport const hasCmpConsentForArticleCount = (): Promise<boolean> => {\n\treturn new Promise((resolve) => {\n\t\tif (getCookie({ name: 'gu-cmp-disabled', shouldMemoize: true })) {\n\t\t\tresolve(true);\n\t\t}\n\t\tonConsentChange(({ ccpa, tcfv2, aus }) => {\n\t\t\tif (ccpa || aus) {\n\t\t\t\tresolve(true);\n\t\t\t} else if (tcfv2) {\n\t\t\t\tconst hasRequiredConsents =\n\t\t\t\t\tREQUIRED_CONSENTS_FOR_ARTICLE_COUNT.every(\n\t\t\t\t\t\t(consent) => tcfv2.consents[consent],\n\t\t\t\t\t);\n\n\t\t\t\tif (!hasRequiredConsents) {\n\t\t\t\t\tremoveArticleCountsFromLocalStorage();\n\t\t\t\t}\n\t\t\t\tresolve(hasRequiredConsents);\n\t\t\t}\n\t\t});\n\t});\n};\n\nexport const hasOptedOutOfArticleCount = async (): Promise<boolean> => {\n\tconst hasCmpConsent = await hasCmpConsentForArticleCount();\n\treturn !hasCmpConsent || hasArticleCountOptOutCookie();\n};\n\n// A hook to find out if a user has opted out of article counting\nexport const useHasOptedOutOfArticleCount = (): boolean | 'Pending' => {\n\tconst [hasOptedOut, setHasOptedOut] = useState<boolean | 'Pending'>(\n\t\t'Pending',\n\t);\n\n\tuseOnce(() => {\n\t\thasOptedOutOfArticleCount()\n\t\t\t.then(setHasOptedOut)\n\t\t\t.catch(() => setHasOptedOut(true));\n\t}, []);\n\n\treturn hasOptedOut;\n};\n\nexport const hasCmpConsentForBrowserId = (): Promise<boolean> =>\n\tnew Promise((resolve) => {\n\t\tif (getCookie({ name: 'gu-cmp-disabled', shouldMemoize: true })) {\n\t\t\tresolve(true);\n\t\t}\n\t\tonConsentChange(({ ccpa, tcfv2, aus }) => {\n\t\t\tif (ccpa || aus) {\n\t\t\t\tresolve(true);\n\t\t\t} else if (tcfv2) {\n\t\t\t\tconst hasRequiredConsents =\n\t\t\t\t\tREQUIRED_CONSENTS_FOR_BROWSER_ID.every(\n\t\t\t\t\t\t(consent) => tcfv2.consents[consent],\n\t\t\t\t\t);\n\t\t\t\tresolve(hasRequiredConsents);\n\t\t\t}\n\t\t});\n\t});\n\nconst twentyMins = 20 * 60000;\nexport const withinLocalNoBannerCachePeriod = (): boolean => {\n\tconst item = window.localStorage.getItem(NO_RR_BANNER_TIMESTAMP_KEY);\n\tif (item && !Number.isNaN(parseInt(item, 10))) {\n\t\tconst withinCachePeriod = parseInt(item, 10) + twentyMins > Date.now();\n\t\tif (!withinCachePeriod) {\n\t\t\t// Expired\n\t\t\twindow.localStorage.removeItem(NO_RR_BANNER_TIMESTAMP_KEY);\n\t\t}\n\t\treturn withinCachePeriod;\n\t}\n\treturn false;\n};\n\nexport const setLocalNoBannerCachePeriod = (): void =>\n\twindow.localStorage.setItem(NO_RR_BANNER_TIMESTAMP_KEY, `${Date.now()}`);\n\nconst getEmail = (ajaxUrl: string): Promise<string | undefined> => {\n\treturn getIdApiUserData(ajaxUrl)\n\t\t.then((data: IdApiUserData) => data.user?.primaryEmailAddress)\n\t\t.catch((error) => {\n\t\t\twindow.guardian.modules.sentry.reportError(error, 'getEmail');\n\t\t\treturn undefined;\n\t\t});\n};\n\nexport const lazyFetchEmailWithTimeout =\n\t(idapiUrl: string): (() => Promise<string | null>) =>\n\t() => {\n\t\treturn new Promise((resolve) => {\n\t\t\tsetTimeout(() => resolve(null), 1000);\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-floating-promises\n\t\t\tgetEmail(idapiUrl).then((email) => {\n\t\t\t\tif (email) {\n\t\t\t\t\tresolve(email);\n\t\t\t\t} else {\n\t\t\t\t\tresolve(null);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t};\n\nexport const getContributionsServiceUrl = (article: FEArticleType): string =>\n\tprocess.env.SDC_URL ?? article.contributionsServiceUrl;\n\ntype PurchaseInfo = HeaderPayload['targeting']['purchaseInfo'];\nexport const getPurchaseInfo = (): PurchaseInfo => {\n\tconst purchaseInfoRaw = getCookie({\n\t\tname: 'GU_CO_COMPLETE',\n\t\tshouldMemoize: true,\n\t});\n\n\tif (!purchaseInfoRaw) {\n\t\treturn undefined;\n\t}\n\n\tlet purchaseInfo: PurchaseInfo;\n\n\ttry {\n\t\tpurchaseInfo = JSON.parse(decodeURIComponent(purchaseInfoRaw));\n\t} catch {} // eslint-disable-line no-empty -- silently handle error\n\n\treturn purchaseInfo;\n};\n","export interface DailyArticle {\n\tday: number;\n\tcount: number;\n}\n\nexport type DailyArticleHistory = Array<DailyArticle>;\n\n// in localStorage, has format {\"value\":[{\"day\":18459,\"count\":1},{\"day\":18457,\"count\":1},{\"day\":18446,\"count\":1}]} to match frontend\ninterface DailyArticleCountLocalStorage {\n\tvalue: DailyArticleHistory;\n}\n\nexport const DailyArticleCountKey = 'gu.history.dailyArticleCount';\n\n// Returns undefined if no daily article count in local storage\nexport const getDailyArticleCount = (): DailyArticleHistory | undefined => {\n\tconst dailyCount = localStorage.getItem(DailyArticleCountKey);\n\n\tif (!dailyCount) {\n\t\treturn undefined;\n\t}\n\n\ttry {\n\t\tconst { value }: DailyArticleCountLocalStorage = JSON.parse(dailyCount);\n\n\t\t// check if value parsed correctly\n\t\tif (!value.length) {\n\t\t\tthrow new Error('Invalid gu.history.dailyArticleCount value');\n\t\t}\n\n\t\treturn value;\n\t} catch (e) {\n\t\t// error parsing the string, so remove the key\n\t\tlocalStorage.removeItem(DailyArticleCountKey);\n\t\treturn undefined;\n\t}\n};\n\nexport const getToday = (): number => Math.floor(Date.now() / 86_400_000);\n\nexport const incrementDailyArticleCount = (): void => {\n\t// get the daily article count from local storage\n\tconst dailyArticleCount = getDailyArticleCount() ?? [];\n\n\t// calculate days since unix epoch for today date\n\tconst today = getToday();\n\n\t// check if latest day is today and increment if so\n\tif (dailyArticleCount[0]?.day === today) {\n\t\tdailyArticleCount[0].count += 1;\n\t} else {\n\t\t// else set new day\n\t\tdailyArticleCount.unshift({ day: today, count: 1 });\n\n\t\t// remove any days older than 60\n\t\tconst cutOff = today - 60;\n\n\t\tconst firstOldDayIndex = dailyArticleCount.findIndex(\n\t\t\t(dailyCount) => dailyCount.day && dailyCount.day < cutOff,\n\t\t);\n\n\t\tif (firstOldDayIndex > 0) {\n\t\t\tdailyArticleCount.splice(firstOldDayIndex);\n\t\t}\n\t}\n\n\t// set the latest article count\n\tlocalStorage.setItem(\n\t\tDailyArticleCountKey,\n\t\tJSON.stringify({\n\t\t\tvalue: dailyArticleCount,\n\t\t} as DailyArticleCountLocalStorage),\n\t);\n};\n","import { joinUrl } from '@guardian/libs';\n\nexport interface IdApiUserData {\n\tuser?: {\n\t\tprimaryEmailAddress?: string;\n\t\tprivateFields?: {\n\t\t\tbrazeUuid?: string;\n\t\t};\n\t};\n}\n\nexport interface IdApiUserIdentifiers {\n\tid: string;\n\tbrazeUuid: string;\n\tpuzzleId: string;\n\tgoogleTagId: string;\n}\n\nfunction checkForErrors(response: Response) {\n\tif (!response.ok) {\n\t\tthrow Error(\n\t\t\tresponse.statusText ||\n\t\t\t\t`getIdApiUserData | An api call returned HTTP status ${response.status}`,\n\t\t);\n\t}\n\treturn response;\n}\n\nconst callApi = (url: string) => {\n\treturn fetch(url, {\n\t\tcredentials: 'include',\n\t})\n\t\t.then(checkForErrors)\n\t\t.then((response) => response.json());\n};\n\nconst cache: {\n\tidapiUserMeResponse?: Promise<IdApiUserData>;\n\tidapiUserIdentifiersResponse?: Promise<IdApiUserIdentifiers>;\n} = {};\n\nexport const getIdApiUserData = (ajaxUrl: string): Promise<IdApiUserData> => {\n\tif (!cache.idapiUserMeResponse) {\n\t\tconst url = joinUrl(ajaxUrl, 'user/me');\n\t\tcache.idapiUserMeResponse = callApi(url);\n\t}\n\treturn cache.idapiUserMeResponse;\n};\n\nexport const getIdapiUserIdentifiers = (\n\tajaxUrl: string,\n): Promise<IdApiUserIdentifiers> => {\n\tif (!cache.idapiUserIdentifiersResponse) {\n\t\tconst url = joinUrl(ajaxUrl, 'user/me/identifiers');\n\t\tcache.idapiUserIdentifiersResponse = callApi(url);\n\t}\n\treturn cache.idapiUserIdentifiersResponse;\n};\n","import * as emotionReact from '@emotion/react';\nimport * as emotionReactJsxRuntime from '@emotion/react/jsx-runtime';\nimport React from 'react';\n\nlet hasAutomatBeenSet = false;\n\nexport const setAutomat = (): void => {\n\tif (!hasAutomatBeenSet) {\n\t\twindow.guardian.automat = {\n\t\t\temotionReact,\n\t\t\temotionReactJsxRuntime,\n\t\t\treact: React,\n\t\t};\n\t\thasAutomatBeenSet = true;\n\t}\n};\n","import { useEffect, useState } from 'react';\n\n/**\n * Ensures that the given task is only run once and only after all items in waitFor are defined\n * @param {Function} task - The task to execute once\n * @param {Array} waitFor - An array of variables that must be defined before the task is executed\n * */\nexport const useOnce = (task: () => void, waitFor: unknown[]): void => {\n\tconst [alreadyRun, setAlreadyRun] = useState(false);\n\tconst isReady = waitFor.every((dep) => dep !== undefined);\n\tuseEffect(() => {\n\t\tif (!alreadyRun && isReady) {\n\t\t\ttask();\n\t\t\tsetAlreadyRun(true);\n\t\t}\n\t}, [alreadyRun, isReady, task]);\n};\n","// detect two or more `/` chars after a word boundary\nconst multipleSlashesInRoute = /\\b\\/{2,}/g;\nconst joinUrl = (...args) => args.join('/').replace(multipleSlashesInRoute, '/');\n\nexport { joinUrl };\n//# sourceMappingURL=joinUrl.js.map\n","import { pxToRem } from '../utils/px-to-rem.js';\n\n/**\n * [Storybook](https://guardian.github.io/csnx/?path=/docs/source-foundations_space--page) •\n * [Design System](https://theguardian.design/2a1e5182b/p/05f835-space)\n *\n * Can be applied to margin or padding properties, vertically or horizontally.\n *\n ** `space[1]` -> 4px\n ** `space[2]` -> 8px\n ** `space[3]` -> 12px\n ** `space[4]` -> 16px\n ** `space[5]` -> 20px\n ** `space[6]` -> 24px\n ** `space[9]` -> 36px\n ** `space[12]` -> 48px\n ** `space[24]` -> 96px\n */\nconst space = {\n    1: 4,\n    2: 8,\n    3: 12,\n    4: 16,\n    5: 20,\n    6: 24,\n    9: 36,\n    12: 48,\n    24: 96,\n};\n/**\n * [Storybook](https://guardian.github.io/csnx/?path=/docs/source-foundations_space--page) •\n * [Design System](https://theguardian.design/2a1e5182b/p/05f835-space)\n *\n * Can be applied to margin or padding properties, vertically or horizontally.\n *\n ** `remSpace[1]` -> 0.25rem\n ** `remSpace[2]` -> 0.5rem\n ** `remSpace[3]` -> 0.75rem\n ** `remSpace[4]` -> 1rem\n ** `remSpace[5]` -> 1.25rem\n ** `remSpace[6]` -> 1.5rem\n ** `remSpace[9]` -> 2.25rem\n ** `remSpace[12]` -> 3rem\n ** `remSpace[24]` -> 6rem\n */\nconst remSpace = {\n    1: `${pxToRem(space[1])}rem`,\n    2: `${pxToRem(space[2])}rem`,\n    3: `${pxToRem(space[3])}rem`,\n    4: `${pxToRem(space[4])}rem`,\n    5: `${pxToRem(space[5])}rem`,\n    6: `${pxToRem(space[6])}rem`,\n    9: `${pxToRem(space[9])}rem`,\n    12: `${pxToRem(space[12])}rem`,\n    24: `${pxToRem(space[24])}rem`,\n};\n/* TODO: this should be exposed as a number instead of a string,\n   so consumers can perform calculations on it */\n\nexport { remSpace, space };\n//# sourceMappingURL=space.js.map\n","const rootPixelFontSize = 16;\nconst pxToRem = (px) => px / rootPixelFontSize;\n\nexport { pxToRem, rootPixelFontSize };\n//# sourceMappingURL=px-to-rem.js.map\n","const e=e=>e.get(\"gu.contributions.views\")||void 0,t=e=>{const t=e.getDay()||7;return Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()-(t-1))/864e5},s=e=>e.get(\"gu.history.weeklyArticleCount\")||void 0,r=new Set([\"environment/climate-change\",\"environment/climate-crisis\",\"environment/environment\",\"science/science\",\"politics/politics\",\"us-news/us-politics\",\"australia-news/australian-politics\",\"world/world\",\"world/europe-news\",\"world/russia\",\"books/books\",\"culture/culture\",\"world/coronavirus-outbreak\",\"world/race\",\"inequality/inequality\",\"technology/technology\",\"business/business\"]),o=(e,t={})=>(e.forEach(e=>{r.has(e)&&(t[e]=(t[e]??0)+1)}),t),n=(e,s,r)=>{if(!((e,s)=>{const r=t(new Date),o=e.get(\"gu.history.articleCountsThisWeek\");if(o&&o.week===r){const t=o.articles[s]||0;return e.set(\"gu.history.articleCountsThisWeek\",{week:r,articles:{...o.articles,[s]:t+1}}),t>0}return e.set(\"gu.history.articleCountsThisWeek\",{week:r,articles:{[s]:1}}),!1})(e,s)){const s=t(new Date),n=e.get(\"gu.history.weeklyArticleCount\")||[],i=n[0];if(i&&i.week&&i.week===s)i.count+=1,i.tags=o(r,i.tags),e.set(\"gu.history.weeklyArticleCount\",n);else{n.unshift({week:s,count:1,tags:o(r,{})});const t=s-365,i=n.filter(e=>e.week>=t);e.set(\"gu.history.weeklyArticleCount\",i)}}},i=(e,t,s)=>{const r=(e=>{if(URLSearchParams){const t=new URLSearchParams(window.location.search).get(\"force-\"+e);if(t)return t}return null})(e);return fetch(`${t}/${e}${r?\"?force=\"+r:\"\"}`,{method:\"post\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(s)}).then(t=>{if(!t.ok)throw Error(t.statusText||`Supporter Revenue ${e} | Api call returned HTTP status ${t.status}`);return t}).then(e=>e.json())},c=(e,t)=>i(\"epic\",e,t),u=(e,t)=>i(\"liveblog-epic\",e,t),a=(e,t)=>i(\"banner\",e,t),l=(e,t)=>i(\"puzzles\",e,t),w=(e,t)=>i(\"header\",e,t);export{a as getBanner,c as getEpic,e as getEpicViewLog,w as getHeader,u as getLiveblogEpic,l as getPuzzlesBanner,s as getWeeklyArticleHistory,n as incrementWeeklyArticleCount};\n"],"names":["getArticleCounts","async","pageId","keywordIds","window","hasOptedOutOfArticleCount","guardian","weeklyArticleCount","incrementWeeklyArticleCount","storage","split","getWeeklyArticleHistory","dailyArticleCount","incrementDailyArticleCount","getDailyArticleCount","weeklyArticleHistory","dailyArticleHistory","useArticleCounts","articleCounts","setArticleCounts","useState","useEffect","then","catch","undefined","Render","url","name","props","Epic","setEpic","setAutomat","guardianPolyfilledImport","epicModule","err","msg","String","modules","sentry","reportError","Error","useEpic","log","aside","css","space","Fetch","payload","contributionsServiceUrl","response","baseUrl","key","fetcher","data","error","useSWRImmutable","useSDC","getLiveblogEpic","useSDCLiveblogEpic","Object","keys","length","module","submitComponentEvent","insertAfter","referenceNode","newNode","parentNode","insertBefore","nextSibling","LiveBlogEpic","section","shouldHideReaderRevenue","isPaidContent","tags","useHasOptedOutOfArticleCount","countryCode","setCountryCode","getLocaleCode","cc","e","useCountryCode","mvtId","Number","getCookie","shouldMemoize","isSignedIn","getLastOneOffContributionTimestamp","tracking","ophanPageId","config","ophan","pageViewId","platformId","clientName","referrerUrl","location","origin","pathname","targeting","contentType","sectionId","isMinuteArticle","showSupportMessaging","shouldHideSupportMessaging","isRecurringContributor","lastOneOffContributionDate","epicViewLog","getEpicViewLog","modulesVersion","usePayload","epicPlaceholder","document","createElement","href","includes","classList","add","blockId","hash","slice","blockLinkedTo","getElementById","remove","randomPosition","Math","floor","random","aBlockNearTheTop","querySelectorAll","createPortal","HIDE_SUPPORT_MESSAGING_COOKIE","RECURRING_CONTRIBUTOR_COOKIE","SUPPORT_RECURRING_CONTRIBUTOR_MONTHLY_COOKIE","SUPPORT_RECURRING_CONTRIBUTOR_ANNUAL_COOKIE","SUPPORT_ONE_OFF_CONTRIBUTION_COOKIE","NO_RR_BANNER_TIMESTAMP_KEY","MODULES_VERSION","shouldShowSupportMessaging","isRecurringContributorFromAttrs","hasMonthlyContributionCookie","hasAnnualContributionCookie","contributionDateFromAttributes","contributionDateFromSupport","parsedDateFromAttributes","Date","parse","parsedDateFromSupport","parseInt","getLastOneOffContributionDate","timestamp","date","year","getFullYear","month","getMonth","toString","padStart","day","getDate","isRecentOneOffContributor","lastContributionDate","from","to","diffMs","now","dateDiffDays","REQUIRED_CONSENTS_FOR_ARTICLE_COUNT","REQUIRED_CONSENTS_FOR_BROWSER_ID","hasCmpConsentForArticleCount","Promise","resolve","onConsentChange","ccpa","tcfv2","aus","hasRequiredConsents","every","consent","consents","localStorage","removeItem","hasOptedOut","setHasOptedOut","useOnce","hasCmpConsentForBrowserId","withinLocalNoBannerCachePeriod","item","getItem","isNaN","withinCachePeriod","setLocalNoBannerCachePeriod","setItem","lazyFetchEmailWithTimeout","idapiUrl","ajaxUrl","setTimeout","getIdApiUserData","user","primaryEmailAddress","email","getPurchaseInfo","purchaseInfoRaw","purchaseInfo","JSON","decodeURIComponent","DailyArticleCountKey","dailyCount","value","getToday","today","count","unshift","cutOff","firstOldDayIndex","findIndex","splice","stringify","checkForErrors","ok","statusText","status","callApi","fetch","credentials","json","cache","idapiUserMeResponse","joinUrl","getIdapiUserIdentifiers","idapiUserIdentifiersResponse","hasAutomatBeenSet","automat","emotionReact","emotionReactJsxRuntime","react","React","task","waitFor","alreadyRun","setAlreadyRun","isReady","dep","multipleSlashesInRoute","args","join","replace","remSpace","pxToRem","px","get","t","getDay","UTC","s","r","Set","o","forEach","has","n","week","articles","set","i","filter","URLSearchParams","search","method","headers","body","c","u","a","l","w"],"sourceRoot":""}