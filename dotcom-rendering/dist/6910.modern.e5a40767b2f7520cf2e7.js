"use strict";(self.webpackChunk_guardian_dotcom_rendering=self.webpackChunk_guardian_dotcom_rendering||[]).push([[6910],{5670:(e,t,n)=>{n.d(t,{R:()=>u,o:()=>c});var r=n(9103),o=n(1279),a=n(3904),i=n(4914),s=n(3633);const c=async(e,t)=>{var n,a;if(!await(0,i.Am)())return window.guardian.weeklyArticleCount||((0,o.DF)(r.t.local,e,t.split(",")),window.guardian.weeklyArticleCount=(0,o.lL)(r.t.local)),window.guardian.dailyArticleCount||((0,s.HN)(),window.guardian.dailyArticleCount=(0,s.lu)()),{weeklyArticleHistory:null!==(n=window.guardian.weeklyArticleCount)&&void 0!==n?n:[],dailyArticleHistory:null!==(a=window.guardian.dailyArticleCount)&&void 0!==a?a:[]}},u=(e,t)=>{const[n,r]=(0,a.useState)("Pending");return(0,a.useEffect)((()=>{c(e,t).then(r).catch((()=>r(void 0)))}),[e,t]),n}},1780:(e,t,n)=>{n.d(t,{P:()=>o});const r=["preview.gutools.co.uk","preview.code.dev-gutools.co.uk","localhost","m.thegulocal.com"],o=()=>{if(window.location.hash){const e="force-braze-message",t=window.location.hash;if(t.includes(e)){if(!r.includes(window.location.hostname))return console.log("".concat(e," is not supported on this domain")),null;const n=t.slice(t.indexOf("".concat(e,"="))+e.length+1,t.length);try{return{dataFromBraze:JSON.parse(decodeURIComponent(n)),logImpressionWithBraze:()=>{},logButtonClickWithBraze:()=>{}}}catch(t){const n=t;console.log("There was an error with ".concat(e,": "),n.message)}}}return null}},2011:(e,t,n)=>{n.d(t,{p:()=>r});const r=e=>!0===window.guardian.config.switches.brazeTaylorReport&&!e.find((e=>"news/series/cotton-capital"===e.id))},4914:(e,t,n)=>{n.d(t,{Am:()=>I,BQ:()=>m,C6:()=>c,CC:()=>w,G9:()=>C,H2:()=>P,K3:()=>l,Pl:()=>M,S9:()=>y,T0:()=>f,Ty:()=>u,ZD:()=>_,cs:()=>A,nh:()=>k,qQ:()=>h,qw:()=>O,tq:()=>v,y0:()=>d});var r=n(8706),o=n(1614),a=n(3904),i=n(3179),s=n(7410);const c="gu_hide_support_messaging",u="gu_recurring_contributor",l="gu.contributions.recurring.contrib-timestamp.Monthly",d="gu.contributions.recurring.contrib-timestamp.Annual",w="gu.contributions.contrib-timestamp",g="gu.noRRBannerTimestamp",m="v3",p=()=>!("true"===(0,o.e)({name:c})),f=e=>{const t="true"===(0,o.e)({name:u}),n=null!==(0,o.e)({name:l,shouldMemoize:!0}),r=null!==(0,o.e)({name:d,shouldMemoize:!0});return e&&(t||n||r)},h=()=>{const e=(0,o.e)({name:"gu_one_off_contribution_date"}),t=(0,o.e)({name:w});if(!e&&!t)return;const n=e?Date.parse(e):0,r=t?parseInt(t,10):0;return n>r?n:r||void 0},v=()=>{const e=h();if(void 0===e)return;const t=new Date(e),n=t.getFullYear(),r=(t.getMonth()+1).toString().padStart(2,"0"),o=t.getDate().toString().padStart(2,"0");return"".concat(n,"-").concat(r,"-").concat(o)},b=()=>{const e=h();return void 0!==e&&((e,t)=>{const n=Date.now()-e;return Math.floor(n/864e5)})(e)<=90},y=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!p()||f(e)||b()},S=[1,3,7],z=[1,3,5,7],C=()=>new Promise((e=>{(0,o.e)({name:"gu-cmp-disabled",shouldMemoize:!0})&&e(!0),(0,r.onConsentChange)((t=>{let{ccpa:n,tcfv2:r,aus:o}=t;if(n||o)e(!0);else if(r){const t=S.every((e=>r.consents[e]));t||(window.localStorage.removeItem("gu.history.dailyArticleCount"),window.localStorage.removeItem("gu.history.weeklyArticleCount")),e(t)}}))})),I=async()=>!await C()||null!==(0,o.e)({name:"gu_article_count_opt_out"}),O=()=>{const[e,t]=(0,a.useState)("Pending");return(0,s.t)((()=>{I().then(t).catch((()=>t(!0)))}),[]),e},P=()=>new Promise((e=>{(0,o.e)({name:"gu-cmp-disabled",shouldMemoize:!0})&&e(!0),(0,r.onConsentChange)((t=>{let{ccpa:n,tcfv2:r,aus:o}=t;if(n||o)e(!0);else if(r){const t=z.every((e=>r.consents[e]));e(t)}}))})),M=()=>{const e=window.localStorage.getItem(g);if(e&&!Number.isNaN(parseInt(e,10))){const t=parseInt(e,10)+12e5>Date.now();return t||window.localStorage.removeItem(g),t}return!1},_=()=>window.localStorage.setItem(g,"".concat(Date.now())),k=e=>()=>new Promise((t=>{var n;setTimeout((()=>t(null)),1e3),(n=e,(0,i._)(n).then((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.primaryEmailAddress})).catch((e=>{window.guardian.modules.sentry.reportError(e,"getEmail")}))).then((e=>{t(e||null)}))})),A=()=>{const e=(0,o.e)({name:"GU_CO_COMPLETE",shouldMemoize:!0});if(!e)return;let t;try{t=JSON.parse(decodeURIComponent(e))}catch(e){}return t}},3633:(e,t,n)=>{n.d(t,{HN:()=>i,lu:()=>o,x2:()=>a});const r="gu.history.dailyArticleCount",o=()=>{const e=localStorage.getItem(r);if(e)try{const{value:t}=JSON.parse(e);if(!t.length)throw new Error("Invalid gu.history.dailyArticleCount value");return t}catch(e){return void localStorage.removeItem(r)}},a=()=>Math.floor(Date.now()/864e5),i=()=>{var e,t;const n=null!==(t=o())&&void 0!==t?t:[],i=a();if((null===(e=n[0])||void 0===e?void 0:e.day)===i)n[0].count+=1;else{n.unshift({day:i,count:1});const e=i-60,t=n.findIndex((t=>t.day&&t.day<e));t>0&&n.splice(t)}localStorage.setItem(r,JSON.stringify({value:n}))}},3179:(e,t,n)=>{n.d(t,{T:()=>c,_:()=>s});var r=n(5726);function o(e){if(!e.ok)throw Error(e.statusText||"getIdApiUserData | An api call returned HTTP status ".concat(e.status));return e}const a=e=>fetch(e,{credentials:"include"}).then(o).then((e=>e.json())),i={},s=e=>{if(!i.idapiUserMeResponse){const t=(0,r.p)(e,"user/me");i.idapiUserMeResponse=a(t)}return i.idapiUserMeResponse},c=e=>{if(!i.idapiUserIdentifiersResponse){const t=(0,r.p)(e,"user/me/identifiers");i.idapiUserIdentifiersResponse=a(t)}return i.idapiUserIdentifiersResponse}},6622:(e,t,n)=>{n.d(t,{B:()=>u});var r=n(8869),o=n(9038);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){a(e,t,n[t])}))}return e}function s(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const c=()=>null,u=e=>{let{candidates:t,name:n}=e;return new Promise((e=>{const a=t.map((e=>((e,t)=>{let n;return s(i({},e),{candidate:s(i({},e.candidate),{canShow:()=>new Promise((a=>{const i="messagePicker-canShow-".concat(e.candidate.id),s=(0,r.i)(i);s.start(),null!==e.timeoutMillis&&(n=window.setTimeout((()=>{((e,t)=>{(0,o.IM)({component:"".concat(t,"-picker-timeout-dcr"),value:e})})(e.candidate.id,t),a({show:!1})}),e.timeoutMillis)),e.candidate.canShow().then((t=>{a(t);const n=s.end();e.reportTiming&&(0,o.IM)({component:i,value:n})})).catch((e=>console.error("timeoutify candidate - error: ".concat(String(e)))))}))}),cancelTimeout:()=>void 0!==n&&clearTimeout(n)})})(e,n))),u=a.map((e=>({candidateConfig:e,canShow:e.candidate.canShow()}))).reduce((async(e,t)=>{let{candidateConfig:n,canShow:r}=t;if(await e)return e;const o=await r;return n.cancelTimeout(),o.show?{candidate:n.candidate,meta:o.meta}:e}),Promise.resolve(null));u.then((t=>{if(a.map((e=>e.cancelTimeout())),null===t)e(c);else{const{candidate:n,meta:r}=t;e((()=>n.show(r)))}})).catch((e=>console.error("pickMessage winner - error: ".concat(String(e)))))}))}},6354:(e,t,n)=>{n.d(t,{R:()=>s});var r=n(43),o=n(7800),a=n(3904);let i=!1;const s=()=>{i||(window.guardian.automat={emotionReact:r,emotionReactJsxRuntime:o,react:a.default},i=!0)}},7617:(e,t,n)=>{n.d(t,{_:()=>v});var r=n(5970),o=n(2699),a=n(9103),i=n(1614),s=n(2803),c=n(8869),u=n(9038);const l="gu.brazeUserSet";var d=n(3179);const w=async e=>(0,d.T)(e).then((e=>e.brazeUuid)).catch((e=>{window.guardian.modules.sentry.reportError(e,"getBrazeUuid")}));var g=n(8706);const m=(e,t,n)=>({isSuccessful:!1,failure:{field:e,data:t},data:n}),p={enableLogging:!0,noCookies:!0,baseUrl:"https://sdk.fra-01.braze.eu/api/v3",sessionTimeoutInSeconds:1,minimumIntervalBetweenTriggerActionsInSeconds:0,devicePropertyAllowlist:[]},f=(()=>{let e;return t=>(void 0===e&&(e=(async e=>{const t=await n.e(7845).then(n.t.bind(n,8e3,23));return t.setLogger((e=>(0,s.c)("tx",e))),t.initialize(e,p),t})(t)),e)})(),h=async e=>{if(!a.t.local.isAvailable())return{brazeMessages:new r.Vp,brazeCards:new r.J9};const t=!!(0,i.e)({name:"GU_U",shouldMemoize:!0}),n=await(async(e,t)=>{const n=((e,t)=>[{name:"apiKey",value:Promise.resolve(window.guardian.config.page.brazeApiKey)},{name:"brazeSwitch",value:Promise.resolve(window.guardian.config.switches.brazeSwitch)},{name:"brazeUuid",value:e?w(t):Promise.resolve(null)},{name:"consent",value:new Promise(((e,t)=>{(0,g.onConsentChange)((n=>{try{e((0,g.getConsentFor)("braze",n))}catch(e){t(e)}}))}))},{name:"isNotPaidContent",value:Promise.resolve(!window.guardian.config.page.isPaidContent)}])(e,t),r={};for(const{name:e,value:t}of n)try{const n=await t;if(!n)return m(e,n,r);r[e]=n}catch(t){return m(e,t instanceof Error?t.message:t,r)}return{isSuccessful:!0,data:r}})(t,e);if(!n.isSuccessful){const{failure:e,data:t}=n;return(0,s.c)("tx","Not attempting to show Braze messages. Dependency ".concat(e.field," failed with ").concat(String(e.data),".")),await(async(e,t,n,o)=>{const a="true"===localStorage.getItem(l);if(!t&&a||!n&&a||!o&&a)try{e&&(await f(e)).wipeData(),r.dL.clear(),localStorage.removeItem(l)}catch(e){window.guardian.modules.sentry.reportError(e,"braze-maybeWipeUserData")}})(t.apiKey,t.brazeUuid,t.consent,t.brazeSwitch),{brazeMessages:new r.Vp,brazeCards:new r.J9}}try{const e=(0,c.i)("braze-sdk-load");e.start();const t=await f(n.data.apiKey),o=e.end();(0,u.IM)({component:"braze-sdk-load-timing",value:o});const a=(e,t)=>{window.guardian.modules.sentry.reportError(e,t)};localStorage.setItem(l,"true"),t.changeUser(n.data.brazeUuid),t.openSession();const i=window.guardian.config.switches.brazeContentCards?new r.BX(t,a):new r.J9;return{brazeMessages:new r.uU(t,r.dL,a),brazeCards:i}}catch(e){return{brazeMessages:new r.Vp,brazeCards:new r.J9}}},v=e=>{const{data:t,error:n}=(0,o.Z)("braze-message",(()=>h(e)));return n?{brazeMessages:new r.Vp,brazeCards:new r.J9}:{brazeMessages:null==t?void 0:t.brazeMessages,brazeCards:null==t?void 0:t.brazeCards}}},4463:(e,t,n)=>{n.d(t,{O:()=>i});var r=n(3198),o=n.n(r),a=n(3904);const i=e=>{const[t,n]=(0,a.useState)(!1);var r;const[i,s]=(0,a.useState)(null!==(r=e.node)&&void 0!==r?r:null),c=(0,a.useRef)(null),u=t=>{let[r]=t;r&&(r.isIntersecting?n(!0):e.repeat&&n(!1))},l=e.debounce?o()(u,200):u;return(0,a.useEffect)((()=>(c.current&&c.current.disconnect(),window.IntersectionObserver&&(c.current=new window.IntersectionObserver(l,e),i&&c.current.observe(i)),()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.disconnect()})),[i,e,l]),[t,s]}},7410:(e,t,n)=>{n.d(t,{t:()=>o});var r=n(3904);const o=(e,t)=>{const[n,o]=(0,r.useState)(!1),a=t.every((e=>void 0!==e));(0,r.useEffect)((()=>{!n&&a&&(e(),o(!0))}),[n,a,e])}}}]);
//# sourceMappingURL=6910.modern.e5a40767b2f7520cf2e7.js.map