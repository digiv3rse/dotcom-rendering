{"version":3,"file":"LiveBlogEpic-importable.legacy.19ac812a31bc547b7a42.js","mappings":"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","sources":["webpack://@guardian/dotcom-rendering/./src/lib/articleCount.ts","webpack://@guardian/dotcom-rendering/./src/web/components/LiveBlogEpic.importable.tsx","webpack://@guardian/dotcom-rendering/./src/web/lib/useSDC.ts","webpack://@guardian/dotcom-rendering/./src/web/lib/contributions.ts","webpack://@guardian/dotcom-rendering/./src/web/lib/dailyArticleCount.ts","webpack://@guardian/dotcom-rendering/./src/web/lib/getIdapiUserData.ts","webpack://@guardian/dotcom-rendering/./src/web/lib/setAutomat.ts","webpack://@guardian/dotcom-rendering/./src/web/lib/useOnce.ts","webpack://@guardian/dotcom-rendering/../../../libs/@guardian/libs/src/joinUrl/joinUrl.ts","webpack://@guardian/dotcom-rendering/../../../libs/@guardian/source-foundations/src/space/space.ts","webpack://@guardian/dotcom-rendering/../../../libs/@guardian/source-foundations/src/utils/px-to-rem.ts","webpack://@guardian/dotcom-rendering/../node_modules/@guardian/support-dotcom-components/dist/index.esm.js"],"sourcesContent":["import { storage } from '@guardian/libs';\nimport { getWeeklyArticleHistory, incrementWeeklyArticleCount, } from '@guardian/support-dotcom-components';\nimport { useEffect, useState } from 'react';\nimport { hasOptedOutOfArticleCount } from '../web/lib/contributions';\nimport { getDailyArticleCount, incrementDailyArticleCount, } from '../web/lib/dailyArticleCount';\n// We should monitor this function call to ensure it only happens within an\n// article pages when other pages are supported by DCR.\nexport const getArticleCounts = async (pageId, keywordIds) => {\n    if (await hasOptedOutOfArticleCount())\n        return undefined;\n    // hasOptedOut needs to be done before we check if articleCount is set in the window\n    // This is because a potential race condition where one invocation of getArticleCounts\n    // is waiting for hasOptedOut another invocation might receive it and increment the article count.\n    if (!window.guardian.weeklyArticleCount) {\n        incrementWeeklyArticleCount(storage.local, pageId, keywordIds.split(','));\n        window.guardian.weeklyArticleCount = getWeeklyArticleHistory(storage.local);\n    }\n    if (!window.guardian.dailyArticleCount) {\n        incrementDailyArticleCount();\n        window.guardian.dailyArticleCount = getDailyArticleCount();\n    }\n    return {\n        weeklyArticleHistory: window.guardian.weeklyArticleCount ?? [],\n        dailyArticleHistory: window.guardian.dailyArticleCount ?? [],\n    };\n};\nexport const useArticleCounts = (pageId, keywordIds) => {\n    const [articleCounts, setArticleCounts] = useState('Pending');\n    useEffect(() => {\n        getArticleCounts(pageId, keywordIds)\n            .then(setArticleCounts)\n            .catch(() => setArticleCounts(undefined));\n    }, [pageId, keywordIds]);\n    return articleCounts;\n};\n","import { jsx as _jsx } from \"@emotion/react/jsx-runtime\";\nimport { css } from '@emotion/react';\nimport { getCookie, log, storage } from '@guardian/libs';\nimport { space } from '@guardian/source-foundations';\nimport { getEpicViewLog } from '@guardian/support-dotcom-components';\nimport React, { useEffect, useState } from 'react';\nimport { createPortal } from 'react-dom';\nimport { useArticleCounts } from '../../lib/articleCount';\nimport { submitComponentEvent } from '../browser/ophan/ophan';\nimport { getLastOneOffContributionTimestamp, isRecurringContributor, shouldHideSupportMessaging, useHasOptedOutOfArticleCount, } from '../lib/contributions';\nimport { getLocaleCode } from '../lib/getCountryCode';\nimport { setAutomat } from '../lib/setAutomat';\nimport { useSDCLiveblogEpic } from '../lib/useSDC';\nconst useCountryCode = () => {\n    const [countryCode, setCountryCode] = useState();\n    useEffect(() => {\n        getLocaleCode()\n            .then((cc) => {\n            setCountryCode(cc);\n        })\n            .catch((e) => {\n            const msg = `Error fetching country code: ${String(e)}`;\n            window.guardian.modules.sentry.reportError(new Error(msg), 'liveblog-epic');\n        });\n    }, []);\n    return countryCode;\n};\nconst useEpic = ({ url, name }) => {\n    // Using state here to store the Epic component that gets imported allows\n    // us to render it with React (instead of inserting it into the dom manually)\n    const [Epic, setEpic] = useState();\n    useEffect(() => {\n        setAutomat();\n        window\n            .guardianPolyfilledImport(url)\n            .then((epicModule) => {\n            // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-unsafe-return -- required for dynamic import\n            setEpic(() => epicModule[name]); // useState requires functions to be wrapped\n        })\n            .catch((err) => {\n            const msg = `Error importing LiveBlog epic: ${String(err)}`;\n            window.guardian.modules.sentry.reportError(new Error(msg), 'liveblog-epic');\n        });\n    }, [url, name]);\n    return { Epic };\n};\n/**\n * usePayload\n *\n * takes a series of CAPI values, reads consent, the users country, some cookie\n * values and then constructs a config object with `tracking` and `targeting`\n * properties\n *\n * @returns the payload object required to make the POST request to contributions\n */\nconst usePayload = ({ shouldHideReaderRevenue, section, isPaidContent, tags, pageId, keywordIds, }) => {\n    const articleCounts = useArticleCounts(pageId, keywordIds);\n    const hasOptedOutOfArticleCount = useHasOptedOutOfArticleCount();\n    const countryCode = useCountryCode();\n    const mvtId = Number(getCookie({ name: 'GU_mvt_id', shouldMemoize: true })) || 0;\n    const isSignedIn = !!getCookie({ name: 'GU_U', shouldMemoize: true });\n    if (articleCounts === 'Pending')\n        return;\n    if (hasOptedOutOfArticleCount === 'Pending')\n        return;\n    log('dotcom', 'LiveBlogEpic has consent state');\n    if (!countryCode)\n        return;\n    log('dotcom', 'LiveBlogEpic has countryCode');\n    return {\n        tracking: {\n            ophanPageId: window.guardian.config.ophan.pageViewId,\n            platformId: 'GUARDIAN_WEB',\n            clientName: 'dcr',\n            referrerUrl: window.location.origin + window.location.pathname,\n        },\n        targeting: {\n            contentType: 'LiveBlog',\n            sectionId: section,\n            shouldHideReaderRevenue,\n            isMinuteArticle: true,\n            isPaidContent,\n            tags,\n            showSupportMessaging: !shouldHideSupportMessaging(isSignedIn),\n            isRecurringContributor: isRecurringContributor(isSignedIn),\n            lastOneOffContributionDate: getLastOneOffContributionTimestamp() ?? undefined,\n            mvtId,\n            countryCode,\n            epicViewLog: getEpicViewLog(storage.local),\n            weeklyArticleHistory: articleCounts?.weeklyArticleHistory,\n            hasOptedOutOfArticleCount,\n            modulesVersion: 'v3',\n            url: window.location.origin + window.location.pathname,\n        },\n    };\n};\n/**\n * Render\n *\n * Dynamically imports and renders a given module\n *\n * @param props\n * @param props.url string - The url of the component\n * @param props.name tring - The name of the component\n * @param props.props object - The props of the component\n * @returns The resulting react component\n */\nconst Render = ({ url, name, props, }) => {\n    const { Epic } = useEpic({ url, name });\n    if (Epic === undefined)\n        return null;\n    log('dotcom', 'LiveBlogEpic has the Epic');\n    return (_jsx(\"aside\", { css: css `\n\t\t\t\tmargin-bottom: ${space[3]}px;\n\t\t\t`, children: _jsx(Epic, { ...props }) }));\n};\n/**\n * Using the payload, make a fetch request to contributions service\n *\n * @param payload - unknown\n * @param contributionsServiceUrl - string\n */\nconst Fetch = ({ payload, contributionsServiceUrl, }) => {\n    const response = useSDCLiveblogEpic(contributionsServiceUrl, payload);\n    // If we didn't get a module in response (or we're still waiting) do nothing. If\n    // no epic should be shown the response is equal to {}, hence the Object.keys\n    if (!response?.data || Object.keys(response).length === 0) {\n        return null;\n    }\n    log('dotcom', 'LiveBlogEpic has a module');\n    // Add submitComponentEvent function to props to enable Ophan tracking in the component\n    const props = {\n        ...response.data.module.props,\n        submitComponentEvent,\n    };\n    // Take any returned module and render it\n    return (_jsx(Render, { url: response.data.module.url, name: response.data.module.name, props: props }));\n};\nfunction insertAfter(referenceNode, newNode) {\n    referenceNode.parentNode?.insertBefore(newNode, referenceNode.nextSibling);\n}\n/**\n * LiveBlogEpic is the support epic which appears in-between blocks in blogs\n *\n * There are three main steps to create this epic:\n *\n * 1. usePayload - Build the payload. The config object we send to contributions\n * 2. Fetch - POST the payload to the contributions endpoint\n * 3. Render - Take the url, props and name data we got in response to our fetch and dynamically import\n *    and render the Epic component using it\n */\nexport const LiveBlogEpic = ({ section, shouldHideReaderRevenue, isPaidContent, tags, contributionsServiceUrl, pageId, keywordIds, }) => {\n    log('dotcom', 'LiveBlogEpic started');\n    // First construct the payload\n    const payload = usePayload({\n        shouldHideReaderRevenue,\n        section,\n        isPaidContent,\n        tags,\n        pageId,\n        keywordIds,\n    });\n    if (!payload)\n        return null;\n    /**\n     * Here we decide where to insert the epic.\n     *\n     * If the url contains a permalink then we\n     * want to insert it immediately after that block to prevent any CLS issues.\n     *\n     * Otherwise, we choose a random position near the top of the blog\n     */\n    const epicPlaceholder = document.createElement('article');\n    if (window.location.href.includes('#block-')) {\n        // Because we're using a permalink there's a possibility the epic will render in\n        // view. To prevent confusing layout shift we initially hide the message so that\n        // we can reveal (animate in) it once it has been rendered\n        epicPlaceholder.classList.add('pending');\n        const blockId = window.location.hash.slice(1);\n        const blockLinkedTo = document.getElementById(blockId);\n        if (blockLinkedTo) {\n            insertAfter(blockLinkedTo, epicPlaceholder);\n        }\n        epicPlaceholder.classList.add('reveal');\n        epicPlaceholder.classList.remove('pending');\n    }\n    else {\n        // This is a simple page load so we simply insert the epic somewhere near the top\n        // of the blog\n        const randomPosition = Math.floor(Math.random() * 3) + 1; // 1, 2 or 3\n        const aBlockNearTheTop = document.querySelectorAll('article.block')[randomPosition];\n        if (aBlockNearTheTop) {\n            insertAfter(aBlockNearTheTop, epicPlaceholder);\n        }\n    }\n    return createPortal(_jsx(Fetch, { payload: payload, contributionsServiceUrl: contributionsServiceUrl }), epicPlaceholder);\n};\n","import { getBanner, getEpic, getLiveblogEpic, getPuzzlesBanner, } from '@guardian/support-dotcom-components';\nimport useSWRImmutable from 'swr';\nconst useSDC = (key, fetcher) => {\n    const { data, error } = useSWRImmutable(key, fetcher);\n    if (error) {\n        window.guardian.modules.sentry.reportError(error, 'rr-epic');\n    }\n    return data;\n};\nexport const useSDCEpic = (baseUrl, payload) => useSDC('epic', () => getEpic(baseUrl, payload));\nexport const useSDCLiveblogEpic = (baseUrl, payload) => useSDC('liveblog-epic', () => getLiveblogEpic(baseUrl, payload));\nexport const useSDCBanner = (baseUrl, payload) => useSDC('banner', () => getBanner(baseUrl, payload));\nexport const useSDCPuzzlesBanner = (baseUrl, payload) => useSDC('puzzles', () => getPuzzlesBanner(baseUrl, payload));\n","import { onConsentChange } from '@guardian/consent-management-platform';\nimport { getCookie } from '@guardian/libs';\nimport { useState } from 'react';\nimport { getIdApiUserData } from './getIdapiUserData';\nimport { useOnce } from './useOnce';\n// User Atributes API cookies (dropped on sign-in)\nexport const HIDE_SUPPORT_MESSAGING_COOKIE = 'gu_hide_support_messaging';\nexport const RECURRING_CONTRIBUTOR_COOKIE = 'gu_recurring_contributor';\nexport const ONE_OFF_CONTRIBUTION_DATE_COOKIE = 'gu_one_off_contribution_date';\nexport const OPT_OUT_OF_ARTICLE_COUNT_COOKIE = 'gu_article_count_opt_out';\n// Support Frontend cookies (dropped when contribution is made)\nexport const SUPPORT_RECURRING_CONTRIBUTOR_MONTHLY_COOKIE = 'gu.contributions.recurring.contrib-timestamp.Monthly';\nexport const SUPPORT_RECURRING_CONTRIBUTOR_ANNUAL_COOKIE = 'gu.contributions.recurring.contrib-timestamp.Annual';\nexport const SUPPORT_ONE_OFF_CONTRIBUTION_COOKIE = 'gu.contributions.contrib-timestamp';\n//  Local storage keys\nconst DAILY_ARTICLE_COUNT_KEY = 'gu.history.dailyArticleCount';\nconst WEEKLY_ARTICLE_COUNT_KEY = 'gu.history.weeklyArticleCount';\nexport const NO_RR_BANNER_TIMESTAMP_KEY = 'gu.noRRBannerTimestamp'; // timestamp of when we were last told not to show a RR banner\n// See https://github.com/guardian/support-dotcom-components/blob/main/module-versions.md\nexport const MODULES_VERSION = 'v3';\n// Cookie set by the User Attributes API upon signing in.\n// Value computed server-side and looks at all of the user's active products,\n// including but not limited to recurring & one-off contributions,\n// paper & digital subscriptions, as well as user tiers (GU supporters/staff/partners/patrons).\n// https://github.com/guardian/members-data-api/blob/3a72dc00b9389968d91e5930686aaf34d8040c52/membership-attribute-service/app/models/Attributes.scala\nconst shouldShowSupportMessaging = () => {\n    const hideSupportMessaging = getCookie({ name: HIDE_SUPPORT_MESSAGING_COOKIE }) === 'true';\n    return !hideSupportMessaging;\n};\n// Determine if user is a recurring contributor by checking if they are signed in\n// AND have at least one of the relevant cookies.\n// We need to look at both User Attributes and Frontend Support cookies\n// as the former might not reflect the latest contributor status, since it's set upon signing in.\n// Frontend Support cookies are set when a contribution is made.\nexport const isRecurringContributor = (isSignedIn) => {\n    // Attributes cookie - we want this to have a specific value\n    const isRecurringContributorFromAttrs = getCookie({ name: RECURRING_CONTRIBUTOR_COOKIE }) === 'true';\n    // Support cookies - we only care whether these exist\n    const hasMonthlyContributionCookie = getCookie({\n        name: SUPPORT_RECURRING_CONTRIBUTOR_MONTHLY_COOKIE,\n        shouldMemoize: true,\n    }) !== null;\n    const hasAnnualContributionCookie = getCookie({\n        name: SUPPORT_RECURRING_CONTRIBUTOR_ANNUAL_COOKIE,\n        shouldMemoize: true,\n    }) !== null;\n    return (isSignedIn &&\n        (isRecurringContributorFromAttrs ||\n            hasMonthlyContributionCookie ||\n            hasAnnualContributionCookie));\n};\n// looks at attribute and support cookies\n// ONE_OFF_CONTRIBUTION_DATE_COOKIE (attributes cookie, when loggin in)\n// SUPPORT_ONE_OFF_CONTRIBUTION_COOKIE (support cookie, when making one-off contribution)\n// Get the date of the latest one-off contribution by looking at the two relevant cookies\n// and returning a Unix epoch string of the latest date found.\nexport const getLastOneOffContributionTimestamp = () => {\n    // Attributes cookie - expects YYYY-MM-DD\n    const contributionDateFromAttributes = getCookie({\n        name: ONE_OFF_CONTRIBUTION_DATE_COOKIE,\n    });\n    // Support cookies - expects Unix epoch\n    const contributionDateFromSupport = getCookie({\n        name: SUPPORT_ONE_OFF_CONTRIBUTION_COOKIE,\n    });\n    if (!contributionDateFromAttributes && !contributionDateFromSupport) {\n        return undefined;\n    }\n    // Parse dates into common format so they can be compared\n    const parsedDateFromAttributes = contributionDateFromAttributes\n        ? Date.parse(contributionDateFromAttributes)\n        : 0;\n    const parsedDateFromSupport = contributionDateFromSupport\n        ? parseInt(contributionDateFromSupport, 10)\n        : 0;\n    // Return most recent date\n    // Condition only passed if 'parsedDateFromAttributes' is NOT NaN\n    if (parsedDateFromAttributes > parsedDateFromSupport) {\n        return parsedDateFromAttributes;\n    }\n    return parsedDateFromSupport || undefined; // This guards against 'parsedDateFromSupport' being NaN\n};\nexport const getLastOneOffContributionDate = () => {\n    const timestamp = getLastOneOffContributionTimestamp();\n    if (timestamp === undefined) {\n        return undefined;\n    }\n    const date = new Date(timestamp);\n    const year = date.getFullYear();\n    const month = (date.getMonth() + 1).toString().padStart(2, '0');\n    const day = date.getDate().toString().padStart(2, '0');\n    return `${year}-${month}-${day}`;\n};\nconst dateDiffDays = (from, to) => {\n    const oneDayMs = 1000 * 60 * 60 * 24;\n    const diffMs = to - from;\n    return Math.floor(diffMs / oneDayMs);\n};\nconst AskPauseDays = 90;\nexport const isRecentOneOffContributor = () => {\n    const lastContributionDate = getLastOneOffContributionTimestamp();\n    if (lastContributionDate !== undefined) {\n        const now = Date.now();\n        return dateDiffDays(lastContributionDate, now) <= AskPauseDays;\n    }\n    return false;\n};\nexport const shouldHideSupportMessaging = (isSignedIn = false) => !shouldShowSupportMessaging() ||\n    isRecurringContributor(isSignedIn) ||\n    isRecentOneOffContributor();\nexport const REQUIRED_CONSENTS_FOR_ARTICLE_COUNT = [1, 3, 7];\nconst REQUIRED_CONSENTS_FOR_BROWSER_ID = [1, 3, 5, 7];\nexport const hasArticleCountOptOutCookie = () => getCookie({ name: OPT_OUT_OF_ARTICLE_COUNT_COOKIE }) !== null;\nconst removeArticleCountsFromLocalStorage = () => {\n    window.localStorage.removeItem(DAILY_ARTICLE_COUNT_KEY);\n    window.localStorage.removeItem(WEEKLY_ARTICLE_COUNT_KEY);\n};\nexport const hasCmpConsentForArticleCount = () => {\n    return new Promise((resolve) => {\n        if (getCookie({ name: 'gu-cmp-disabled', shouldMemoize: true })) {\n            resolve(true);\n        }\n        onConsentChange(({ ccpa, tcfv2, aus }) => {\n            if (ccpa || aus) {\n                resolve(true);\n            }\n            else if (tcfv2) {\n                const hasRequiredConsents = REQUIRED_CONSENTS_FOR_ARTICLE_COUNT.every((consent) => tcfv2.consents[consent]);\n                if (!hasRequiredConsents) {\n                    removeArticleCountsFromLocalStorage();\n                }\n                resolve(hasRequiredConsents);\n            }\n        });\n    });\n};\nexport const hasOptedOutOfArticleCount = async () => {\n    const hasCmpConsent = await hasCmpConsentForArticleCount();\n    return !hasCmpConsent || hasArticleCountOptOutCookie();\n};\n// A hook to find out if a user has opted out of article counting\nexport const useHasOptedOutOfArticleCount = () => {\n    const [hasOptedOut, setHasOptedOut] = useState('Pending');\n    useOnce(() => {\n        hasOptedOutOfArticleCount()\n            .then(setHasOptedOut)\n            .catch(() => setHasOptedOut(true));\n    }, []);\n    return hasOptedOut;\n};\nexport const hasCmpConsentForBrowserId = () => new Promise((resolve) => {\n    if (getCookie({ name: 'gu-cmp-disabled', shouldMemoize: true })) {\n        resolve(true);\n    }\n    onConsentChange(({ ccpa, tcfv2, aus }) => {\n        if (ccpa || aus) {\n            resolve(true);\n        }\n        else if (tcfv2) {\n            const hasRequiredConsents = REQUIRED_CONSENTS_FOR_BROWSER_ID.every((consent) => tcfv2.consents[consent]);\n            resolve(hasRequiredConsents);\n        }\n    });\n});\nconst twentyMins = 20 * 60000;\nexport const withinLocalNoBannerCachePeriod = () => {\n    const item = window.localStorage.getItem(NO_RR_BANNER_TIMESTAMP_KEY);\n    if (item && !Number.isNaN(parseInt(item, 10))) {\n        const withinCachePeriod = parseInt(item, 10) + twentyMins > Date.now();\n        if (!withinCachePeriod) {\n            // Expired\n            window.localStorage.removeItem(NO_RR_BANNER_TIMESTAMP_KEY);\n        }\n        return withinCachePeriod;\n    }\n    return false;\n};\nexport const setLocalNoBannerCachePeriod = () => window.localStorage.setItem(NO_RR_BANNER_TIMESTAMP_KEY, `${Date.now()}`);\nconst getEmail = (ajaxUrl) => {\n    return getIdApiUserData(ajaxUrl)\n        .then((data) => data.user?.primaryEmailAddress)\n        .catch((error) => {\n        window.guardian.modules.sentry.reportError(error, 'getEmail');\n        return undefined;\n    });\n};\nexport const lazyFetchEmailWithTimeout = (idapiUrl) => () => {\n    return new Promise((resolve) => {\n        setTimeout(() => resolve(null), 1000);\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        getEmail(idapiUrl).then((email) => {\n            if (email) {\n                resolve(email);\n            }\n            else {\n                resolve(null);\n            }\n        });\n    });\n};\nexport const getContributionsServiceUrl = (article) => process.env.SDC_URL ?? article.contributionsServiceUrl;\nexport const getPurchaseInfo = () => {\n    const purchaseInfoRaw = getCookie({\n        name: 'GU_CO_COMPLETE',\n        shouldMemoize: true,\n    });\n    if (!purchaseInfoRaw) {\n        return undefined;\n    }\n    let purchaseInfo;\n    try {\n        purchaseInfo = JSON.parse(decodeURIComponent(purchaseInfoRaw));\n    }\n    catch { } // eslint-disable-line no-empty -- silently handle error\n    return purchaseInfo;\n};\n","export const DailyArticleCountKey = 'gu.history.dailyArticleCount';\n// Returns undefined if no daily article count in local storage\nexport const getDailyArticleCount = () => {\n    const dailyCount = localStorage.getItem(DailyArticleCountKey);\n    if (!dailyCount) {\n        return undefined;\n    }\n    try {\n        const { value } = JSON.parse(dailyCount);\n        // check if value parsed correctly\n        if (!value.length) {\n            throw new Error('Invalid gu.history.dailyArticleCount value');\n        }\n        return value;\n    }\n    catch (e) {\n        // error parsing the string, so remove the key\n        localStorage.removeItem(DailyArticleCountKey);\n        return undefined;\n    }\n};\nexport const getToday = () => Math.floor(Date.now() / 86_400_000);\nexport const incrementDailyArticleCount = () => {\n    // get the daily article count from local storage\n    const dailyArticleCount = getDailyArticleCount() ?? [];\n    // calculate days since unix epoch for today date\n    const today = getToday();\n    // check if latest day is today and increment if so\n    if (dailyArticleCount[0]?.day === today) {\n        dailyArticleCount[0].count += 1;\n    }\n    else {\n        // else set new day\n        dailyArticleCount.unshift({ day: today, count: 1 });\n        // remove any days older than 60\n        const cutOff = today - 60;\n        const firstOldDayIndex = dailyArticleCount.findIndex((dailyCount) => dailyCount.day && dailyCount.day < cutOff);\n        if (firstOldDayIndex > 0) {\n            dailyArticleCount.splice(firstOldDayIndex);\n        }\n    }\n    // set the latest article count\n    localStorage.setItem(DailyArticleCountKey, JSON.stringify({\n        value: dailyArticleCount,\n    }));\n};\n","import { joinUrl } from '@guardian/libs';\nfunction checkForErrors(response) {\n    if (!response.ok) {\n        throw Error(response.statusText ||\n            `getIdApiUserData | An api call returned HTTP status ${response.status}`);\n    }\n    return response;\n}\nconst callApi = (url) => {\n    return fetch(url, {\n        credentials: 'include',\n    })\n        .then(checkForErrors)\n        .then((response) => response.json());\n};\nconst cache = {};\nexport const getIdApiUserData = (ajaxUrl) => {\n    if (!cache.idapiUserMeResponse) {\n        const url = joinUrl(ajaxUrl, 'user/me');\n        cache.idapiUserMeResponse = callApi(url);\n    }\n    return cache.idapiUserMeResponse;\n};\nexport const getIdapiUserIdentifiers = (ajaxUrl) => {\n    if (!cache.idapiUserIdentifiersResponse) {\n        const url = joinUrl(ajaxUrl, 'user/me/identifiers');\n        cache.idapiUserIdentifiersResponse = callApi(url);\n    }\n    return cache.idapiUserIdentifiersResponse;\n};\n","import * as emotionReact from '@emotion/react';\nimport * as emotionReactJsxRuntime from '@emotion/react/jsx-runtime';\nimport React from 'react';\nlet hasAutomatBeenSet = false;\nexport const setAutomat = () => {\n    if (!hasAutomatBeenSet) {\n        window.guardian.automat = {\n            emotionReact,\n            emotionReactJsxRuntime,\n            react: React,\n        };\n        hasAutomatBeenSet = true;\n    }\n};\n","import { useEffect, useState } from 'react';\n/**\n * Ensures that the given task is only run once and only after all items in waitFor are defined\n * @param {Function} task - The task to execute once\n * @param {Array} waitFor - An array of variables that must be defined before the task is executed\n * */\nexport const useOnce = (task, waitFor) => {\n    const [alreadyRun, setAlreadyRun] = useState(false);\n    const isReady = waitFor.every((dep) => dep !== undefined);\n    useEffect(() => {\n        if (!alreadyRun && isReady) {\n            task();\n            setAlreadyRun(true);\n        }\n    }, [alreadyRun, isReady, task]);\n};\n","// detect two or more `/` chars after a word boundary\nconst multipleSlashesInRoute = /\\b\\/{2,}/g;\n\nexport const joinUrl = (...args: string[]): string =>\n\targs.join('/').replace(multipleSlashesInRoute, '/');\n","import { pxToRem } from '../utils/px-to-rem';\n\n/**\n * [Storybook](https://guardian.github.io/csnx/?path=/docs/source-foundations_space--page) •\n * [Design System](https://theguardian.design/2a1e5182b/p/05f835-space)\n *\n * Can be applied to margin or padding properties, vertically or horizontally.\n *\n ** `space[1]` -> 4px\n ** `space[2]` -> 8px\n ** `space[3]` -> 12px\n ** `space[4]` -> 16px\n ** `space[5]` -> 20px\n ** `space[6]` -> 24px\n ** `space[9]` -> 36px\n ** `space[12]` -> 48px\n ** `space[24]` -> 96px\n */\nexport const space = {\n\t1: 4,\n\t2: 8,\n\t3: 12,\n\t4: 16,\n\t5: 20,\n\t6: 24,\n\t9: 36,\n\t12: 48,\n\t24: 96,\n} as const;\n\n/**\n * [Storybook](https://guardian.github.io/csnx/?path=/docs/source-foundations_space--page) •\n * [Design System](https://theguardian.design/2a1e5182b/p/05f835-space)\n *\n * Can be applied to margin or padding properties, vertically or horizontally.\n *\n ** `remSpace[1]` -> 0.25rem\n ** `remSpace[2]` -> 0.5rem\n ** `remSpace[3]` -> 0.75rem\n ** `remSpace[4]` -> 1rem\n ** `remSpace[5]` -> 1.25rem\n ** `remSpace[6]` -> 1.5rem\n ** `remSpace[9]` -> 2.25rem\n ** `remSpace[12]` -> 3rem\n ** `remSpace[24]` -> 6rem\n */\nexport const remSpace: { [K in keyof typeof space]: string } = {\n\t1: `${pxToRem(space[1])}rem`,\n\t2: `${pxToRem(space[2])}rem`,\n\t3: `${pxToRem(space[3])}rem`,\n\t4: `${pxToRem(space[4])}rem`,\n\t5: `${pxToRem(space[5])}rem`,\n\t6: `${pxToRem(space[6])}rem`,\n\t9: `${pxToRem(space[9])}rem`,\n\t12: `${pxToRem(space[12])}rem`,\n\t24: `${pxToRem(space[24])}rem`,\n};\n\n/* TODO: this should be exposed as a number instead of a string,\n   so consumers can perform calculations on it */\n","export const rootPixelFontSize = 16;\nexport const pxToRem = (px: number): number => px / rootPixelFontSize;\n","const e = e => e.get(\"gu.contributions.views\") || void 0, t = e => { const t = e.getDay() || 7; return Date.UTC(e.getFullYear(), e.getMonth(), e.getDate() - (t - 1)) / 864e5; }, s = e => e.get(\"gu.history.weeklyArticleCount\") || void 0, r = new Set([\"environment/climate-change\", \"environment/climate-crisis\", \"environment/environment\", \"science/science\", \"politics/politics\", \"us-news/us-politics\", \"australia-news/australian-politics\", \"world/world\", \"world/europe-news\", \"world/russia\", \"books/books\", \"culture/culture\", \"world/coronavirus-outbreak\", \"world/race\", \"inequality/inequality\", \"technology/technology\", \"business/business\"]), o = (e, t = {}) => (e.forEach(e => { r.has(e) && (t[e] = (t[e] ?? 0) + 1); }), t), n = (e, s, r) => { if (!((e, s) => { const r = t(new Date), o = e.get(\"gu.history.articleCountsThisWeek\"); if (o && o.week === r) {\n    const t = o.articles[s] || 0;\n    return e.set(\"gu.history.articleCountsThisWeek\", { week: r, articles: { ...o.articles, [s]: t + 1 } }), t > 0;\n} return e.set(\"gu.history.articleCountsThisWeek\", { week: r, articles: { [s]: 1 } }), !1; })(e, s)) {\n    const s = t(new Date), n = e.get(\"gu.history.weeklyArticleCount\") || [], i = n[0];\n    if (i && i.week && i.week === s)\n        i.count += 1, i.tags = o(r, i.tags), e.set(\"gu.history.weeklyArticleCount\", n);\n    else {\n        n.unshift({ week: s, count: 1, tags: o(r, {}) });\n        const t = s - 365, i = n.filter(e => e.week >= t);\n        e.set(\"gu.history.weeklyArticleCount\", i);\n    }\n} }, i = (e, t, s) => { const r = (e => { if (URLSearchParams) {\n    const t = new URLSearchParams(window.location.search).get(\"force-\" + e);\n    if (t)\n        return t;\n} return null; })(e); return fetch(`${t}/${e}${r ? \"?force=\" + r : \"\"}`, { method: \"post\", headers: { \"Content-Type\": \"application/json\" }, body: JSON.stringify(s) }).then(t => { if (!t.ok)\n    throw Error(t.statusText || `Supporter Revenue ${e} | Api call returned HTTP status ${t.status}`); return t; }).then(e => e.json()); }, c = (e, t) => i(\"epic\", e, t), u = (e, t) => i(\"liveblog-epic\", e, t), a = (e, t) => i(\"banner\", e, t), l = (e, t) => i(\"puzzles\", e, t), w = (e, t) => i(\"header\", e, t);\nexport { a as getBanner, c as getEpic, e as getEpicViewLog, w as getHeader, u as getLiveblogEpic, l as getPuzzlesBanner, s as getWeeklyArticleHistory, n as incrementWeeklyArticleCount };\n"],"names":["getArticleCounts","pageId","keywordIds","hasOptedOutOfArticleCount","undefined","window","guardian","weeklyArticleCount","incrementWeeklyArticleCount","storage","split","getWeeklyArticleHistory","dailyArticleCount","incrementDailyArticleCount","getDailyArticleCount","weeklyArticleHistory","dailyArticleHistory","useArticleCounts","useState","articleCounts","setArticleCounts","useEffect","then","catch","Render","url","name","props","Epic","setEpic","setAutomat","guardianPolyfilledImport","epicModule","err","msg","String","modules","sentry","reportError","Error","useEpic","log","_jsx","css","space","children","Fetch","payload","response","baseUrl","key","fetcher","getLiveblogEpic","useSWRImmutable","data","error","useSDCLiveblogEpic","contributionsServiceUrl","Object","keys","length","module","submitComponentEvent","insertAfter","referenceNode","newNode","parentNode","insertBefore","nextSibling","LiveBlogEpic","section","shouldHideReaderRevenue","isPaidContent","tags","useHasOptedOutOfArticleCount","countryCode","setCountryCode","getLocaleCode","cc","e","useCountryCode","mvtId","Number","getCookie","shouldMemoize","isSignedIn","tracking","ophanPageId","config","ophan","pageViewId","platformId","clientName","referrerUrl","location","origin","pathname","targeting","contentType","sectionId","isMinuteArticle","showSupportMessaging","shouldHideSupportMessaging","isRecurringContributor","lastOneOffContributionDate","getLastOneOffContributionTimestamp","epicViewLog","getEpicViewLog","modulesVersion","usePayload","epicPlaceholder","document","createElement","href","includes","classList","add","blockId","hash","slice","blockLinkedTo","getElementById","remove","randomPosition","Math","floor","random","aBlockNearTheTop","querySelectorAll","createPortal","HIDE_SUPPORT_MESSAGING_COOKIE","RECURRING_CONTRIBUTOR_COOKIE","SUPPORT_RECURRING_CONTRIBUTOR_MONTHLY_COOKIE","SUPPORT_RECURRING_CONTRIBUTOR_ANNUAL_COOKIE","SUPPORT_ONE_OFF_CONTRIBUTION_COOKIE","NO_RR_BANNER_TIMESTAMP_KEY","MODULES_VERSION","shouldShowSupportMessaging","isRecurringContributorFromAttrs","hasMonthlyContributionCookie","hasAnnualContributionCookie","contributionDateFromAttributes","contributionDateFromSupport","parsedDateFromAttributes","Date","parse","parsedDateFromSupport","parseInt","getLastOneOffContributionDate","timestamp","date","year","getFullYear","month","getMonth","toString","padStart","day","getDate","isRecentOneOffContributor","diffMs","lastContributionDate","now","REQUIRED_CONSENTS_FOR_ARTICLE_COUNT","REQUIRED_CONSENTS_FOR_BROWSER_ID","hasCmpConsentForArticleCount","Promise","resolve","onConsentChange","ccpa","tcfv2","aus","hasRequiredConsents","every","consent","consents","localStorage","removeItem","hasCmpConsent","hasOptedOut","setHasOptedOut","useOnce","hasCmpConsentForBrowserId","withinLocalNoBannerCachePeriod","item","getItem","isNaN","withinCachePeriod","setLocalNoBannerCachePeriod","setItem","lazyFetchEmailWithTimeout","idapiUrl","ajaxUrl","setTimeout","getIdApiUserData","user","primaryEmailAddress","email","getPurchaseInfo","purchaseInfoRaw","purchaseInfo","JSON","decodeURIComponent","DailyArticleCountKey","dailyCount","value","getToday","today","count","unshift","cutOff","firstOldDayIndex","findIndex","splice","stringify","checkForErrors","ok","statusText","status","callApi","fetch","credentials","json","cache","idapiUserMeResponse","joinUrl","getIdapiUserIdentifiers","idapiUserIdentifiersResponse","hasAutomatBeenSet","automat","emotionReact","emotionReactJsxRuntime","react","React","task","waitFor","alreadyRun","setAlreadyRun","isReady","dep","multipleSlashesInRoute","args","join","replace","pxToRem","px","get","t","getDay","UTC","s","r","Set","o","forEach","has","n","week","articles","set","i","filter","URLSearchParams","search","method","headers","body","c","u","a","l","w"],"sourceRoot":""}