"use strict";(self.webpackChunk_guardian_dotcom_rendering=self.webpackChunk_guardian_dotcom_rendering||[]).push([[2798],{6666:(e,a,t)=>{t.r(a),t.d(a,{Metrics:()=>V});var i=t(521),n=t(2803);const o=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;const t=Math.pow(10,a);return Math.round(e*t)/t};var s;!function(e){e.PROD="https://performance-events.guardianapis.com/core-web-vitals",e.CODE="https://performance-events.code.dev-guardianapis.com/core-web-vitals"}(s||(s={}));const r={browser_id:null,page_view_id:null,fid:null,cls:null,lcp:null,fcp:null,ttfb:null},c=new Set;let d,l=!1,u=!1;const p=()=>{u||null!==r.fcp&&(u=navigator.sendBeacon(d,JSON.stringify(r)),c.size>0&&c.forEach((e=>{(0,n.c)(e,u?"Core Web Vitals payload successfully queued for transfer":"Failed to queue Core Web Vitals payload for transfer")})))},g=e=>{switch(e.name){case"FCP":r.fcp=o(e.value);break;case"CLS":r.cls=o(e.value);break;case"LCP":r.lcp=o(e.value);break;case"FID":r.fid=o(e.value);break;case"TTFB":r.ttfb=o(e.value)}},w=e=>{switch(e.type){case"visibilitychange":return void("hidden"===document.visibilityState&&p());case"pagehide":return void p()}},v=async()=>{const e=await Promise.resolve().then(t.bind(t,2716)),{getCLS:a,getFCP:i,getFID:n,getLCP:o,getTTFB:s}=e;a(g,{reportAllChanges:!1}),n(g),o(g),i(g),s(g),addEventListener("visibilitychange",w),addEventListener("pagehide",w)};var m=t(1614),b=t(8265),h=t(5677),f=t(9372),C=t(7410);const y=Math.random()<.01,I=[b.N],V=e=>{let{commercialMetricsEnabled:a}=e;var t;const n=null===(t=(0,h.N)())||void 0===t?void 0:t.api,o=(0,f.c)(),u=(0,m.e)({name:"bwid",shouldMemoize:!0}),{pageViewId:p}=window.guardian.config.ophan,g=!!window.guardian.config.page.isDev||"m.code.dev-theguardian.com"===window.location.hostname||"localhost"===window.location.hostname||"preview.gutools.co.uk"===window.location.hostname,w=Object.keys(window.guardian.config.tests).length>0,b=e=>y||w||I.some((a=>e.runnableTest(a)));return(0,C.t)((function(){const e=!!n&&b(n),a=Number.MIN_VALUE;(async e=>{let{browserId:a=null,pageViewId:t=null,sampling:i=.01,isDev:n,team:o}=e;if(l)return void console.warn("initCoreWebVitals already initialised","use the bypassCoreWebVitalsSampling method instead");l=!0,o&&c.add(o),(e=>{d=e?s.CODE:s.PROD})(n),r.browser_id=a,r.page_view_id=t,a&&t||console.warn("browserId or pageViewId missing from Core Web Vitals.","Resulting data cannot be joined to page view tables",{browserId:a,pageViewId:t}),(i<0||i>1)&&console.warn("Core Web Vitals sampling is outside the 0 to 1 range: ",i),0===i&&console.warn("Core Web Vitals are sampled at 0%"),1===i&&console.warn("Core Web Vitals are sampled at 100%");const u=Math.random()<i,p="#bypassCoreWebVitalsSampling"===window.location.hash;(u||p)&&v()})({browserId:u,pageViewId:p,isDev:g,sampling:a,team:"dotcom"}),(e||g)&&(async e=>{if(l)return e&&c.add(e),v();console.warn("initCoreWebVitals not yet initialised")})("commercial")}),[n]),(0,C.t)((function(){if(!a)return;const e=!!n&&b(n);(0,i.cJ)({pageViewId:p,browserId:null!=u?u:void 0,isDev:g,adBlockerInUse:o}).then((()=>{(e||g)&&(0,i.NV)()})).catch((e=>console.error("Error initialising commercial metrics: ".concat(String(e)))))}),[n,o,a]),null}},8265:(e,a,t)=>{t.d(a,{N:()=>i});const i={id:"IntegrateIma",start:"2022-07-14",expiry:"2023-04-04",author:"Zeke Hunter-Green",description:"Test the commercial impact of replacing YouTube ads with Interactive Media Ads on first-party videos",audience:0,audienceOffset:0,audienceCriteria:"Opt in",successMeasure:"IMA integration works as expected without adversely affecting pages with videos",canRun:()=>!0,variants:[{id:"control",test:()=>{}},{id:"variant",test:()=>{}}]}},5677:(e,a,t)=>{t.d(a,{N:()=>r,x:()=>c});var i=t(6131),n=t(2699);const o=new Promise((()=>{})),s="ab-tests",r=()=>{const{data:e}=(0,n.Z)(s,(()=>o));return e},c=e=>{let{api:a,participations:t}=e;(0,i.JG)(s,{api:a,participations:t},!1)}},9372:(e,a,t)=>{t.d(a,{c:()=>o});var i=t(521),n=t(3904);const o=()=>{const[e,a]=(0,n.useState)();return(0,n.useEffect)((()=>{(0,i.Hy)().then((e=>{a(e)}))}),[]),e}},7410:(e,a,t)=>{t.d(a,{t:()=>n});var i=t(3904);const n=(e,a)=>{const[t,n]=(0,i.useState)(!1),o=a.every((e=>void 0!==e));(0,i.useEffect)((()=>{!t&&o&&(e(),n(!0))}),[t,o,e])}}}]);
//# sourceMappingURL=Metrics-importable.modern.1055aedb836ad136896a.js.map