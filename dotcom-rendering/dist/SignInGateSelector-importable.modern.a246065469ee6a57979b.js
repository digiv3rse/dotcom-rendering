(self.webpackChunk_guardian_dotcom_rendering=self.webpackChunk_guardian_dotcom_rendering||[]).push([[4527],{3198:(e,t,n)=>{var r=NaN,o="[object Symbol]",i=/^\s+|\s+$/g,c=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,s=/^0o[0-7]+$/i,u=parseInt,d="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,l="object"==typeof self&&self&&self.Object===Object&&self,f=d||l||Function("return this")(),p=Object.prototype.toString,v=Math.max,m=Math.min,g=function(){return f.Date.now()};function h(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function y(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&p.call(e)==o}(e))return r;if(h(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=h(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var n=a.test(e);return n||s.test(e)?u(e.slice(2),n?2:8):c.test(e)?r:+e}e.exports=function(e,t,n){var r,o,i,c,a,s,u=0,d=!1,l=!1,f=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function p(t){var n=r,i=o;return r=o=void 0,u=t,c=e.apply(i,n)}function b(e){var n=e-s;return void 0===s||n>=t||n<0||l&&e-u>=i}function w(){var e=g();if(b(e))return I(e);a=setTimeout(w,function(e){var n=t-(e-s);return l?m(n,i-(e-u)):n}(e))}function I(e){return a=void 0,f&&r?p(e):(r=o=void 0,c)}function O(){var e=g(),n=b(e);if(r=arguments,o=this,s=e,n){if(void 0===a)return function(e){return u=e,a=setTimeout(w,t),d?p(e):c}(s);if(l)return a=setTimeout(w,t),p(s)}return void 0===a&&(a=setTimeout(w,t)),c}return t=y(t)||0,h(n)&&(d=!!n.leading,i=(l="maxWait"in n)?v(y(n.maxWait)||0,t):i,f="trailing"in n?!!n.trailing:f),O.cancel=function(){void 0!==a&&clearTimeout(a),u=0,r=s=o=a=void 0},O.flush=function(){return void 0===a?c:I(g())},O}},828:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const r=e=>Object.keys(e).map((t=>{const n=e[t],r=Array.isArray(n)?n.map((e=>encodeURIComponent(e))).join(","):encodeURIComponent(n);return"".concat(t,"=").concat(r)})).join("&")},6128:(e,t,n)=>{"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){r(e,t,n[t])}))}return e}function i(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}n.d(t,{Gm:()=>s,NX:()=>u,dw:()=>d});const c="undefined"==typeof window?void 0:window.guardian.ophan,a=e=>{null==c||c.record({componentEvent:e})},s=e=>a(i(o({},e),{action:"VIEW"})),u=function(){return{componentType:"SIGN_IN_GATE",id:arguments.length>0&&void 0!==arguments[0]?arguments[0]:""}},d=(e,t,n)=>{const r=u(e);a(i(o({},{component:r,abTest:n,value:t}),{action:"CLICK"}))}},9022:(e,t,n)=>{"use strict";n.r(t),n.d(t,{SignInGateSelector:()=>O});var r=n(7800),o=n(1614);const i=e=>"boolean"==typeof e;var c=n(8139);let a;var s,u=n(3904),d=n(828);const l=["new","guest","current"],f=e=>l.includes(e),p=["Contribution","SupporterPlus","Paper","GuardianWeekly"],v=e=>p.includes(e);function m(e){return(0,c.K)(e)&&f(e.userType)&&v(e.product)}var g=n(7410),h=n(397),y=n(6128),b=n(7100),w=n(8839);const I=e=>{let{abTest:t,componentId:n,setShowGate:o,signInUrl:i,gateVariant:c,host:a,checkoutCompleteCookieData:s,personaliseSignInGateAfterCheckoutSwitch:d}=e;return(0,u.useEffect)((()=>{(0,y.Gm)({component:(0,y.NX)(n),abTest:t})}),[t,n]),c.gate?c.gate({guUrl:a,signInUrl:i,dismissGate:()=>{((e,t)=>{e(!1),(0,b.oG)(t.variant,t.name),(0,b.ne)(t.variant,t.name)})(o,t)},abTest:t,ophanComponentId:n,checkoutCompleteCookieData:s,personaliseSignInGateAfterCheckoutSwitch:d}):(0,r.jsx)(r.Fragment,{})},O=e=>{let{format:t,contentType:n,sectionName:l="",tags:f,isPaidContent:p,isPreview:v,host:y="https://theguardian.com/",pageId:b,idUrl:O="https://profile.theguardian.com"}=e;const S=!!(0,o.e)({name:"GU_U",shouldMemoize:!0}),[j,C]=(0,u.useState)(void 0),[T,E]=(0,u.useState)(void 0),[P,k]=(0,u.useState)(void 0),[G,U]=(0,u.useState)(!1),_=(0,h.C)(),{pageViewId:N}=window.guardian.config.ophan,[A,x]=(0,u.useState)(!1),D=(0,o.e)({name:"GU_CO_COMPLETE",shouldMemoize:!0}),M=null!==D?(e=>{if(decodeURIComponent(e)===e)return;const t=(n=m,e=>{try{const t=JSON.parse(e);return n(t)?{parsed:t,hasError:!1}:{hasError:!0}}catch(e){return{hasError:!0}}})(decodeURIComponent(e));var n;return t.hasError?void 0:t.parsed})(D):void 0;if((0,g.t)((()=>{j&&document.dispatchEvent(new CustomEvent("article:sign-in-gate-dismissed"))}),[j]),(0,g.t)((()=>{const[e,t]=_;e&&t&&(E(e),k(t))}),[_]),(0,g.t)((()=>{(async()=>{var e,t;return a||(a=null!==(s=null===(e=window.guardian)||void 0===e||null===(t=e.config)||void 0===t?void 0:t.switches)&&void 0!==s?s:await fetch("https://www.theguardian.com/switches.json").then((e=>e.json())).then((e=>(e=>(0,c.K)(e)&&Object.values(e).every(i))(e)?e:Promise.reject(new Error("Error getting remote switches â€“ config is malformed")))))})().then((e=>{e.personaliseSignInGateAfterCheckout?x(e.personaliseSignInGateAfterCheckout):x(!1)}))}),[]),(0,u.useEffect)((()=>{T&&P&&T.canShow({isSignedIn:!!S,currentTest:P,contentType:n,sectionName:l,tags:f,isPaidContent:p,isPreview:v}).then(U)}),[P,T,S,n,l,f,p,v]),!P||!T)return null;const V=w.fK[P.id],R=A&&M?(e=>{if(!e)return;if(!M)return e;const{userType:t,product:n}=M;return"".concat(e,"_personalised_").concat(t,"_").concat(n)})(V):V,K=(e=>{let{pageId:t,pageViewId:n,idUrl:r,host:i,currentTest:c,componentId:a}=e;const s="".concat(i,"/").concat(t);var u,l;const f={componentType:"signingate",componentId:a,abTestName:c.name,abTestVariant:c.variant,browserId:null!==(u=(0,o.e)({name:"bwid",shouldMemoize:!0}))&&void 0!==u?u:void 0,visitId:null!==(l=(0,o.e)({name:"vsid"}))&&void 0!==l?l:void 0,viewId:n};return"".concat(r,"/signin?returnUrl=").concat(s,"&componentEventParams=").concat(encodeURIComponent((0,d.A)(f)))})({pageId:b,host:y,pageViewId:N,idUrl:O,currentTest:P,componentId:R});return(0,r.jsx)(r.Fragment,{children:!j&&G&&!!R&&(0,r.jsx)(I,{format:t,abTest:P,componentId:R,setShowGate:e=>C(!e),signInUrl:K,gateVariant:T,host:y,checkoutCompleteCookieData:M,personaliseSignInGateAfterCheckoutSwitch:A})})}},3633:(e,t,n)=>{"use strict";n.d(t,{HN:()=>c,lu:()=>o,x2:()=>i});const r="gu.history.dailyArticleCount",o=()=>{const e=localStorage.getItem(r);if(e)try{const{value:t}=JSON.parse(e);if(!t.length)throw new Error("Invalid gu.history.dailyArticleCount value");return t}catch(e){return void localStorage.removeItem(r)}},i=()=>Math.floor(Date.now()/864e5),c=()=>{var e,t;const n=null!==(t=o())&&void 0!==t?t:[],c=i();if((null===(e=n[0])||void 0===e?void 0:e.day)===c)n[0].count+=1;else{n.unshift({day:c,count:1});const e=c-60,t=n.findIndex((t=>t.day&&t.day<e));t>0&&n.splice(t)}localStorage.setItem(r,JSON.stringify({value:n}))}},4463:(e,t,n)=>{"use strict";n.d(t,{O:()=>c});var r=n(3198),o=n.n(r),i=n(3904);const c=e=>{const[t,n]=(0,i.useState)(!1);var r;const[c,a]=(0,i.useState)(null!==(r=e.node)&&void 0!==r?r:null),s=(0,i.useRef)(null),u=t=>{let[r]=t;r&&(r.isIntersecting?n(!0):e.repeat&&n(!1))},d=e.debounce?o()(u,200):u;return(0,i.useEffect)((()=>(s.current&&s.current.disconnect(),window.IntersectionObserver&&(s.current=new window.IntersectionObserver(d,e),c&&s.current.observe(c)),()=>{var e;return null===(e=s.current)||void 0===e?void 0:e.disconnect()})),[c,e,d]),[t,a]}},7410:(e,t,n)=>{"use strict";n.d(t,{t:()=>o});var r=n(3904);const o=(e,t)=>{const[n,o]=(0,r.useState)(!1),i=t.every((e=>void 0!==e));(0,r.useEffect)((()=>{!n&&i&&(e(),o(!0))}),[n,i,e])}}}]);
//# sourceMappingURL=SignInGateSelector-importable.modern.a246065469ee6a57979b.js.map