"use strict";(self.webpackChunk_guardian_dotcom_rendering=self.webpackChunk_guardian_dotcom_rendering||[]).push([[5191],{5670:(e,t,n)=>{n.d(t,{R:()=>l,o:()=>s});var r=n(9103),o=n(1279),i=n(3904),c=n(4914),a=n(3633);const s=async(e,t)=>{var n,i;if(!await(0,c.Am)())return window.guardian.weeklyArticleCount||((0,o.DF)(r.t.local,e,t.split(",")),window.guardian.weeklyArticleCount=(0,o.lL)(r.t.local)),window.guardian.dailyArticleCount||((0,a.HN)(),window.guardian.dailyArticleCount=(0,a.lu)()),{weeklyArticleHistory:null!==(n=window.guardian.weeklyArticleCount)&&void 0!==n?n:[],dailyArticleHistory:null!==(i=window.guardian.dailyArticleCount)&&void 0!==i?i:[]}},l=(e,t)=>{const[n,r]=(0,i.useState)("Pending");return(0,i.useEffect)((()=>{s(e,t).then(r).catch((()=>r(void 0)))}),[e,t]),n}},8311:(e,t,n)=>{n.r(t),n.d(t,{LiveBlogEpic:()=>S});var r=n(7800),o=n(43),i=n(1614),c=n(2803),a=n(9103),s=n(4436),l=n(1279),u=n(3904),d=n(5670),g=n(9038),p=n(4914),m=n(6134),w=n(6354),f=n(6131);function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){y(e,t,n[t])}))}return e}function v(){const e=(t=["\n\t\t\t\tmargin-bottom: ","px;\n\t\t\t"],n||(n=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(n)}})));var t,n;return v=function(){return e},e}const b=e=>{let{url:t,name:n,props:i}=e;const{Epic:a}=(e=>{let{url:t,name:n}=e;const[r,o]=(0,u.useState)();return(0,u.useEffect)((()=>{(0,w.R)(),window.guardianPolyfilledImport(t).then((e=>{o((()=>e[n]))})).catch((e=>{const t="Error importing LiveBlog epic: ".concat(String(e));window.guardian.modules.sentry.reportError(new Error(t),"liveblog-epic")}))}),[t,n]),{Epic:r}})({url:t,name:n});return void 0===a?null:((0,c.c)("dotcom","LiveBlogEpic has the Epic"),(0,r.jsx)("aside",{css:(0,o.css)(v(),s.D[3]),children:(0,r.jsx)(a,h({},i))}))},O=e=>{let{payload:t,contributionsServiceUrl:n}=e;const o=((e,t)=>((e,t)=>{const{data:n,error:r}=(0,f.ZP)(e,t);return r&&window.guardian.modules.sentry.reportError(r,"rr-epic"),n})("liveblog-epic",(()=>(0,l.Ec)(e,t))))(n,t);if(!(null==o?void 0:o.data)||0===Object.keys(o).length)return null;(0,c.c)("dotcom","LiveBlogEpic has a module");const i=(a=h({},o.data.module.props),s=null!=(s={submitComponentEvent:g.X4})?s:{},Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(s)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(s)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(s,e))})),a);var a,s;return(0,r.jsx)(b,{url:o.data.module.url,name:o.data.module.name,props:i})};function P(e,t){var n;null===(n=e.parentNode)||void 0===n||n.insertBefore(t,e.nextSibling)}const S=e=>{let{section:t,shouldHideReaderRevenue:n,isPaidContent:o,tags:s,contributionsServiceUrl:g,pageId:w,keywordIds:f}=e;(0,c.c)("dotcom","LiveBlogEpic started");const y=(e=>{let{shouldHideReaderRevenue:t,section:n,isPaidContent:r,tags:o,pageId:s,keywordIds:g}=e;const w=(0,d.R)(s,g),f=(0,p.qw)(),y=(()=>{const[e,t]=(0,u.useState)();return(0,u.useEffect)((()=>{(0,m.A)().then((e=>{t(e)})).catch((e=>{const t="Error fetching country code: ".concat(String(e));window.guardian.modules.sentry.reportError(new Error(t),"liveblog-epic")}))}),[]),e})(),h=Number((0,i.e)({name:"GU_mvt_id",shouldMemoize:!0}))||0,v=!!(0,i.e)({name:"GU_U",shouldMemoize:!0});var b;if("Pending"!==w&&"Pending"!==f&&((0,c.c)("dotcom","LiveBlogEpic has consent state"),y))return(0,c.c)("dotcom","LiveBlogEpic has countryCode"),{tracking:{ophanPageId:window.guardian.config.ophan.pageViewId,platformId:"GUARDIAN_WEB",clientName:"dcr",referrerUrl:window.location.origin+window.location.pathname},targeting:{contentType:"LiveBlog",sectionId:n,shouldHideReaderRevenue:t,isMinuteArticle:!0,isPaidContent:r,tags:o,showSupportMessaging:!(0,p.S9)(v),isRecurringContributor:(0,p.T0)(v),lastOneOffContributionDate:null!==(b=(0,p.qQ)())&&void 0!==b?b:void 0,mvtId:h,countryCode:y,epicViewLog:(0,l.Es)(a.t.local),weeklyArticleHistory:null==w?void 0:w.weeklyArticleHistory,hasOptedOutOfArticleCount:f,modulesVersion:"v3",url:window.location.origin+window.location.pathname}}})({shouldHideReaderRevenue:n,section:t,isPaidContent:o,tags:s,pageId:w,keywordIds:f});if(!y)return null;const h=document.createElement("article");if(window.location.href.includes("#block-")){h.classList.add("pending");const e=window.location.hash.slice(1),t=document.getElementById(e);t&&P(t,h),h.classList.add("reveal"),h.classList.remove("pending")}else{const e=Math.floor(3*Math.random())+1,t=document.querySelectorAll("article.block")[e];t&&P(t,h)}return(0,u.createPortal)((0,r.jsx)(O,{payload:y,contributionsServiceUrl:g}),h)}},4914:(e,t,n)=>{n.d(t,{Am:()=>E,BQ:()=>m,C6:()=>s,CC:()=>g,G9:()=>S,H2:()=>C,K3:()=>u,Pl:()=>j,S9:()=>b,T0:()=>f,Ty:()=>l,ZD:()=>A,cs:()=>R,nh:()=>I,qQ:()=>y,qw:()=>k,tq:()=>h,y0:()=>d});var r=n(8706),o=n(1614),i=n(3904),c=n(3179),a=n(7410);const s="gu_hide_support_messaging",l="gu_recurring_contributor",u="gu.contributions.recurring.contrib-timestamp.Monthly",d="gu.contributions.recurring.contrib-timestamp.Annual",g="gu.contributions.contrib-timestamp",p="gu.noRRBannerTimestamp",m="v3",w=()=>!("true"===(0,o.e)({name:s})),f=e=>{const t="true"===(0,o.e)({name:l}),n=null!==(0,o.e)({name:u,shouldMemoize:!0}),r=null!==(0,o.e)({name:d,shouldMemoize:!0});return e&&(t||n||r)},y=()=>{const e=(0,o.e)({name:"gu_one_off_contribution_date"}),t=(0,o.e)({name:g});if(!e&&!t)return;const n=e?Date.parse(e):0,r=t?parseInt(t,10):0;return n>r?n:r||void 0},h=()=>{const e=y();if(void 0===e)return;const t=new Date(e),n=t.getFullYear(),r=(t.getMonth()+1).toString().padStart(2,"0"),o=t.getDate().toString().padStart(2,"0");return"".concat(n,"-").concat(r,"-").concat(o)},v=()=>{const e=y();return void 0!==e&&((e,t)=>{const n=Date.now()-e;return Math.floor(n/864e5)})(e)<=90},b=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!w()||f(e)||v()},O=[1,3,7],P=[1,3,5,7],S=()=>new Promise((e=>{(0,o.e)({name:"gu-cmp-disabled",shouldMemoize:!0})&&e(!0),(0,r.onConsentChange)((t=>{let{ccpa:n,tcfv2:r,aus:o}=t;if(n||o)e(!0);else if(r){const t=O.every((e=>r.consents[e]));t||(window.localStorage.removeItem("gu.history.dailyArticleCount"),window.localStorage.removeItem("gu.history.weeklyArticleCount")),e(t)}}))})),E=async()=>!await S()||null!==(0,o.e)({name:"gu_article_count_opt_out"}),k=()=>{const[e,t]=(0,i.useState)("Pending");return(0,a.t)((()=>{E().then(t).catch((()=>t(!0)))}),[]),e},C=()=>new Promise((e=>{(0,o.e)({name:"gu-cmp-disabled",shouldMemoize:!0})&&e(!0),(0,r.onConsentChange)((t=>{let{ccpa:n,tcfv2:r,aus:o}=t;if(n||o)e(!0);else if(r){const t=P.every((e=>r.consents[e]));e(t)}}))})),j=()=>{const e=window.localStorage.getItem(p);if(e&&!Number.isNaN(parseInt(e,10))){const t=parseInt(e,10)+12e5>Date.now();return t||window.localStorage.removeItem(p),t}return!1},A=()=>window.localStorage.setItem(p,"".concat(Date.now())),I=e=>()=>new Promise((t=>{var n;setTimeout((()=>t(null)),1e3),(n=e,(0,c._)(n).then((e=>{var t;return null===(t=e.user)||void 0===t?void 0:t.primaryEmailAddress})).catch((e=>{window.guardian.modules.sentry.reportError(e,"getEmail")}))).then((e=>{t(e||null)}))})),R=()=>{const e=(0,o.e)({name:"GU_CO_COMPLETE",shouldMemoize:!0});if(!e)return;let t;try{t=JSON.parse(decodeURIComponent(e))}catch(e){}return t}},3633:(e,t,n)=>{n.d(t,{HN:()=>c,lu:()=>o,x2:()=>i});const r="gu.history.dailyArticleCount",o=()=>{const e=localStorage.getItem(r);if(e)try{const{value:t}=JSON.parse(e);if(!t.length)throw new Error("Invalid gu.history.dailyArticleCount value");return t}catch(e){return void localStorage.removeItem(r)}},i=()=>Math.floor(Date.now()/864e5),c=()=>{var e,t;const n=null!==(t=o())&&void 0!==t?t:[],c=i();if((null===(e=n[0])||void 0===e?void 0:e.day)===c)n[0].count+=1;else{n.unshift({day:c,count:1});const e=c-60,t=n.findIndex((t=>t.day&&t.day<e));t>0&&n.splice(t)}localStorage.setItem(r,JSON.stringify({value:n}))}},3179:(e,t,n)=>{n.d(t,{T:()=>s,_:()=>a});var r=n(5726);function o(e){if(!e.ok)throw Error(e.statusText||"getIdApiUserData | An api call returned HTTP status ".concat(e.status));return e}const i=e=>fetch(e,{credentials:"include"}).then(o).then((e=>e.json())),c={},a=e=>{if(!c.idapiUserMeResponse){const t=(0,r.p)(e,"user/me");c.idapiUserMeResponse=i(t)}return c.idapiUserMeResponse},s=e=>{if(!c.idapiUserIdentifiersResponse){const t=(0,r.p)(e,"user/me/identifiers");c.idapiUserIdentifiersResponse=i(t)}return c.idapiUserIdentifiersResponse}},6354:(e,t,n)=>{n.d(t,{R:()=>a});var r=n(43),o=n(7800),i=n(3904);let c=!1;const a=()=>{c||(window.guardian.automat={emotionReact:r,emotionReactJsxRuntime:o,react:i.default},c=!0)}},7410:(e,t,n)=>{n.d(t,{t:()=>o});var r=n(3904);const o=(e,t)=>{const[n,o]=(0,r.useState)(!1),i=t.every((e=>void 0!==e));(0,r.useEffect)((()=>{!n&&i&&(e(),o(!0))}),[n,i,e])}},5726:(e,t,n)=>{n.d(t,{p:()=>o});const r=/\b\/{2,}/g,o=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.join("/").replace(r,"/")}},4436:(e,t,n)=>{n.d(t,{D:()=>o,K:()=>i});var r=n(4486);const o={1:4,2:8,3:12,4:16,5:20,6:24,9:36,12:48,24:96},i={1:"".concat((0,r.Q)(o[1]),"rem"),2:"".concat((0,r.Q)(o[2]),"rem"),3:"".concat((0,r.Q)(o[3]),"rem"),4:"".concat((0,r.Q)(o[4]),"rem"),5:"".concat((0,r.Q)(o[5]),"rem"),6:"".concat((0,r.Q)(o[6]),"rem"),9:"".concat((0,r.Q)(o[9]),"rem"),12:"".concat((0,r.Q)(o[12]),"rem"),24:"".concat((0,r.Q)(o[24]),"rem")}},4486:(e,t,n)=>{n.d(t,{Q:()=>r});const r=e=>e/16},1279:(e,t,n)=>{function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){r(e,t,n[t])}))}return e}n.d(t,{DF:()=>u,Ec:()=>p,Eg:()=>m,Es:()=>i,Nh:()=>w,Pg:()=>f,bv:()=>g,lL:()=>a});const i=e=>e.get("gu.contributions.views")||void 0,c=e=>{const t=e.getDay()||7;return Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()-(t-1))/864e5},a=e=>e.get("gu.history.weeklyArticleCount")||void 0,s=new Set(["environment/climate-change","environment/climate-crisis","environment/environment","science/science","politics/politics","us-news/us-politics","australia-news/australian-politics","world/world","world/europe-news","world/russia","books/books","culture/culture","world/coronavirus-outbreak","world/race","inequality/inequality","technology/technology","business/business"]),l=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.forEach((e=>{var n;s.has(e)&&(t[e]=(null!==(n=t[e])&&void 0!==n?n:0)+1)})),t},u=(e,t,n)=>{if(!((e,t)=>{const n=c(new Date),r=e.get("gu.history.articleCountsThisWeek");if(r&&r.week===n){const c=r.articles[t]||0;return e.set("gu.history.articleCountsThisWeek",{week:n,articles:(i=o({},r.articles),a={[t]:c+1},a=null!=a?a:{},Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(a)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n.push.apply(n,r)}return n}(Object(a)).forEach((function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(a,e))})),i)}),c>0}var i,a;return e.set("gu.history.articleCountsThisWeek",{week:n,articles:{[t]:1}}),!1})(e,t)){const t=c(new Date),r=e.get("gu.history.weeklyArticleCount")||[],o=r[0];if(o&&o.week&&o.week===t)o.count+=1,o.tags=l(n,o.tags),e.set("gu.history.weeklyArticleCount",r);else{r.unshift({week:t,count:1,tags:l(n,{})});const o=t-365,i=r.filter((e=>e.week>=o));e.set("gu.history.weeklyArticleCount",i)}}},d=(e,t,n)=>{const r=(e=>{if(URLSearchParams){const t=new URLSearchParams(window.location.search).get("force-"+e);if(t)return t}return null})(e);return fetch("".concat(t,"/").concat(e).concat(r?"?force="+r:""),{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((t=>{if(!t.ok)throw Error(t.statusText||"Supporter Revenue ".concat(e," | Api call returned HTTP status ").concat(t.status));return t})).then((e=>e.json()))},g=(e,t)=>d("epic",e,t),p=(e,t)=>d("liveblog-epic",e,t),m=(e,t)=>d("banner",e,t),w=(e,t)=>d("puzzles",e,t),f=(e,t)=>d("header",e,t)}}]);
//# sourceMappingURL=LiveBlogEpic-importable.modern.e61ac84eb3c47a29f35e.js.map