{"version":3,"file":"RecipeMultiplier-importable.modern.72e4db321591c854b557.js","mappings":"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","sources":["webpack://@guardian/dotcom-rendering/../node_modules/@guardian/libs/esm/isUndefined/isUndefined.js","webpack://@guardian/dotcom-rendering/./src/web/components/RecipeMultiplier.importable.tsx","webpack://@guardian/dotcom-rendering/./src/web/lib/useOnce.ts","webpack://@guardian/dotcom-rendering/../node_modules/@guardian/source-react-components/esm/src/button/Button.js","webpack://@guardian/dotcom-rendering/../node_modules/@guardian/source-react-components/esm/vendor/icons/SvgMinus.js","webpack://@guardian/dotcom-rendering/../node_modules/@guardian/source-react-components/esm/vendor/icons/SvgPlus.js"],"sourcesContent":["// the lodash way https://github.com/lodash/lodash/blob/master/isUndefined.js\nconst isUndefined = (_) => _ === undefined;\n\nexport { isUndefined };\n//# sourceMappingURL=isUndefined.js.map\n","import { css } from '@emotion/react';\nimport { isString, isUndefined, log } from '@guardian/libs';\nimport { lifestyle, space, textSans } from '@guardian/source-foundations';\nimport { Button, SvgMinus, SvgPlus } from '@guardian/source-react-components';\nimport type { ChangeEventHandler } from 'react';\nimport { useEffect, useState } from 'react';\nimport { useOnce } from '../lib/useOnce';\n\nconst colours = `\ngu-recipe {\n\tcolor: ${lifestyle[100]};\n\tbackground-color: ${lifestyle[800]};\n\tfont-weight: bold;\n}\n`;\n\nconst styles = css`\n\t${textSans.small()}\n\tposition: sticky;\n\tz-index: 1;\n\tdisplay: grid;\n\tgrid-template-columns: 6fr repeat(3, 1fr);\n\ttop: 0;\n\tcolor: ${lifestyle[100]};\n\tbackground-color: ${lifestyle[800]};\n\tpadding: ${space[2]}px;\n`;\n\nconst min = 0.5;\nconst max = 24;\n\nconst units = ['g', 'l'] as const;\nconst isUnit = (unit: string): unit is (typeof units)[number] =>\n\t//@ts-expect-error -- custom type guard\n\tunits.includes(unit);\n\nconst isServer = typeof document === 'undefined';\n\n/** These values should not update based on servings  */\nconst constants = [\n\t's',\n\t'second',\n\t'seconds',\n\t'min',\n\t'minute',\n\t'minutes',\n\t'hr',\n\t'hour',\n\t'hours',\n\t'C',\n\t'c',\n\t'cm',\n\t'mm',\n] as const;\nconst isConstant = (time?: string): time is (typeof constants)[number] =>\n\tisString(time) &&\n\t//@ts-expect-error -- custom type guard\n\tconstants.includes(time);\n\nconst fractions = new Map([\n\t['½', 0.5],\n\t['⅓', 0.3333],\n\t['⅔', 0.6667],\n\t['¼', 0.25],\n\t['¾', 0.75],\n\t['⅕', 0.2],\n\t['⅖', 0.4],\n\t['⅗', 0.6],\n\t['⅘', 0.8],\n\t['⅙', 0.1667],\n\t['⅚', 0.8333],\n\t['⅐', 0.1429],\n\t['⅛', 0.125],\n\t['⅜', 0.375],\n\t['⅝', 0.625],\n\t['⅞', 0.875],\n\t['⅑', 0.1111],\n\t['⅒', 0.1],\n]);\n\n/** Pick any numeric value or range, followed by its unit */\nconst RECIPE_ELEMENTS = new RegExp(\n\t[\n\t\t// Start after a word is broken, or Makes / Serves\n\t\t`(?:${['', 'Serves ', 'Makes '].join('|')})`,\n\t\t// `value` capturing group\n\t\t`(?<value>${[\n\t\t\t'\\\\d+',\n\t\t\t'\\\\d+-\\\\d+',\n\t\t\t'\\\\d+/\\\\d+',\n\t\t\t...fractions.keys(),\n\t\t].join('|')})`,\n\t\t// `separator` capturing group\n\t\t'(?:(?<separator> ?)',\n\t\t// `unit` capturing group\n\t\t'(?<unit>[a-z]+?\\\\b)|(?=<))',\n\t].join(''),\n\t'i',\n);\n\nconst serves = isServer\n\t? 1\n\t: parseFloat(\n\t\t\tdocument.querySelector<HTMLElement>('gu-recipe[serves]')?.dataset\n\t\t\t\t.value ?? '1',\n\t  );\n\nconst transform = ({\n\tvalue,\n\tseparator,\n\tunit,\n}: {\n\tvalue: number[];\n\tseparator: string;\n\tunit: string;\n}) => {\n\tconst [from, to] = value;\n\tif (from === undefined) return `Invalid value`;\n\tif (to !== undefined) {\n\t\treturn `${from}-${to}${separator}${unit}`;\n\t}\n\n\tif (isUnit(unit)) {\n\t\tconst round = Math.round(from / 5) * 5;\n\t\treturn `${round}${separator}${unit}`;\n\t}\n\n\tconst round = from > 1 ? Math.round(from) : Math.round(from * 100) / 100;\n\treturn `${round}${separator}${unit}`;\n};\n\nexport const RecipeMultiplier = () => {\n\tconst [servings, setServings] = useState<number>(serves);\n\tconst [multiplier, setMultiplier] = useState(1);\n\n\tuseOnce(() => {\n\t\tlog('dotcom', 'Injecting multiplier');\n\t\tconst style = document.createElement('style');\n\t\tstyle.innerHTML = colours;\n\t\tdocument.body.appendChild(style);\n\n\t\tconst root = document.querySelector(\n\t\t\t'gu-island[name=RecipeMultiplier]',\n\t\t)?.nextSibling;\n\n\t\tif (root instanceof HTMLElement) {\n\t\t\tconst walker = document.createTreeWalker(\n\t\t\t\troot,\n\t\t\t\tNodeFilter.SHOW_TEXT,\n\t\t\t\tnull,\n\t\t\t);\n\n\t\t\tlet node: Node | null;\n\n\t\t\twhile ((node = walker.nextNode())) {\n\t\t\t\tif (!(node instanceof Text)) continue;\n\n\t\t\t\tconst match =\n\t\t\t\t\tnode.nodeValue?.match(RECIPE_ELEMENTS) ?? undefined;\n\n\t\t\t\tif (!match) continue;\n\n\t\t\t\tconst { index, groups } = match;\n\t\t\t\tconst length = match[0].length;\n\n\t\t\t\tswitch (index) {\n\t\t\t\t\tcase undefined:\n\t\t\t\t\tcase -1: {\n\t\t\t\t\t\t// Do nothing\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcase 0: {\n\t\t\t\t\t\t// Tom explained to me truthiness of 0 in JS. Ta.\n\t\t\t\t\t\tif (length) node.splitText(length);\n\t\t\t\t\t\tconst recipeElement =\n\t\t\t\t\t\t\tdocument.createElement('gu-recipe');\n\t\t\t\t\t\trecipeElement.textContent = node.textContent;\n\n\t\t\t\t\t\tif (isConstant(groups?.unit)) continue;\n\n\t\t\t\t\t\tObject.entries(groups ?? {})\n\t\t\t\t\t\t\t.map(([key, value]) => {\n\t\t\t\t\t\t\t\tconst [numerator, denominator] = value\n\t\t\t\t\t\t\t\t\t.split('/')\n\t\t\t\t\t\t\t\t\t.map(parseFloat);\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tkey === 'value' &&\n\t\t\t\t\t\t\t\t\tvalue.includes('/') &&\n\t\t\t\t\t\t\t\t\tnumerator !== undefined &&\n\t\t\t\t\t\t\t\t\tdenominator !== undefined\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\t\t\tkey,\n\t\t\t\t\t\t\t\t\t\t(numerator / denominator).toString(),\n\t\t\t\t\t\t\t\t\t] as const;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\t\t\tkey,\n\t\t\t\t\t\t\t\t\tfractions.get(value)?.toString() ?? value,\n\t\t\t\t\t\t\t\t] as const;\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.forEach(([key, value]) => {\n\t\t\t\t\t\t\t\trecipeElement.setAttribute(\n\t\t\t\t\t\t\t\t\t`data-${key}`,\n\t\t\t\t\t\t\t\t\tvalue,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\tnode.parentNode?.insertBefore(recipeElement, node);\n\n\t\t\t\t\t\tnode.textContent = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tdefault: {\n\t\t\t\t\t\tnode.splitText(index);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlog('design', index, length, node.textContent);\n\t\t\t}\n\t\t}\n\t}, []);\n\n\tuseEffect(() => {\n\t\tconst element =\n\t\t\tdocument.querySelector<HTMLElement>('gu-recipe[serves]');\n\t\tif (element) element.innerText = servings.toString();\n\t\tsetMultiplier(servings / serves);\n\t}, [servings]);\n\n\tuseEffect(() => {\n\t\tdocument\n\t\t\t.querySelectorAll<HTMLElement>('gu-recipe')\n\t\t\t.forEach((element) => {\n\t\t\t\tconst { value, separator, unit } = element.dataset;\n\n\t\t\t\tif (isUndefined(value) || isUndefined(separator)) return;\n\n\t\t\t\tif (isUndefined(unit)) return;\n\n\t\t\t\telement.innerText = transform({\n\t\t\t\t\tvalue: value\n\t\t\t\t\t\t.split('-')\n\t\t\t\t\t\t.map(parseFloat)\n\t\t\t\t\t\t.map((v) => v * multiplier),\n\t\t\t\t\tseparator,\n\t\t\t\t\tunit,\n\t\t\t\t});\n\t\t\t});\n\t}, [multiplier]);\n\n\tconst handleChange: ChangeEventHandler<HTMLInputElement> = ({\n\t\ttarget: { value },\n\t}) => {\n\t\tconst float = Number.parseFloat(value);\n\n\t\tif (!Number.isNaN(float)) setServings(float);\n\t};\n\n\treturn (\n\t\t<ul css={styles}>\n\t\t\t<li>Serves {servings}</li>\n\t\t\t<li css={{ textAlign: 'center' }}>\n\t\t\t\t<Button\n\t\t\t\t\ticon={<SvgMinus />}\n\t\t\t\t\thideLabel={true}\n\t\t\t\t\tsize=\"xsmall\"\n\t\t\t\t\tdisabled={servings - 1 < min}\n\t\t\t\t\tcssOverrides={css`\n\t\t\t\t\t\tbackground-color: ${lifestyle[300]};\n\t\t\t\t\t`}\n\t\t\t\t\tonClick={() => setServings(servings - 1)}\n\t\t\t\t>\n\t\t\t\t\tsubtract 1 serving\n\t\t\t\t</Button>\n\t\t\t</li>\n\t\t\t<li\n\t\t\t\tcss={{\n\t\t\t\t\tfontWeight: 'bold',\n\t\t\t\t\ttextAlign: 'center',\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t{servings}\n\t\t\t</li>\n\t\t\t<li css={{ textAlign: 'center' }}>\n\t\t\t\t<Button\n\t\t\t\t\ticon={<SvgPlus />}\n\t\t\t\t\thideLabel={true}\n\t\t\t\t\tsize=\"xsmall\"\n\t\t\t\t\tdisabled={servings + 1 > max}\n\t\t\t\t\tcssOverrides={css`\n\t\t\t\t\t\tbackground-color: ${lifestyle[300]};\n\t\t\t\t\t`}\n\t\t\t\t\tonClick={() => setServings(servings + 1)}\n\t\t\t\t>\n\t\t\t\t\tadd 1 serving\n\t\t\t\t</Button>\n\t\t\t</li>\n\t\t\t<li css={{ gridColumn: '1 / -1', accentColor: lifestyle[300] }}>\n\t\t\t\t<input\n\t\t\t\t\tcss={{ width: '100%', margin: 0 }}\n\t\t\t\t\ttype=\"range\"\n\t\t\t\t\tname=\"\"\n\t\t\t\t\tmin={min}\n\t\t\t\t\tmax={max}\n\t\t\t\t\tstep={0.5}\n\t\t\t\t\tvalue={servings}\n\t\t\t\t\tonChange={handleChange}\n\t\t\t\t/>\n\t\t\t</li>\n\t\t</ul>\n\t);\n};\n","import { useEffect, useState } from 'react';\n\n/**\n * Ensures that the given task is only run once and only after all items in waitFor are defined\n * @param {Function} task - The task to execute once\n * @param {Array} waitFor - An array of variables that must be defined before the task is executed\n * */\nexport const useOnce = (task: () => void, waitFor: unknown[]): void => {\n\tconst [alreadyRun, setAlreadyRun] = useState(false);\n\tconst isReady = waitFor.every((dep) => dep !== undefined);\n\tuseEffect(() => {\n\t\tif (!alreadyRun && isReady) {\n\t\t\ttask();\n\t\t\tsetAlreadyRun(true);\n\t\t}\n\t}, [alreadyRun, isReady, task]);\n};\n","import { jsx } from '@emotion/react/jsx-runtime';\nimport { buttonContents } from './shared.js';\nimport { buttonStyles } from './styles.js';\n\n/**\n * [Storybook](https://guardian.github.io/csnx/?path=/story/source-react-components_button--primary-priority-default-theme) •\n * [Design System](https://theguardian.design/2a1e5182b/p/435225-button) •\n * [GitHub](https://github.com/guardian/csnx/tree/main/libs/@guardian/source-react-components/src/button/Button.tsx) •\n * [NPM](https://www.npmjs.com/package/@guardian/source-react-components)\n *\n * Buttons enable users to make choices or perform actions.\n *\n */\nconst Button = ({ priority, size, icon: iconSvg, iconSide, hideLabel, nudgeIcon, type = 'button', isLoading = false, loadingAnnouncement = 'Loading', cssOverrides, children, ...props }) => (jsx(\"button\", { css: buttonStyles({\n        size,\n        priority,\n        icon: iconSvg,\n        hideLabel,\n        iconSide,\n        nudgeIcon,\n        cssOverrides,\n        isLoading,\n    }), type: type, \"aria-live\": \"polite\", \"aria-label\": isLoading ? loadingAnnouncement : undefined, ...props, children: buttonContents({\n        hideLabel,\n        iconSvg,\n        isLoading,\n        children,\n    }) }));\n\nexport { Button };\n//# sourceMappingURL=Button.js.map\n","import { jsxs, Fragment, jsx } from '@emotion/react/jsx-runtime';\nimport { css } from '@emotion/react';\nimport { visuallyHidden, iconSize } from '@guardian/source-foundations';\n\nconst Svg = ({ size }) => (jsx(\"svg\", { width: size ? iconSize[size] : undefined, height: undefined, viewBox: \"-3 -3 30 30\", xmlns: \"http://www.w3.org/2000/svg\", focusable: false, \"aria-hidden\": true, children: jsx(\"path\", { fillRule: \"evenodd\", clipRule: \"evenodd\", d: \"M1 10.75v2.5h22v-2.5H1Z\" }) }));\nconst SvgMinus = ({ size, isAnnouncedByScreenReader = false, }) => (jsxs(Fragment, { children: [jsx(Svg, { size: size }), isAnnouncedByScreenReader ? (jsx(\"span\", { css: css `\n\t\t\t\t\t${visuallyHidden}\n\t\t\t\t`, children: \"Minus sign\" })) : ('')] }));\n\nexport { SvgMinus };\n//# sourceMappingURL=SvgMinus.js.map\n","import { jsxs, Fragment, jsx } from '@emotion/react/jsx-runtime';\nimport { css } from '@emotion/react';\nimport { visuallyHidden, iconSize } from '@guardian/source-foundations';\n\nconst Svg = ({ size }) => (jsx(\"svg\", { width: size ? iconSize[size] : undefined, height: undefined, viewBox: \"-3 -3 30 30\", xmlns: \"http://www.w3.org/2000/svg\", focusable: false, \"aria-hidden\": true, children: jsx(\"path\", { fillRule: \"evenodd\", clipRule: \"evenodd\", d: \"m10.8 13.2.425 9.8h1.525l.45-9.8 9.8-.45v-1.525l-9.8-.425-.45-9.8h-1.525l-.425 9.8-9.8.425v1.525l9.8.45Z\" }) }));\nconst SvgPlus = ({ size, isAnnouncedByScreenReader = false, }) => (jsxs(Fragment, { children: [jsx(Svg, { size: size }), isAnnouncedByScreenReader ? (jsx(\"span\", { css: css `\n\t\t\t\t\t${visuallyHidden}\n\t\t\t\t`, children: \"Plus sign\" })) : ('')] }));\n\nexport { SvgPlus };\n//# sourceMappingURL=SvgPlus.js.map\n"],"names":["isUndefined","_","undefined","document","colours","lifestyle","styles","css","textSans","space","units","isServer","constants","fractions","Map","RECIPE_ELEMENTS","RegExp","join","keys","serves","parseFloat","querySelector","dataset","value","RecipeMultiplier","servings","setServings","useState","multiplier","setMultiplier","useOnce","log","style","createElement","innerHTML","body","appendChild","root","nextSibling","HTMLElement","walker","createTreeWalker","NodeFilter","SHOW_TEXT","node","nextNode","Text","match","nodeValue","index","groups","length","splitText","recipeElement","textContent","time","unit","isString","includes","Object","entries","map","key","numerator","denominator","split","toString","get","forEach","setAttribute","parentNode","insertBefore","useEffect","element","innerText","querySelectorAll","separator","from","to","isUnit","round","Math","transform","v","ul","li","textAlign","Button","icon","SvgMinus","hideLabel","size","disabled","cssOverrides","onClick","fontWeight","SvgPlus","gridColumn","accentColor","input","width","margin","type","name","min","max","step","onChange","target","float","Number","isNaN","task","waitFor","alreadyRun","setAlreadyRun","isReady","every","dep","priority","iconSvg","iconSide","nudgeIcon","isLoading","loadingAnnouncement","children","props","jsx","buttonStyles","buttonContents","Svg","iconSize","height","viewBox","xmlns","focusable","fillRule","clipRule","d","isAnnouncedByScreenReader","jsxs","Fragment","visuallyHidden"],"sourceRoot":""}