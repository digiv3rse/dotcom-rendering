{"version":3,"file":"FetchOnwardsData-importable.modern.7be4c74318a0ae70ca47.js","mappings":"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","sources":["webpack://@guardian/dotcom-rendering/./src/web/components/FetchOnwardsData.importable.tsx","webpack://@guardian/dotcom-rendering/./src/web/components/Placeholder.tsx","webpack://@guardian/dotcom-rendering/./src/web/lib/decideDesign.ts","webpack://@guardian/dotcom-rendering/./src/web/lib/decideDisplay.ts","webpack://@guardian/dotcom-rendering/./src/web/lib/decideTheme.ts","webpack://@guardian/dotcom-rendering/./src/web/lib/decideFormat.ts","webpack://@guardian/dotcom-rendering/./src/web/lib/decideTrail.ts","webpack://@guardian/dotcom-rendering/./src/web/lib/getDataLinkName.ts","webpack://@guardian/dotcom-rendering/./src/web/lib/revealStyles.ts"],"sourcesContent":["import { css } from '@emotion/react';\nimport { useEffect } from 'react';\nimport type { OnwardsSource } from '../../types/onwards';\nimport type { FETrailType, TrailType } from '../../types/trails';\nimport { decideTrail } from '../lib/decideTrail';\nimport { revealStyles } from '../lib/revealStyles';\nimport { useApi } from '../lib/useApi';\nimport { Carousel } from './Carousel.importable';\nimport { Placeholder } from './Placeholder';\n\ntype Props = {\n\turl: string;\n\tlimit: number; // Limit the number of items shown (the api often returns more)\n\tonwardsSource: OnwardsSource;\n\tformat: ArticleFormat;\n};\n\ntype OnwardsResponse = {\n\ttrails: FETrailType[];\n\theading: string;\n\tdisplayname: string;\n\tdescription: string;\n};\n\nconst minHeight = css`\n\tmin-height: 300px;\n`;\n\nexport const FetchOnwardsData = ({\n\turl,\n\tlimit,\n\tonwardsSource,\n\tformat,\n}: Props) => {\n\tconst { data, loading, error } = useApi<OnwardsResponse>(url);\n\n\tconst buildTrails = (\n\t\ttrails: FETrailType[],\n\t\ttrailLimit: number,\n\t): TrailType[] => {\n\t\treturn trails.slice(0, trailLimit).map(decideTrail);\n\t};\n\n\tuseEffect(() => {\n\t\tif (data) {\n\t\t\tconst pendingElements = document.querySelectorAll<HTMLElement>(\n\t\t\t\t'.onwards > .pending',\n\t\t\t);\n\t\t\tpendingElements.forEach((element) => {\n\t\t\t\telement.classList.add('reveal');\n\t\t\t\telement.classList.remove('pending');\n\t\t\t});\n\t\t}\n\t});\n\n\tif (error) {\n\t\t// Send the error to Sentry and then prevent the element from rendering\n\t\twindow.guardian.modules.sentry.reportError(error, 'onwards-lower');\n\t\treturn null;\n\t}\n\n\tif (loading) {\n\t\treturn (\n\t\t\t<Placeholder\n\t\t\t\t// 300 is a best guess\n\t\t\t\theight={300}\n\t\t\t\tshouldShimmer={false}\n\t\t\t\tbackgroundColor=\"white\"\n\t\t\t/>\n\t\t);\n\t}\n\n\tif (data?.trails) {\n\t\treturn (\n\t\t\t<div css={[minHeight, revealStyles]} className=\"onwards\">\n\t\t\t\t<div className=\"pending\">\n\t\t\t\t\t<Carousel\n\t\t\t\t\t\theading={data.heading || data.displayname} // Sometimes the api returns heading as 'displayName'\n\t\t\t\t\t\ttrails={buildTrails(data.trails, limit)}\n\t\t\t\t\t\tdescription={data.description}\n\t\t\t\t\t\tonwardsSource={onwardsSource}\n\t\t\t\t\t\tformat={format}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t);\n\t}\n\n\treturn null;\n};\n","import { css, keyframes } from '@emotion/react';\nimport { neutral, space } from '@guardian/source-foundations';\n\nconst BACKGROUND_COLOUR = neutral[93];\n\ntype Props = {\n\theight: number;\n\trootId?: string;\n\twidth?: number;\n\tspaceBelow?: 1 | 2 | 3 | 4 | 5 | 6 | 9;\n\tspaceLeft?: 1 | 2 | 3 | 4 | 5 | 6 | 9;\n\tshouldShimmer?: boolean;\n\tbackgroundColor?: string;\n};\n\nconst shimmer = keyframes`\n  0% {\n    background-position: -1500px 0;\n  }\n  100% {\n    background-position: 1500px 0;\n  }\n`;\n\nconst shimmerStyles = (backgroundColor: string) => css`\n\tanimation: ${shimmer} 2s infinite linear;\n\tbackground: linear-gradient(\n\t\tto right,\n\t\t${backgroundColor} 4%,\n\t\twhite 25%,\n\t\t${backgroundColor} 36%\n\t);\n\tbackground-size: 1500px 100%;\n`;\n\nexport const Placeholder = ({\n\theight,\n\trootId,\n\twidth,\n\tspaceBelow,\n\tspaceLeft,\n\tshouldShimmer = true,\n\tbackgroundColor = BACKGROUND_COLOUR,\n}: Props) => (\n\t<div\n\t\tid={rootId}\n\t\tcss={css`\n\t\t\tflex-grow: 1;\n\t\t`}\n\t\tdata-name=\"placeholder\"\n\t>\n\t\t<div\n\t\t\tcss={css`\n\t\t\t\theight: ${height}px;\n\t\t\t\twidth: ${width !== undefined ? `${width}px` : '100%'};\n\t\t\t\tmargin-bottom: ${spaceBelow && space[spaceBelow]}px;\n\t\t\t\tmargin-left: ${spaceLeft && space[spaceLeft]}px;\n\t\t\t\tbackground-color: ${backgroundColor};\n\n\t\t\t\t${shouldShimmer && shimmerStyles(backgroundColor)}\n\t\t\t`}\n\t\t/>\n\t</div>\n);\n","import { ArticleDesign } from '@guardian/libs';\n\n/**\n * NOTE: Immersive Opinion pieces are not supported,\n * i.e. when `CommentDesign` and `ImmersiveDisplay` are used jointly.\n */\nexport const decideDesign = ({\n\tdesign,\n\tdisplay,\n}: Partial<FEFormat>): ArticleDesign => {\n\tswitch (design) {\n\t\tcase 'ArticleDesign':\n\t\t\treturn ArticleDesign.Standard;\n\t\tcase 'GalleryDesign':\n\t\t\treturn ArticleDesign.Gallery;\n\t\tcase 'AudioDesign':\n\t\t\treturn ArticleDesign.Audio;\n\t\tcase 'VideoDesign':\n\t\t\treturn ArticleDesign.Video;\n\t\tcase 'ReviewDesign':\n\t\t\treturn ArticleDesign.Review;\n\t\tcase 'AnalysisDesign':\n\t\t\treturn ArticleDesign.Analysis;\n\t\tcase 'CommentDesign':\n\t\t\t// Temporary hack until we can handle Immersive Opinion pieces\n\t\t\treturn display === 'ImmersiveDisplay'\n\t\t\t\t? ArticleDesign.Standard\n\t\t\t\t: ArticleDesign.Comment;\n\t\tcase 'LetterDesign':\n\t\t\treturn ArticleDesign.Letter;\n\t\tcase 'FeatureDesign':\n\t\t\treturn ArticleDesign.Feature;\n\t\tcase 'LiveBlogDesign':\n\t\t\treturn ArticleDesign.LiveBlog;\n\t\tcase 'DeadBlogDesign':\n\t\t\treturn ArticleDesign.DeadBlog;\n\t\tcase 'RecipeDesign':\n\t\t\treturn ArticleDesign.Recipe;\n\t\tcase 'MatchReportDesign':\n\t\t\treturn ArticleDesign.MatchReport;\n\t\tcase 'InterviewDesign':\n\t\t\treturn ArticleDesign.Interview;\n\t\tcase 'EditorialDesign':\n\t\t\treturn ArticleDesign.Editorial;\n\t\tcase 'QuizDesign':\n\t\t\treturn ArticleDesign.Quiz;\n\t\tcase 'InteractiveDesign':\n\t\t\treturn ArticleDesign.Interactive;\n\t\tcase 'PhotoEssayDesign':\n\t\t\treturn ArticleDesign.PhotoEssay;\n\t\tcase 'PrintShopDesign':\n\t\t\treturn ArticleDesign.PrintShop;\n\t\tcase 'ObituaryDesign':\n\t\t\treturn ArticleDesign.Obituary;\n\t\tcase 'FullPageInteractiveDesign':\n\t\t\treturn ArticleDesign.FullPageInteractive;\n\t\tcase 'NewsletterSignupDesign':\n\t\t\treturn ArticleDesign.NewsletterSignup;\n\t\tcase 'ExplainerDesign':\n\t\t\treturn ArticleDesign.Explainer;\n\t\tcase 'TimelineDesign':\n\t\t\treturn ArticleDesign.Timeline;\n\t\tcase 'ProfileDesign':\n\t\t\treturn ArticleDesign.Profile;\n\t\tdefault:\n\t\t\treturn ArticleDesign.Standard;\n\t}\n};\n","import { ArticleDisplay } from '@guardian/libs';\n\nexport const decideDisplay = ({\n\tdisplay,\n}: Partial<FEFormat>): ArticleDisplay => {\n\tswitch (display) {\n\t\tcase 'StandardDisplay':\n\t\t\treturn ArticleDisplay.Standard;\n\t\tcase 'ImmersiveDisplay':\n\t\t\treturn ArticleDisplay.Immersive;\n\t\tcase 'ShowcaseDisplay':\n\t\t\treturn ArticleDisplay.Showcase;\n\t\tcase 'NumberedListDisplay':\n\t\t\treturn ArticleDisplay.NumberedList;\n\t\tdefault:\n\t\t\treturn ArticleDisplay.Standard;\n\t}\n};\n","import { ArticlePillar, ArticleSpecial } from '@guardian/libs';\n\nexport const decideTheme = ({ theme }: Partial<FEFormat>): ArticleTheme => {\n\tswitch (theme) {\n\t\tcase 'NewsPillar':\n\t\t\treturn ArticlePillar.News;\n\t\tcase 'OpinionPillar':\n\t\t\treturn ArticlePillar.Opinion;\n\t\tcase 'SportPillar':\n\t\t\treturn ArticlePillar.Sport;\n\t\tcase 'CulturePillar':\n\t\t\treturn ArticlePillar.Culture;\n\t\tcase 'LifestylePillar':\n\t\t\treturn ArticlePillar.Lifestyle;\n\t\tcase 'SpecialReportTheme':\n\t\t\treturn ArticleSpecial.SpecialReport;\n\t\tcase 'SpecialReportAltTheme':\n\t\t\treturn ArticleSpecial.SpecialReportAlt;\n\t\tcase 'Labs':\n\t\t\treturn ArticleSpecial.Labs;\n\t\tdefault:\n\t\t\treturn ArticlePillar.News;\n\t}\n};\n","import { decideDesign } from './decideDesign';\nimport { decideDisplay } from './decideDisplay';\nimport { decideTheme } from './decideTheme';\n\nexport const decideFormat = (format: Partial<FEFormat>): ArticleFormat => ({\n\tdisplay: decideDisplay(format),\n\ttheme: decideTheme(format),\n\tdesign: decideDesign(format),\n});\n","import type { FETrailType, TrailType } from '../../types/trails';\nimport { decideFormat } from './decideFormat';\nimport { getDataLinkNameCard } from './getDataLinkName';\n\nexport const decideTrail = (trail: FETrailType, index = 0): TrailType => {\n\tconst format: ArticleFormat = decideFormat(trail.format);\n\n\treturn {\n\t\t...trail,\n\t\tformat,\n\t\tdataLinkName: getDataLinkNameCard(format, '0', index + 1),\n\t};\n};\n","import { ArticleDesign, ArticleSpecial } from '@guardian/libs';\n\n/**\n * TODO: missing \"podcast\" and \"external\"\n */\nconst getLinkType = ({ theme, design }: ArticleFormat): RichLinkCardType => {\n\tswitch (theme) {\n\t\tcase ArticleSpecial.SpecialReport:\n\t\t\treturn 'special-report';\n\t\tdefault:\n\t\t\tswitch (design) {\n\t\t\t\tcase ArticleDesign.Analysis:\n\t\t\t\t\treturn 'analysis';\n\t\t\t\tcase ArticleDesign.LiveBlog:\n\t\t\t\t\treturn 'live';\n\t\t\t\tcase ArticleDesign.DeadBlog:\n\t\t\t\t\treturn 'dead';\n\t\t\t\tcase ArticleDesign.Feature:\n\t\t\t\t\treturn 'feature';\n\t\t\t\tcase ArticleDesign.Editorial:\n\t\t\t\t\treturn 'editorial';\n\t\t\t\tcase ArticleDesign.Comment:\n\t\t\t\t\treturn 'comment';\n\t\t\t\tcase ArticleDesign.Gallery:\n\t\t\t\tcase ArticleDesign.Audio:\n\t\t\t\tcase ArticleDesign.Video:\n\t\t\t\t\treturn 'media';\n\t\t\t\tcase ArticleDesign.Review:\n\t\t\t\t\treturn 'review';\n\t\t\t\tcase ArticleDesign.Letter:\n\t\t\t\t\treturn 'letters';\n\n\t\t\t\tdefault:\n\t\t\t\t\treturn 'news';\n\t\t\t}\n\t}\n};\n\n/**\n * Get the `data-link-name` attribute for a card.\n * Used by Ophan for understanding reader journeys. E.g:\n * - `feature | card-2+ | card-@1`\n * - `news | group-0 | card-@5`\n *\n * @see {JSX.IntrinsicAttributes}\n */\nexport const getDataLinkNameCard = (\n\tformat: ArticleFormat,\n\tgroup: string | number,\n\tindex: number,\n): string =>\n\t[getLinkType(format), `group-${group}`, `card-@${index}`].join(' | ');\n","import { css, keyframes } from '@emotion/react';\n\n/**\n * Sometimes we want to animate in new content using plain\n * javascript. We use these classes to do that.\n */\nexport const revealStyles = css`\n\t/* We're using classnames here because we add and remove these classes\n\t   using plain javascript */\n\t.reveal {\n\t\tanimation: ${keyframes`\n\t\t\t0% { opacity: 0; }\n\t\t\t100% { opacity: 1; }\n\t\t`} 1s ease-out;\n\t}\n\t.reveal-slowly {\n\t\tanimation: ${keyframes`\n\t\t\t0% { opacity: 0; }\n\t\t\t100% { opacity: 1; }\n\t\t`} 4s ease-out;\n\t}\n\t.pending {\n\t\tdisplay: none;\n\t}\n`;\n"],"names":["minHeight","css","FetchOnwardsData","url","limit","onwardsSource","format","data","loading","error","useApi","useEffect","document","querySelectorAll","forEach","element","classList","add","remove","window","guardian","modules","sentry","reportError","Placeholder","height","shouldShimmer","backgroundColor","trails","div","revealStyles","className","Carousel","heading","displayname","trailLimit","slice","map","decideTrail","description","BACKGROUND_COLOUR","neutral","shimmer","keyframes","shimmerStyles","rootId","width","spaceBelow","spaceLeft","id","data-name","undefined","space","decideDesign","design","display","ArticleDesign","decideDisplay","ArticleDisplay","decideTheme","theme","ArticlePillar","ArticleSpecial","decideFormat","trail","index","dataLinkName","getDataLinkNameCard","getLinkType","group","join"],"sourceRoot":""}