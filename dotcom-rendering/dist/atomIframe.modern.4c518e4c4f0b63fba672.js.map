{"version":3,"file":"atomIframe.modern.4c518e4c4f0b63fba672.js","mappings":"sLAEO,MAAMA,EAAa,KACzBC,EAAAA,EAAAA,GAAmB,gB,kCCDb,MAAMA,EAAsBC,IAClC,MAAMC,EAA+B,GAAGC,MAAMC,KAC7CC,SAASC,iBAAiBL,IAmC3B,OAhCAM,OAAOC,iBAAiB,WAAYC,IACnC,MAAMC,EAAwCR,EAAQS,MAAMC,IAC3D,IACC,OAAOA,EAAEC,OAAS,EAA2BC,OAAOD,IAGrD,CAFE,MAAOE,GACR,OAAO,CACR,KAED,GAAIL,EACH,IACC,MAAMM,EAAUC,KAAKC,MAAMT,EAAMU,MAK3B,eADEH,EAAQI,OAEdV,EAAOW,OAASL,EAAQM,MAKd,CAAX,MAAOP,GAAI,CACd,IAGDb,EAAQqB,SAASb,I,IACHA,EAAb,MAAMc,GAA2B,QAApBd,EAAAA,EAAOe,aAAa,iBAApBf,IAAAA,EAAAA,EAAiC,IAC5CgB,QAAQ,eAAgB,YAExBA,QAAQ,iBAAkB,cAC5BhB,EAAOiB,aAAa,SAAUH,EAAI,IAE5BI,QAAQC,SAAS,C","sources":["webpack://@guardian/dotcom-rendering/./src/web/browser/atomIframe.ts","webpack://@guardian/dotcom-rendering/./src/web/browser/updateIframeHeight.tsx"],"sourcesContent":["import { updateIframeHeight } from './updateIframeHeight';\n\nexport const atomIframe = (): Promise<void> =>\n\tupdateIframeHeight('.atom__iframe');\n","type HeightEventType = { source: { name: string } };\n\nexport const updateIframeHeight = (queryString: string): Promise<void> => {\n\tconst iframes: HTMLIFrameElement[] = [].slice.call(\n\t\tdocument.querySelectorAll(queryString),\n\t);\n\n\twindow.addEventListener('message', (event) => {\n\t\tconst iframe: HTMLIFrameElement | undefined = iframes.find((i) => {\n\t\t\ttry {\n\t\t\t\treturn i.name === (event as HeightEventType).source.name;\n\t\t\t} catch (e) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t\tif (iframe) {\n\t\t\ttry {\n\t\t\t\tconst message = JSON.parse(event.data) as {\n\t\t\t\t\ttype: string;\n\t\t\t\t\tvalue: string;\n\t\t\t\t};\n\t\t\t\tswitch (message.type) {\n\t\t\t\t\tcase 'set-height':\n\t\t\t\t\t\tiframe.height = message.value;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t}\n\t\t\t\t// eslint-disable-next-line no-empty\n\t\t\t} catch (e) {}\n\t\t}\n\t});\n\n\tiframes.forEach((iframe) => {\n\t\tconst src = (iframe.getAttribute('srcdoc') ?? '')\n\t\t\t.replace(/<gu-script>/g, '<script>')\n\n\t\t\t.replace(/<\\/gu-script>/g, '<' + '/script>');\n\t\tiframe.setAttribute('srcdoc', src);\n\t});\n\treturn Promise.resolve();\n};\n"],"names":["atomIframe","updateIframeHeight","queryString","iframes","slice","call","document","querySelectorAll","window","addEventListener","event","iframe","find","i","name","source","e","message","JSON","parse","data","type","height","value","forEach","src","getAttribute","replace","setAttribute","Promise","resolve"],"sourceRoot":""}