{"version":3,"file":"Carousel-importable.modern.9c912d7cc739432b469e.js","mappings":"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","sources":["webpack://@guardian/dotcom-rendering/./src/static/icons/comment.svg","webpack://@guardian/dotcom-rendering/./src/web/lib/formatAttrString.ts","webpack://@guardian/dotcom-rendering/./src/web/components/Carousel.importable.tsx","webpack://@guardian/dotcom-rendering/./src/web/components/CardCommentCount.tsx","webpack://@guardian/dotcom-rendering/./src/web/components/FetchCommentCounts.importable.tsx","webpack://@guardian/dotcom-rendering/./src/web/components/LeftColumn.tsx","webpack://@guardian/dotcom-rendering/./src/lib/formatters.ts","webpack://@guardian/dotcom-rendering/./src/web/lib/formatCount.ts"],"sourcesContent":["\nmodule.exports = {\"attributes\":{\"width\":\"16\",\"height\":\"16\",\"viewBox\":\"0 0 16 16\"},\"content\":\"<path d=\\\"M13 0l1 1v7l-1 1H7l-2 3H4V9H2L1 8V1l1-1h11z\\\"></path>\"}\nvar desvg = require('@kossnocorp/desvg/react')\nmodule.exports = desvg(module.exports)\n","type StrInOutFuncType = (str: string) => string;\n\nconst removeAlphaNumeric: StrInOutFuncType = (str) =>\n\tstr.replace(new RegExp('[^0-9a-z ]', 'gi'), ';'); // We set it to semicolon so we can remove it at the end\nconst lowercase: StrInOutFuncType = (str) => str.toLowerCase();\nconst replaceSpacesWithHyphens: StrInOutFuncType = (str) =>\n\tstr.replace(new RegExp(' ', 'g'), '-'); // Replace the space\nconst removeTempChars: StrInOutFuncType = (str) =>\n\tstr.replace(new RegExp('[;]', 'g'), ''); // Strip out those semicolons\n\nexport const formatAttrString = (input: string): string =>\n\tremoveTempChars(\n\t\treplaceSpacesWithHyphens(lowercase(removeAlphaNumeric(input))),\n\t);\n","import { css } from '@emotion/react';\nimport { ArticleDesign } from '@guardian/libs';\nimport {\n\tbrandAlt,\n\tfrom,\n\theadline,\n\tneutral,\n\tspace,\n\ttext,\n\tuntil,\n} from '@guardian/source-foundations';\nimport libDebounce from 'lodash.debounce';\nimport { useEffect, useRef, useState } from 'react';\nimport type { Branding } from '../../types/branding';\nimport type { OnwardsSource } from '../../types/onwards';\nimport type { Palette } from '../../types/palette';\nimport type { TrailType } from '../../types/trails';\nimport { decidePalette } from '../lib/decidePalette';\nimport { formatAttrString } from '../lib/formatAttrString';\nimport { getSourceImageUrl } from '../lib/getSourceImageUrl_temp_fix';\nimport { getZIndex } from '../lib/getZIndex';\nimport { Card } from './Card/Card';\nimport { LI } from './Card/components/LI';\nimport { FetchCommentCounts } from './FetchCommentCounts.importable';\nimport { Hide } from './Hide';\nimport { LeftColumn } from './LeftColumn';\n\ntype Props = {\n\theading: string;\n\ttrails: TrailType[];\n\tdescription?: string;\n\turl?: string;\n\tonwardsSource: OnwardsSource;\n\tformat: ArticleFormat;\n};\n\n// Carousel icons - need replicating from source for centring\n\nconst SvgChevronLeftSingle = () => {\n\treturn (\n\t\t<svg\n\t\t\tviewBox=\"0 0 32 32\"\n\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\twidth=\"24\"\n\t\t\theight=\"24\"\n\t\t>\n\t\t\t<path\n\t\t\t\tfillRule=\"evenodd\"\n\t\t\t\tclipRule=\"evenodd\"\n\t\t\t\td=\"M18.4 4L8 14.4V15.45L18.4 25.8499L19.375 24.8999L11.05 14.925L19.375 4.95L18.4 4Z\"\n\t\t\t/>\n\t\t</svg>\n\t);\n};\n\nconst SvgChevronRightSingle = () => {\n\treturn (\n\t\t<svg\n\t\t\tviewBox=\"0 0 32 32\"\n\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\twidth=\"24\"\n\t\t\theight=\"24\"\n\t\t>\n\t\t\t<path\n\t\t\t\tfillRule=\"evenodd\"\n\t\t\t\tclipRule=\"evenodd\"\n\t\t\t\td=\"M9.975 4L9 4.95L17.325 14.925L9 24.8999L9.975 25.8499L20.375 15.45V14.4L9.975 4Z\"\n\t\t\t/>\n\t\t</svg>\n\t);\n};\n\nconst wrapperStyle = (length: number) => css`\n\tdisplay: flex;\n\t/* Remove space-between where there is a single item, so that it is left-aligned */\n\t${length > 1 && 'justify-content: space-between'}\n\toverflow: hidden;\n\t${from.desktop} {\n\t\tpadding-right: 40px;\n\t}\n`;\n\n// For desktop and above, are we at the last card. Is one less than the dots style equivalent\nconst isLastCardShowing = (index: number, totalStories: number) =>\n\tindex >= totalStories - 4;\n\nconst containerMargins = css`\n\tmargin-top: 6px;\n\tmargin-bottom: 24px;\n\n\tmargin-left: 0px;\n\tmargin-right: 0px;\n\n\t${from.tablet} {\n\t\t/* Shrink the container to remove the leading and\n       \t\t\t\t   trailing side margins from the list of cards */\n\t\tmargin-left: -10px;\n\t\tmargin-right: -10px;\n\t}\n\n\t${from.leftCol} {\n\t\tmargin-left: -1px;\n\t\tmargin-right: -10px;\n\t\tmargin-top: 6px;\n\t}\n`;\n\nconst containerStyles = css`\n\tdisplay: flex;\n\tflex-direction: column;\n\tposition: relative;\n\toverflow: hidden; /* Needed for scrolling to work */\n`;\n\nconst carouselStyle = css`\n\tmin-height: 227px;\n\tposition: relative; /* must set position for offset(Left) calculations of children to be relative to this box */\n\n\tdisplay: flex;\n\tflex-direction: row;\n\talign-items: stretch;\n\n\tscroll-snap-type: x mandatory;\n\tscroll-behavior: smooth;\n\toverflow-x: auto; /* Scrollbar is less intrusive visually on non-desktop devices typically */\n\toverflow-y: hidden; /*Fixes small problem with 1px vertical scroll on immersive due to top bar */\n\t${from.tablet} {\n\t\t&::-webkit-scrollbar {\n\t\t\tdisplay: none;\n\t\t}\n\n\t\tscrollbar-width: none;\n\t}\n\n\t${until.tablet} {\n\t\tmargin-left: -10px; /* Align firstcard on mobile devices */\n\t}\n`;\n\nconst dotsStyle = css`\n\tmargin-bottom: ${space[2]}px;\n`;\n\nconst dotStyle = css`\n\tcursor: pointer;\n\tdisplay: inline-block;\n\theight: ${space[3]}px;\n\twidth: ${space[3]}px;\n\tbackground-color: ${neutral[93]};\n\tborder-radius: 100%;\n\tborder: 0 none;\n\tpadding: 0;\n\tmargin-right: ${space[1]}px;\n\n\t&:hover,\n\t&:focus {\n\t\tbackground-color: ${neutral[86]};\n\t\toutline: none;\n\t}\n`;\n\nconst dotActiveStyle = (palette: Palette) => css`\n\tbackground-color: ${palette.background.carouselDot};\n\n\t&:hover,\n\t&:focus {\n\t\tbackground-color: ${palette.background.carouselDotFocus};\n\t}\n`;\n\nconst adjustNumberOfDotsStyle = (index: number, totalStories: number) => {\n\treturn css`\n\t\t${from.phablet} {\n\t\t\tdisplay: ${index >= totalStories - 1 ? 'none' : 'auto'};\n\t\t}\n\n\t\t${from.tablet} {\n\t\t\tdisplay: ${index >= totalStories - 2 ? 'none' : 'auto'};\n\t\t}\n\n\t\t${from.desktop} {\n\t\t\tdisplay: ${index >= totalStories - 3 ? 'none' : 'auto'};\n\t\t}\n\t`;\n};\n\n// Not used for buttons above carousel\nconst buttonContainerStyle = css`\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: center;\n\tposition: absolute;\n\t${getZIndex('onwardsCarousel')}\n\theight: 100%;\n\tpadding-bottom: 36px; /* Align buttons centrally with cards */\n\n\t${until.leftCol} {\n\t\tdisplay: none;\n\t}\n`;\nconst prevButtonContainerStyle = (format: ArticleFormat) => {\n\tswitch (format.design) {\n\t\tcase ArticleDesign.LiveBlog:\n\t\tcase ArticleDesign.DeadBlog: {\n\t\t\treturn css`\n\t\t\t\t${from.leftCol} {\n\t\t\t\t\tleft: 205px;\n\t\t\t\t}\n\t\t\t`;\n\t\t}\n\t\tdefault: {\n\t\t\treturn css`\n\t\t\t\t${from.leftCol} {\n\t\t\t\t\tleft: 120px;\n\t\t\t\t}\n\n\t\t\t\t${from.wide} {\n\t\t\t\t\tleft: 205px;\n\t\t\t\t}\n\t\t\t`;\n\t\t}\n\t}\n};\n\nconst nextButtonContainerStyle = css`\n\tright: 10px;\n`;\n\nconst buttonStyle = css`\n\tborder: 0 none;\n\tborder-radius: 100%;\n\theight: 34px;\n\twidth: 34px;\n\tcursor: pointer;\n\tmargin-top: 10px;\n\tpadding: 0;\n\tbackground-color: ${neutral[0]};\n\n\t&:active,\n\t&:hover {\n\t\toutline: none;\n\t\tbackground-color: ${brandAlt[400]};\n\t\tsvg {\n\t\t\tfill: ${neutral[7]};\n\t\t}\n\t}\n\n\t&:focus {\n\t\toutline: none;\n\t}\n\n\tsvg {\n\t\tfill: ${neutral[100]};\n\t\theight: 34px;\n\t}\n`;\n\nconst prevButtonStyle = (index: number) => css`\n\tbackground-color: ${index !== 0 ? neutral[0] : neutral[60]};\n\tcursor: ${index !== 0 ? 'pointer' : 'default'};\n\n\t&:hover,\n\t&:focus {\n\t\tbackground-color: ${index !== 0 ? brandAlt[400] : neutral[60]};\n\n\t\tsvg {\n\t\t\tfill: ${neutral[100]};\n\t\t}\n\t}\n`;\n\nconst nextButtonStyle = (index: number, totalStories: number) => css`\n\tpadding-left: 5px; /* Fix centering of SVG*/\n\tmargin-left: 10px;\n\tbackground-color: ${!isLastCardShowing(index, totalStories)\n\t\t? neutral[0]\n\t\t: neutral[60]};\n\tcursor: ${!isLastCardShowing(index, totalStories) ? 'pointer' : 'default'};\n\n\t&:hover,\n\t&:focus {\n\t\tbackground-color: ${!isLastCardShowing(index, totalStories)\n\t\t\t? brandAlt[400]\n\t\t\t: neutral[60]};\n\n\t\tsvg {\n\t\t\tfill: ${neutral[100]};\n\t\t}\n\t}\n`;\n\nconst headerRowStyles = css`\n\tdisplay: flex;\n\tflex-direction: row;\n\tjustify-content: space-between;\n\t${from.tablet} {\n\t\tpadding-right: 10px;\n\t}\n\n\t${from.tablet} {\n\t\tmargin-left: 10px;\n\t}\n`;\n\nconst headerStyles = css`\n\t${headline.xsmall({ fontWeight: 'bold' })};\n\tcolor: ${text.primary};\n\t${headline.xsmall({ fontWeight: 'bold' })};\n\tpadding-bottom: ${space[2]}px;\n\tpadding-top: ${space[1]}px;\n\tmargin-left: 0;\n`;\n\nconst titleStyle = (palette: Palette, isCuratedContent?: boolean) => css`\n\tcolor: ${isCuratedContent ? palette.text.carouselTitle : text.primary};\n`;\n\nconst Title = ({\n\ttitle,\n\tpalette,\n\tisCuratedContent,\n}: {\n\ttitle: string;\n\tpalette: Palette;\n\tisCuratedContent?: boolean;\n}) => (\n\t<h2 css={headerStyles}>\n\t\t{isCuratedContent ? 'More from ' : ''}\n\t\t<span css={titleStyle(palette, isCuratedContent)}>{title}</span>\n\t</h2>\n);\n\ntype CarouselCardProps = {\n\tisFirst: boolean;\n\tformat: ArticleFormat;\n\tlinkTo: string;\n\theadlineText: string;\n\twebPublicationDate: string;\n\tkickerText?: string;\n\timageUrl?: string;\n\tdataLinkName?: string;\n\tdiscussionId?: string;\n\t/** Only used on Labs cards */\n\tbranding?: Branding;\n};\n\nconst CarouselCard = ({\n\tformat,\n\tlinkTo,\n\timageUrl,\n\theadlineText,\n\twebPublicationDate,\n\tkickerText,\n\tisFirst,\n\tdataLinkName,\n\tdiscussionId,\n\tbranding,\n}: CarouselCardProps) => (\n\t<LI\n\t\tpercentage=\"25%\"\n\t\tshowDivider={!isFirst}\n\t\tpadSides={true}\n\t\tpadSidesOnMobile={true}\n\t\tsnapAlignStart={true}\n\t>\n\t\t<Card\n\t\t\tlinkTo={linkTo}\n\t\t\tformat={format}\n\t\t\theadlineText={headlineText}\n\t\t\twebPublicationDate={webPublicationDate}\n\t\t\tkickerText={kickerText}\n\t\t\timageUrl={imageUrl}\n\t\t\timageSize={imageUrl ? 'carousel' : undefined}\n\t\t\tshowClock={true}\n\t\t\tshowAge={true}\n\t\t\timagePositionOnMobile=\"top\"\n\t\t\tminWidthInPixels={220}\n\t\t\tshowQuotedHeadline={format.design === ArticleDesign.Comment}\n\t\t\tdataLinkName={dataLinkName}\n\t\t\tdiscussionId={discussionId}\n\t\t\tbranding={branding}\n\t\t\tisExternalLink={false}\n\t\t/>\n\t</LI>\n);\n\ntype HeaderAndNavProps = {\n\theading: string;\n\ttrails: TrailType[];\n\tpalette: Palette;\n\tindex: number;\n\tisCuratedContent?: boolean;\n\tgoToIndex: (newIndex: number) => void;\n};\n\nconst HeaderAndNav = ({\n\theading,\n\ttrails,\n\tpalette,\n\tindex,\n\tisCuratedContent,\n\tgoToIndex,\n}: HeaderAndNavProps) => (\n\t<div>\n\t\t<Title\n\t\t\ttitle={heading}\n\t\t\tpalette={palette}\n\t\t\tisCuratedContent={isCuratedContent}\n\t\t/>\n\t\t<div css={dotsStyle}>\n\t\t\t{trails.map((_, i) => (\n\t\t\t\t<span\n\t\t\t\t\tonClick={() => goToIndex(i)}\n\t\t\t\t\t// This button is not particularly useful for keyboard users as the stories\n\t\t\t\t\t// are tabb-able themselves so we hide them with aria and make them\n\t\t\t\t\t// not available to keyboard\n\t\t\t\t\taria-hidden=\"true\"\n\t\t\t\t\tkey={`dot-${i}`}\n\t\t\t\t\tcss={[\n\t\t\t\t\t\tdotStyle,\n\t\t\t\t\t\ti === index && dotActiveStyle(palette),\n\t\t\t\t\t\tadjustNumberOfDotsStyle(i, trails.length),\n\t\t\t\t\t]}\n\t\t\t\t\tdata-link-name={`carousel-small-nav-dot-${i}`}\n\t\t\t\t/>\n\t\t\t))}\n\t\t</div>\n\t</div>\n);\n\n/**\n * # Carousel\n *\n * A carousel of cards, mainly used in onward journeys,\n * at the bottom of articles\n *\n * ## Why does this need to be an Island?\n *\n * Data is fetched from an API client-side.\n *\n * ---\n *\n * [`Carousel` on Chromatic](https://www.chromatic.com/component?appId=63e251470cfbe61776b0ef19&csfId=components-carousel)\n */\nexport const Carousel = ({ heading, trails, onwardsSource, format }: Props) => {\n\tconst palette = decidePalette(format);\n\tconst carouselRef = useRef<HTMLUListElement>(null);\n\n\tconst [index, setIndex] = useState(0);\n\tconst [maxIndex, setMaxIndex] = useState(0);\n\n\tconst arrowName = 'carousel-small-arrow';\n\n\tconst isCuratedContent = onwardsSource === 'curated-content';\n\n\tconst notPresentation = (el: HTMLElement): boolean =>\n\t\tel.getAttribute('role') !== 'presentation';\n\n\tconst getItems = (): HTMLElement[] => {\n\t\tconst { current } = carouselRef;\n\t\tif (current === null) return [];\n\n\t\treturn Array.from(current.children) as HTMLElement[];\n\t};\n\n\tconst getIndex = (): number => {\n\t\tconst { current } = carouselRef;\n\t\tconst offsets = getItems()\n\t\t\t.filter(notPresentation)\n\t\t\t.map((el) => el.offsetLeft);\n\t\tconst [offset] = offsets;\n\t\tif (current === null || offset === undefined) return 0;\n\n\t\tconst scrolled = current.scrollLeft + offset;\n\t\tconst active = offsets.findIndex((el) => el >= scrolled);\n\n\t\treturn Math.max(0, active);\n\t};\n\n\tconst getSetIndex = () => {\n\t\tsetIndex(getIndex());\n\t};\n\n\tconst goToIndex = (newIndex: number) => {\n\t\tconst { current } = carouselRef;\n\t\tif (current === null) return;\n\n\t\tconst offsets = getItems()\n\t\t\t.filter(notPresentation)\n\t\t\t.map((el) => el.offsetLeft);\n\n\t\tcurrent.scrollTo({ left: offsets[newIndex] });\n\n\t\tgetSetIndex();\n\t};\n\n\tconst prev = () => {\n\t\tconst { current } = carouselRef;\n\t\tconst offsets = getItems()\n\t\t\t.filter(notPresentation)\n\t\t\t.map(({ offsetLeft }) => offsetLeft);\n\t\tconst [offset] = offsets;\n\n\t\tif (current === null || offset === undefined) return;\n\n\t\tconst scrolled = current.scrollLeft + offset;\n\n\t\tconst nextOffset = offsets.reverse().find((o) => o < scrolled);\n\n\t\tif (nextOffset !== undefined && nextOffset !== 0) {\n\t\t\tcurrent.scrollTo({ left: nextOffset });\n\t\t} else {\n\t\t\tcurrent.scrollTo({ left: 0 });\n\t\t}\n\t\tgetSetIndex();\n\t};\n\n\tconst next = () => {\n\t\tconst { current } = carouselRef;\n\t\tconst offsets = getItems()\n\t\t\t.filter(notPresentation)\n\t\t\t.map(({ offsetLeft }) => offsetLeft);\n\t\tconst [offset] = offsets;\n\n\t\tif (current === null || offset === undefined) return;\n\n\t\tconst scrolled = current.scrollLeft + offset;\n\t\tconst nextOffset = offsets.find((currOffset) => currOffset > scrolled);\n\n\t\tif (nextOffset !== undefined && nextOffset !== 0) {\n\t\t\tcurrent.scrollTo({ left: nextOffset });\n\t\t}\n\n\t\tgetSetIndex();\n\t};\n\n\tuseEffect(() => {\n\t\tconst carousel = carouselRef.current;\n\t\tif (carousel) {\n\t\t\tcarousel.addEventListener('scroll', libDebounce(getSetIndex, 100));\n\t\t\treturn carousel.removeEventListener(\n\t\t\t\t'scroll',\n\t\t\t\tlibDebounce(getSetIndex, 100),\n\t\t\t);\n\t\t}\n\t});\n\n\t// No idea if this is the best approach but it prevents issues with libDebounce\n\t// using old data to determine the max index. Instead we say update maxIndex\n\t// when index changes and compare it against the prior maxIndex only.\n\tuseEffect(() => setMaxIndex((m) => Math.max(index, m)), [index]);\n\n\treturn (\n\t\t<div\n\t\t\tcss={wrapperStyle(trails.length)}\n\t\t\tdata-link-name={formatAttrString(heading)}\n\t\t>\n\t\t\t<FetchCommentCounts />\n\t\t\t<LeftColumn\n\t\t\t\tborderType=\"partial\"\n\t\t\t\tsize={\n\t\t\t\t\tformat.design === ArticleDesign.LiveBlog ||\n\t\t\t\t\tformat.design === ArticleDesign.DeadBlog\n\t\t\t\t\t\t? 'wide'\n\t\t\t\t\t\t: 'compact'\n\t\t\t\t}\n\t\t\t>\n\t\t\t\t<HeaderAndNav\n\t\t\t\t\theading={heading}\n\t\t\t\t\ttrails={trails}\n\t\t\t\t\tpalette={palette}\n\t\t\t\t\tindex={index}\n\t\t\t\t\tisCuratedContent={isCuratedContent}\n\t\t\t\t\tgoToIndex={goToIndex}\n\t\t\t\t/>\n\t\t\t</LeftColumn>\n\t\t\t<div css={[buttonContainerStyle, prevButtonContainerStyle(format)]}>\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tonClick={prev}\n\t\t\t\t\taria-label=\"Move carousel backwards\"\n\t\t\t\t\tcss={[buttonStyle, prevButtonStyle(index)]}\n\t\t\t\t\tdata-link-name={`${arrowName}-prev`}\n\t\t\t\t>\n\t\t\t\t\t<SvgChevronLeftSingle />\n\t\t\t\t</button>\n\t\t\t</div>\n\n\t\t\t<div css={[buttonContainerStyle, nextButtonContainerStyle]}>\n\t\t\t\t<button\n\t\t\t\t\ttype=\"button\"\n\t\t\t\t\tonClick={next}\n\t\t\t\t\taria-label=\"Move carousel forwards\"\n\t\t\t\t\tcss={[buttonStyle, nextButtonStyle(index, trails.length)]}\n\t\t\t\t\tdata-link-name={`${arrowName}-next`}\n\t\t\t\t>\n\t\t\t\t\t<SvgChevronRightSingle />\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tcss={[containerStyles, containerMargins]}\n\t\t\t\tdata-component={onwardsSource}\n\t\t\t\tdata-link={formatAttrString(heading)}\n\t\t\t>\n\t\t\t\t<Hide when=\"above\" breakpoint=\"leftCol\">\n\t\t\t\t\t<div css={headerRowStyles}>\n\t\t\t\t\t\t<HeaderAndNav\n\t\t\t\t\t\t\theading={heading}\n\t\t\t\t\t\t\ttrails={trails}\n\t\t\t\t\t\t\tpalette={palette}\n\t\t\t\t\t\t\tindex={index}\n\t\t\t\t\t\t\tisCuratedContent={isCuratedContent}\n\t\t\t\t\t\t\tgoToIndex={goToIndex}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Hide when=\"below\" breakpoint=\"desktop\">\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tonClick={prev}\n\t\t\t\t\t\t\t\taria-label=\"Move carousel backwards\"\n\t\t\t\t\t\t\t\tcss={[buttonStyle, prevButtonStyle(index)]}\n\t\t\t\t\t\t\t\tdata-link-name={`${arrowName}-prev`}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<SvgChevronLeftSingle />\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tonClick={next}\n\t\t\t\t\t\t\t\taria-label=\"Move carousel forwards\"\n\t\t\t\t\t\t\t\tcss={[\n\t\t\t\t\t\t\t\t\tbuttonStyle,\n\t\t\t\t\t\t\t\t\tnextButtonStyle(index, trails.length),\n\t\t\t\t\t\t\t\t]}\n\t\t\t\t\t\t\t\tdata-link-name={`${arrowName}-next`}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<SvgChevronRightSingle />\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</Hide>\n\t\t\t\t\t</div>\n\t\t\t\t</Hide>\n\n\t\t\t\t<ul\n\t\t\t\t\tcss={carouselStyle}\n\t\t\t\t\tref={carouselRef}\n\t\t\t\t\tdata-component={`carousel-small | maxIndex-${maxIndex}`}\n\t\t\t\t>\n\t\t\t\t\t{trails.map((trail, i) => {\n\t\t\t\t\t\tconst {\n\t\t\t\t\t\t\turl: linkTo,\n\t\t\t\t\t\t\theadline: headlineText,\n\t\t\t\t\t\t\twebPublicationDate,\n\t\t\t\t\t\t\tformat: trailFormat,\n\t\t\t\t\t\t\timage,\n\t\t\t\t\t\t\tkickerText,\n\t\t\t\t\t\t\tbranding,\n\t\t\t\t\t\t\tdiscussion,\n\t\t\t\t\t\t} = trail;\n\n\t\t\t\t\t\t// Don't try to render cards that have no publication date. This property is technically optional\n\t\t\t\t\t\t// but we rarely if ever expect it not to exist\n\t\t\t\t\t\tif (!webPublicationDate) return null;\n\n\t\t\t\t\t\tconst imageUrl = image && getSourceImageUrl(image);\n\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<CarouselCard\n\t\t\t\t\t\t\t\tkey={`${trail.url}${i}`}\n\t\t\t\t\t\t\t\tisFirst={i === 0}\n\t\t\t\t\t\t\t\tformat={trailFormat}\n\t\t\t\t\t\t\t\tlinkTo={linkTo}\n\t\t\t\t\t\t\t\theadlineText={headlineText}\n\t\t\t\t\t\t\t\twebPublicationDate={webPublicationDate}\n\t\t\t\t\t\t\t\timageUrl={imageUrl}\n\t\t\t\t\t\t\t\tkickerText={kickerText}\n\t\t\t\t\t\t\t\tdataLinkName={`carousel-small-card-position-${i}`}\n\t\t\t\t\t\t\t\tdiscussionId={\n\t\t\t\t\t\t\t\t\tdiscussion?.isCommentable\n\t\t\t\t\t\t\t\t\t\t? discussion.discussionId\n\t\t\t\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbranding={branding}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n","import { css } from '@emotion/react';\nimport { between, textSans } from '@guardian/source-foundations';\nimport CommentIcon from '../../static/icons/comment.svg';\nimport type { DCRContainerPalette } from '../../types/front';\nimport type { Palette } from '../../types/palette';\nimport { decidePalette } from '../lib/decidePalette';\n\ntype Props = {\n\tcontainerPalette?: DCRContainerPalette;\n\tformat: ArticleFormat;\n\tshort: string;\n\tlong: string;\n\tisDynamo?: true;\n};\n\nconst containerStyles = (palette: Palette, isDynamo?: boolean) => css`\n\tdisplay: flex;\n\tflex-direction: row;\n\t${textSans.xxsmall({ lineHeight: 'tight' })};\n\tmargin-top: -4px;\n\tpadding-left: 5px;\n\tpadding-right: 5px;\n\tcolor: ${isDynamo ? palette.text.dynamoHeadline : palette.text.cardFooter};\n`;\n\nconst svgStyles = (palette: Palette, isDynamo?: boolean) => css`\n\tsvg {\n\t\tmargin-bottom: -5px;\n\t\theight: 14px;\n\t\twidth: 14px;\n\t\tmargin-right: 2px;\n\t\tfill: ${isDynamo\n\t\t\t? palette.text.dynamoHeadline\n\t\t\t: palette.text.cardFooter};\n\t}\n`;\n\nconst longStyles = css`\n\tdisplay: block;\n\n\t${between.leftCol.and.wide} {\n\t\tdisplay: none;\n\t}\n`;\n\nconst shortStyles = css`\n\tdisplay: none;\n\n\t${between.leftCol.and.wide} {\n\t\tdisplay: block;\n\t}\n`;\n\nexport const CardCommentCount = ({\n\tcontainerPalette,\n\tformat,\n\tshort,\n\tlong,\n\tisDynamo,\n}: Props) => {\n\tconst palette = decidePalette(format, containerPalette);\n\treturn (\n\t\t<div css={containerStyles(palette, isDynamo)}>\n\t\t\t<div css={svgStyles(palette, isDynamo)}>\n\t\t\t\t<CommentIcon />\n\t\t\t</div>\n\t\t\t<div css={longStyles} aria-hidden=\"true\">\n\t\t\t\t{long}\n\t\t\t</div>\n\t\t\t<div css={shortStyles} aria-hidden=\"true\">\n\t\t\t\t{short}\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n","import { CacheProvider } from '@emotion/react';\nimport { useEffect, useState } from 'react';\nimport { createRoot } from 'react-dom/client';\nimport type { DCRContainerPalette } from '../../types/front';\nimport { getEmotionCache } from '../browser/islands/emotion';\nimport { formatCount } from '../lib/formatCount';\nimport { useApi } from '../lib/useApi';\nimport { CardCommentCount } from './CardCommentCount';\n\ntype Props = {\n\trepeat?: boolean;\n};\n\ntype MarkerType = {\n\tdiscussionId: string;\n\tformat: ArticleFormat;\n\tisDynamo?: true;\n\tcontainerPalette?: string;\n};\n\ntype RawCountType = {\n\tid: string;\n\tcount: number;\n};\n\ntype EnhancedCountType = {\n\tid: string;\n\tlong: string;\n\tshort: string;\n\tformat: ArticleFormat;\n\tisDynamo?: true;\n\tcontainerPalette?: DCRContainerPalette;\n};\n\n/**\n * @description\n * Reads the dom looking for markers that contain the information needed to render the\n * count\n */\nfunction extractMarkers() {\n\tconst markers: MarkerType[] = [];\n\tdocument\n\t\t.querySelectorAll('[data-discussion-id]')\n\t\t.forEach((element: Element) => {\n\t\t\tif (element instanceof HTMLElement) {\n\t\t\t\ttry {\n\t\t\t\t\tconst { discussionId, format, isDynamo, containerPalette } =\n\t\t\t\t\t\telement.dataset;\n\t\t\t\t\tif (discussionId && format) {\n\t\t\t\t\t\tmarkers.push({\n\t\t\t\t\t\t\tdiscussionId,\n\t\t\t\t\t\t\tformat: JSON.parse(format),\n\t\t\t\t\t\t\tisDynamo: isDynamo ? true : undefined,\n\t\t\t\t\t\t\tcontainerPalette,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t\t// Do nothing\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\treturn markers;\n}\n\n/**\n * @description\n * Creates the url used to fetch the count data\n */\nfunction buildUrl(markers: MarkerType[]) {\n\tconst discussionIds = markers.flatMap((marker) => marker.discussionId); // E.g.: ['/p/3pm9v', '/p/4k83z', '/p/6bnba']\n\treturn `https://api.nextgen.guardianapps.co.uk/discussion/comment-counts.json?shortUrls=${discussionIds.join(\n\t\t',',\n\t)}`;\n}\n\n/**\n * @description\n * Converts the count number into a formatted string and parses the stringified\n * format\n *\n * E.g.:\n *   - The 'long' version of 12345 is 12,345\n *   - The 'short' version of 12345 is 12k\n */\nfunction enhanceCounts(\n\tcounts: RawCountType[],\n\tmarkers: MarkerType[],\n): EnhancedCountType[] {\n\treturn counts.map(({ count, id }) => {\n\t\tconst { long, short } = formatCount(count);\n\t\tconst thisMarker = markers.find((marker) => marker.discussionId === id);\n\t\t// We don't get format in the api response so look it up in the array\n\t\t// of DOM markers\n\t\tconst format = thisMarker?.format as ArticleFormat;\n\t\tconst isDynamo = thisMarker?.isDynamo;\n\t\tconst containerPalette =\n\t\t\tthisMarker?.containerPalette as DCRContainerPalette;\n\t\treturn {\n\t\t\tid,\n\t\t\tlong,\n\t\t\tshort,\n\t\t\tformat,\n\t\t\tisDynamo,\n\t\t\tcontainerPalette,\n\t\t};\n\t});\n}\n\n/**\n * @description\n * Takes the long and short version of each count and renders onto the page with react\n */\nfunction renderCounts(counts: EnhancedCountType[]) {\n\tcounts.forEach((count) => {\n\t\tconst container = document.querySelector(\n\t\t\t`[data-discussion-id=\"${count.id}\"]`,\n\t\t);\n\n\t\tif (container) {\n\t\t\tconst root = createRoot(container);\n\t\t\troot.render(\n\t\t\t\t<CacheProvider value={getEmotionCache()}>\n\t\t\t\t\t<CardCommentCount\n\t\t\t\t\t\tformat={count.format}\n\t\t\t\t\t\tshort={count.short}\n\t\t\t\t\t\tlong={count.long}\n\t\t\t\t\t\tisDynamo={count.isDynamo}\n\t\t\t\t\t\tcontainerPalette={count.containerPalette}\n\t\t\t\t\t/>\n\t\t\t\t</CacheProvider>,\n\t\t\t);\n\n\t\t\tcontainer.setAttribute('aria-label', `${count.short} Comments`);\n\t\t}\n\t});\n}\n\n/**\n * @description\n * Makes an api call to fetch the comment counts for all Cards on the page\n *\n * For each Card with comments found (by looking for a marker element) it:\n *\n * - Fetches the comment count data in a single call to Frontend's discussion API\n * - Enhances the data, transforming the count from a number to formatted strings\n * - Uses react 'render' to add the comment counts to their placeholders\n *\n * We do it this was so that we can make a single call, but still render multiple comment counts\n * Using an individual island for each comment count could be more costly, especially on fronts\n *\n * @param {boolean} repeat If true, the fetch call will be repeated on an interval\n */\nexport const FetchCommentCounts = ({ repeat }: Props) => {\n\tconst [url, setUrl] = useState<string | undefined>();\n\n\tuseEffect(() => {\n\t\tconst markers = extractMarkers();\n\t\tsetUrl(buildUrl(markers));\n\t}, []);\n\n\tuseApi<{\n\t\tcounts: RawCountType[];\n\t}>(url, {\n\t\trefreshInterval: repeat ? 15_000 : 0,\n\t\trefreshWhenHidden: false,\n\t\tonSuccess: (data?: { counts?: RawCountType[] }) => {\n\t\t\t// It's possible the DOM has been mutated and there are new Cards showing\n\t\t\t// so we check again\n\t\t\tconst markers = extractMarkers();\n\t\t\tif (data?.counts) {\n\t\t\t\ttry {\n\t\t\t\t\trenderCounts(enhanceCounts(data.counts, markers));\n\t\t\t\t} catch (e) {\n\t\t\t\t\t// Do nothing\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Make sure the list of discussionIds we fetch counts for is up to date\n\t\t\tsetUrl(buildUrl(markers));\n\t\t},\n\t});\n\n\treturn null;\n};\n","import { css } from '@emotion/react';\nimport {\n\tbetween,\n\tborder,\n\tfrom,\n\tspace,\n\tuntil,\n} from '@guardian/source-foundations';\n\nconst leftWidth = (size: LeftColSize) => {\n\tswitch (size) {\n\t\tcase 'wide': {\n\t\t\treturn css`\n\t\t\t\tpadding-right: 10px;\n\t\t\t\t${until.leftCol} {\n\t\t\t\t\t/* below 1140 */\n\t\t\t\t\tdisplay: none;\n\t\t\t\t}\n\n\t\t\t\t${from.leftCol} {\n\t\t\t\t\t/* above 1140 */\n\t\t\t\t\tflex-basis: 230px;\n\t\t\t\t\tflex-grow: 0;\n\t\t\t\t\tflex-shrink: 0;\n\t\t\t\t}\n\t\t\t`;\n\t\t}\n\t\tcase 'compact':\n\t\tdefault: {\n\t\t\treturn css`\n\t\t\t\tpadding-right: 10px;\n\t\t\t\t${until.leftCol} {\n\t\t\t\t\t/* below 1140 */\n\t\t\t\t\tdisplay: none;\n\t\t\t\t}\n\n\t\t\t\t${between.leftCol.and.wide} {\n\t\t\t\t\t/* above 1140, below 1300 */\n\t\t\t\t\tflex-basis: 151px;\n\t\t\t\t\tflex-grow: 0;\n\t\t\t\t\tflex-shrink: 0;\n\t\t\t\t}\n\n\t\t\t\t${from.wide} {\n\t\t\t\t\t/* above 1300 */\n\t\t\t\t\tflex-basis: 230px;\n\t\t\t\t\tflex-grow: 0;\n\t\t\t\t\tflex-shrink: 0;\n\t\t\t\t}\n\t\t\t`;\n\t\t}\n\t}\n};\n\nconst positionRelative = css`\n\tposition: relative;\n`;\n\nconst partialRightBorder = (colour: string) => css`\n\t:before {\n\t\tcontent: '';\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tbottom: 0;\n\t\tright: 0;\n\t\theight: 30px;\n\t\twidth: 1px;\n\t\tbackground: ${colour};\n\t}\n`;\n\nconst fullRightBorder = (colour: string) => css`\n\tborder-right: 1px solid ${colour};\n`;\n\ntype Props = {\n\tchildren: React.ReactNode;\n\tborderType?: 'full' | 'partial'; // if no borderType provided -> no border\n\tborderColour?: string;\n\tsize?: LeftColSize;\n\tverticalMargins?: boolean;\n};\n\nexport const LeftColumn = ({\n\tchildren,\n\tborderType,\n\tborderColour = border.secondary,\n\tsize = 'compact',\n\tverticalMargins = true,\n}: Props) => {\n\treturn (\n\t\t<section\n\t\t\tcss={[\n\t\t\t\tpositionRelative,\n\t\t\t\tleftWidth(size),\n\t\t\t\tborderType === 'full' && fullRightBorder(borderColour),\n\t\t\t\tverticalMargins &&\n\t\t\t\t\tcss`\n\t\t\t\t\t\t/*\n\t\t\t\t\t\t\tKeep spacing at the bottom of the container consistent at 36px, regardless of\n\t\t\t\t\t\t\tbreakpoint, based on chat with Harry Fisher\n\t\t\t\t\t\t*/\n\t\t\t\t\t\tpadding-bottom: ${space[9]}px;\n\t\t\t\t\t`,\n\t\t\t]}\n\t\t>\n\t\t\t<div\n\t\t\t\tcss={[\n\t\t\t\t\tborderType === 'partial' &&\n\t\t\t\t\t\tpartialRightBorder(borderColour),\n\t\t\t\t\tcss`\n\t\t\t\t\t\theight: 100%;\n\t\t\t\t\t`,\n\t\t\t\t]}\n\t\t\t>\n\t\t\t\t{children}\n\t\t\t</div>\n\t\t</section>\n\t);\n};\n","const integerCommas = (val: number): string => {\n\tconst digits = val.toFixed(0).split('');\n\tconst len = digits.length;\n\n\tfor (let i = digits.length - 1; i >= 1; i -= 1) {\n\t\tif ((len - i) % 3 === 0) {\n\t\t\tdigits.splice(i, 0, ',');\n\t\t}\n\t}\n\n\treturn digits.join('');\n};\n\nexport { integerCommas };\n","import { integerCommas } from '../../lib/formatters';\n\nexport const formatCount = (\n\tcount?: number,\n): { short: string; long: string } => {\n\tif (count === undefined) return { short: '…', long: '…' };\n\tif (count === 0) return { short: '0', long: '0' };\n\n\tconst countAsInteger = parseInt(count.toFixed(0), 10);\n\tconst displayCountLong = integerCommas(countAsInteger);\n\tconst displayCountShort =\n\t\tcountAsInteger > 10000\n\t\t\t? `${Math.round(countAsInteger / 1000)}k`\n\t\t\t: countAsInteger.toString();\n\n\treturn {\n\t\tshort: displayCountShort,\n\t\tlong: displayCountLong,\n\t};\n};\n"],"names":["module","exports","desvg","formatAttrString","input","str","replace","RegExp","removeTempChars","replaceSpacesWithHyphens","toLowerCase","SvgChevronLeftSingle","svg","viewBox","xmlns","width","height","path","fillRule","clipRule","d","SvgChevronRightSingle","isLastCardShowing","index","totalStories","containerMargins","css","from","containerStyles","carouselStyle","until","dotsStyle","space","dotStyle","neutral","dotActiveStyle","palette","background","carouselDot","carouselDotFocus","adjustNumberOfDotsStyle","buttonContainerStyle","getZIndex","prevButtonContainerStyle","format","design","ArticleDesign","nextButtonContainerStyle","buttonStyle","brandAlt","prevButtonStyle","nextButtonStyle","headerRowStyles","headerStyles","headline","fontWeight","text","titleStyle","isCuratedContent","carouselTitle","Title","title","h2","span","CarouselCard","linkTo","imageUrl","headlineText","webPublicationDate","kickerText","isFirst","dataLinkName","discussionId","branding","LI","percentage","showDivider","padSides","padSidesOnMobile","snapAlignStart","Card","imageSize","undefined","showClock","showAge","imagePositionOnMobile","minWidthInPixels","showQuotedHeadline","isExternalLink","HeaderAndNav","heading","trails","goToIndex","div","map","_","i","onClick","aria-hidden","length","data-link-name","Carousel","onwardsSource","decidePalette","carouselRef","useRef","setIndex","useState","maxIndex","setMaxIndex","arrowName","notPresentation","el","getAttribute","getItems","current","Array","children","getSetIndex","offsets","filter","offsetLeft","offset","scrolled","scrollLeft","active","findIndex","Math","max","getIndex","newIndex","scrollTo","left","prev","nextOffset","reverse","find","o","next","currOffset","useEffect","carousel","addEventListener","libDebounce","removeEventListener","m","FetchCommentCounts","LeftColumn","borderType","size","button","type","aria-label","data-component","data-link","Hide","when","breakpoint","ul","ref","trail","url","trailFormat","image","discussion","getSourceImageUrl","isCommentable","isDynamo","textSans","lineHeight","dynamoHeadline","cardFooter","svgStyles","longStyles","between","shortStyles","CardCommentCount","containerPalette","short","long","CommentIcon","extractMarkers","markers","document","querySelectorAll","forEach","element","HTMLElement","dataset","push","JSON","parse","e","buildUrl","discussionIds","flatMap","marker","join","repeat","setUrl","useApi","refreshInterval","refreshWhenHidden","onSuccess","data","counts","count","id","formatCount","thisMarker","enhanceCounts","container","querySelector","createRoot","render","CacheProvider","value","getEmotionCache","setAttribute","leftWidth","positionRelative","partialRightBorder","colour","borderColour","border","verticalMargins","section","countAsInteger","parseInt","toFixed","displayCountLong","val","digits","split","len","splice","integerCommas","round","toString"],"sourceRoot":""}