"use strict";(self.webpackChunk_guardian_dotcom_rendering=self.webpackChunk_guardian_dotcom_rendering||[]).push([[5350],{557:(e,t,r)=>{r.d(t,{W:()=>h});var n=r(126),i=r(7800),a=r(7786),s=r(573),o=r(8357),l=r(894),c=r(7846),d=r(7141),u=r(7555),p=r(7842),m=r(2405),f=r(3904),h=function(e){var t=e.formField,r=e.formData,h=e.setFieldInFormData,x=e.pageId,g=e.validationErrors,b=t.type,v=t.label,y=t.hideLabel,j=t.description,w=t.required,k=t.id,D="field_".concat(b,"_").concat(k),O=t.id in r?r[t.id]:"",S=g[t.id],C=(0,f.useRef)(!0);switch((0,f.useEffect)((function(){C.current&&t.hidden&&"text"===t.type&&(h(t.id,x),C.current=!1)}),[t,x,h]),t.type){case"phone":case"email":case"text":return t.hidden?null:(0,i.jsx)(a.o,{name:D,label:v,hideLabel:y,supporting:j,optional:!w,value:O,error:S,"data-testid":"form-field-".concat(t.id),type:t.type,onChange:function(e){return h(t.id,e.target.value)}});case"textarea":return(0,i.jsx)(s.K,{name:D,label:v,hideLabel:y,supporting:j,optional:!w,value:O,error:S,"data-testid":"form-field-".concat(t.id),onChange:function(e){return h(t.id,e.target.value)}});case"file":return(0,i.jsx)(m.S,{label:v,hideLabel:y,supporting:j,optional:!w,error:S,"data-testid":"form-field-".concat(t.id),onUpload:function(e){return h(t.id,e)}});case"select":return(0,i.jsx)(o.P,{name:D,label:v,hideLabel:y,supporting:j,optional:!w,value:O,error:S,"data-testid":"form-field-".concat(t.id),onChange:function(e){return h(t.id,e.target.value)},children:[{value:"default",label:"Please choose an option"}].concat(t.options).map((function(e){var t=e.value,r=e.label;return(0,i.jsx)(l.W,{value:t,children:r},t)}))});case"checkbox":return(0,i.jsx)(c.c,{name:D,label:v,hideLabel:y,supporting:j,optional:!w,error:S||void 0,"data-testid":"form-field-".concat(t.id),children:t.options.map((function(e){var a,s=null!==(a=r[t.id])&&void 0!==a?a:[],o=!!s.find((function(t){return t===e.value}));return(0,i.jsx)(d.X,{name:D,label:e.label,value:e.value,checked:o,error:!!S,"data-testid":"form-field-".concat(e.value),onChange:function(){return h(k,o?s.filter((function(t){return t!==e.value})):[].concat((0,n.Z)(s),[e.value]))}},e.value)}))});case"radio":return(0,i.jsx)(u.E,{label:t.label,supporting:t.description,error:g[t.id],name:t.name,orientation:t.options.length>2?"vertical":"horizontal",children:t.options.map((function(e,n){return(0,i.jsx)(p.Y,{"data-testid":"form-field-".concat(e.value),label:e.label,value:e.value,name:"".concat(t.id),checked:t.id in r&&r[t.id]===e.value,onChange:function(e){return h(t.id,e.target.value)}},n)}))});default:return null}}},1406:(e,t,r)=>{r.r(t),r.d(t,{CalloutBlockComponent:()=>xe});var n=r(7800),i=r(43),a=r(2522),s=r(8945),o=r(5809),l=r(2933),c=r(7162),d=r(9525),u=r(2399),p=r(3904),m=r(7791),f=r(824),h=r.n(f),x=r(3046),g=r(3965),b=r(7709),v=r(5578),y="#12121240",j=(0,i.css)("a{color:",d.UQ[500],";text-decoration:none;border-bottom:1px solid ",y,";}a:hover,a:active{border-bottom:1px solid ",d.UQ[500],";}"),w=function(e){return(0,i.css)(!e&&j," padding-bottom:",l.D[4],"px;",c.d1.medium()," p{margin-bottom:",l.D[3],"px;}")},k=function(e){var t=e.description,r=e.useBrandColour,i=t.split("href").join('data-ignore="global-link-styling" href');return(0,n.jsxs)("div",{css:w(r),children:[(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:r?t:i}}),(0,n.jsxs)("div",{children:["Please share your story if you are 18 or over, anonymously if you wish. For more information please see our"," ",(0,n.jsx)("a",{"data-ignore":!r&&"global-link-styling",href:"https://www.theguardian.com/help/terms-of-service",children:"terms of service"})," ","and"," ",(0,n.jsx)("a",{"data-ignore":!r&&"global-link-styling",href:"https://www.theguardian.com/help/privacy-policy",children:"privacy policy"}),"."]})]})},D=(0,i.css)(c.OS.small(),";color:",a.DG.brand,";background-color:",a.DG.brandAlt[400],";width:fit-content;"),O=function(){return(0,n.jsxs)("div",{css:D,children:[(0,n.jsx)("p",{children:"This callout is now closed to any further submissions."}),(0,n.jsxs)("p",{children:["You can see"," ",(0,n.jsx)("a",{href:"https://www.theguardian.com/profile/guardian-community-team",children:"other Guardian community callouts here"})," ","or"," ",(0,n.jsx)("a",{href:"https://www.theguardian.com/community/2015/sep/02/guardianwitness-send-us-a-story",children:"tell us about a story here."})]})]})},S={name:"1dbubah",styles:"display:flex;align-items:center;position:relative"},C=(0,i.css)(c.OS.xsmall(),";"),P=function(e,t){return(0,i.css)(c.OS.xsmall()," color:",e?t.text.articleLink:d.UQ[500],";border-bottom:1px solid ",y,";text-decoration:none;transition:none;:hover,:active{border-bottom:1px solid ",e?t.border.articleLinkHover:d.UQ[500],";}")},F=(0,i.css)(c.OS.xsmall(),";position:absolute;display:flex;align-items:center;min-width:180px;transform:translate(100%, 0);background-color:",d.n$[100],";color:",d.n$[7],";font-weight:normal;border-radius:",l.D[1],"px;z-index:1;padding:0 ",l.D[1],"px 0 0;box-shadow:0px 2px ",l.D[2],"px rgba(0, 0, 0, 0.5);>svg{fill:",d.Vp[400],";}"),I=function(e,t){return(0,i.css)("display:inline-flex;margin-right:",l.D[2],"px;border-radius:50%;border:1px solid ",e?t.text.articleLink:d.UQ[500],";box-sizing:border-box;fill:",e?t.text.articleLink:d.UQ[500],";padding:0.5px 0;")},L=function(e){var t=e.title,r=e.urlAnchor,i=e.useBrandColour,a=e.format,s=(0,p.useState)(!1),l=(0,o.Z)(s,2),c=l[0],d=l[1],u=(0,v.b)(a),f=function(){var e=(0,m.Z)(h().mark((function e(){var n,i,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.location.href,!("share"in navigator)||!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){e.next=11;break}return i="Share your experience",t&&(i+=": ".concat(t)),a="\n\t\t\tI saw this callout in an article: ".concat(n,"#").concat(r,"\n\t\t\tYou can share your story by using the form on this article, or by contacting the Guardian on WhatsApp, Signal or Telegram."),e.next=7,navigator.share({title:i,text:a});case 7:d(!0),setTimeout((function(){return d(!1)}),3e3),e.next=16;break;case 11:if(!("clipboard"in navigator)){e.next=16;break}return e.next=14,navigator.clipboard.writeText("".concat(n,"#").concat(r));case 14:d(!0),setTimeout((function(){return d(!1)}),3e3);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return"undefined"==typeof window||"undefined"==typeof navigator?(0,n.jsx)(n.Fragment,{}):(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{css:S,children:[(0,n.jsx)("span",{css:I(i,u),children:(0,n.jsx)(x.m,{size:"small"})}),(0,n.jsxs)("div",{css:C,children:["Know others who are affected?"," ",(0,n.jsx)(g.z,{size:"xsmall",priority:"subdued",onClick:f,cssOverrides:P(i,u),children:"Please share this callout."}),c&&(0,n.jsxs)("span",{css:F,role:"alert",children:[(0,n.jsx)(b.X,{size:"medium"}),"Link copied to clipboard"]})]})]})})},T=(0,i.css)(j," ",c.OS.small()," padding-bottom:",l.D[4],"px;"),U=function(){return(0,n.jsxs)("div",{css:T,children:["Your responses, which can be anonymous, are secure as the form is encrypted and only the Guardian has access to your contributions. We will only use the data you provide us for the purpose of the feature and we will delete any personal data when we no longer require it for this purpose. For true anonymity please use our"," ",(0,n.jsx)("a",{"data-ignore":"global-link-styling",href:"https://www.theguardian.com/securedrop",children:"SecureDrop"})," ","service instead."]})},Z=r(4649),E=r(2297),z=r(557);function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach((function(t){(0,Z.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var M=(0,i.css)(c.OS.xsmall(),";padding-bottom:16px;"),W=(0,i.css)(c.OS.xsmall(),";padding-bottom:44px;"),B=(0,i.css)("fill:",d.Vp[400],";width:48px;"),G=(0,i.css)("color:",a.DG.error[400],";",c.OS.medium({fontWeight:"bold"}),";display:flex;"),Q={name:"1vgoj7v",styles:"display:flex;flex-direction:column;justify-content:space-between"},q={name:"1t2yr3r",styles:"margin:20px 0px;width:100%;display:block"},N=(0,i.css)("display:flex;flex-direction:row;justify-content:space-between;padding-bottom:",l.D[4],"px;"),R={name:"fw448z",styles:"position:absolute;left:-62.5rem"},H=function(e){var t=e.formFields,r=e.submissionURL,a=e.formID,s=e.pageId,d=(0,p.useState)({}),u=(0,o.Z)(d,2),f=u[0],x=u[1],v=(0,p.useState)({}),y=(0,o.Z)(v,2),j=y[0],w=y[1],k=(0,p.useState)(""),D=(0,o.Z)(k,2),O=D[0],S=D[1],C=(0,p.useState)(!1),P=(0,o.Z)(C,2),F=P[0],I=P[1],L=(0,p.useState)(""),T=(0,o.Z)(L,2),A=T[0],H=T[1],Y=function(e,t){var r=j;r[e]="",w(r),x(_(_({},f),{},(0,Z.Z)({},e,t)))},$=function(){var e=(0,m.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S(""),!f.twitterHandle){e.next=4;break}return S("Sorry we think you are a robot."),e.abrupt("return");case 4:return n=Object.keys(f).reduce((function(e,r){return _(_({},e),{},(0,Z.Z)({},"field_".concat(r),(n=t[r],Array.isArray(n)?n.join("\n"):n)));var n}),{}),e.abrupt("return",fetch(r,{method:"POST",body:JSON.stringify(_({formId:a},n)),headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then((function(e){201===e.status?I(!0):S("Sorry, there was a problem submitting your form. Please try again later.")})).catch((function(e){window.guardian.modules.sentry.reportError(e,"callout-embed-submission"),S("Sorry, there was a problem submitting your form. Please try again later.")})));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return F?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{css:B,children:(0,n.jsx)(b.X,{})}),(0,n.jsx)("div",{css:(0,i.css)(c.Se.xxsmall({fontWeight:"bold"}),";"),children:"Thank you!"}),(0,n.jsx)("div",{css:W,children:"Your story has been submitted successfully. One of our journalists will be in touch if we wish to take your submission further."})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(U,{}),(0,n.jsxs)("form",{action:"/formstack-campaign/submit",method:"post",css:Q,noValidate:!0,onSubmit:function(e){var r,n;e.preventDefault(),r={},n=!0,t.forEach((function(e){return e.required&&!f[e.id]&&(r[e.id]="This field is required",n=!1),"select"===e.type&&e.required&&"Please choose an option"===f[e.id]&&(r[e.id]="Please choose an option from the dropdown menu"),"email"===e.id&&f[e.id]&&(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(f[e.id])||(r[e.id]="Please enter a valid email address",n=!1)),["number","phone"].includes(e.type)&&f[e.id]&&(/^[\d ()+-]+$/.test(f[e.id])||(r[e.id]="Please enter a valid number",n=!1),f[e.id].length<10&&(r[e.id]="Please include your dialling/area code",n=!1)),n})),w(r),0===Object.keys(r).length?$(f):document.querySelectorAll(":invalid")[1].focus()},children:[Object.values(j).filter((function(e){return""!==e})).length>0&&(0,n.jsx)(E.X,{message:"Some information is missing.",context:"Please complete all required fields.",cssOverrides:(0,i.css)("width:fit-content;width:100%;margin-bottom:",l.D[4],"px;")}),t.map((function(e){return(0,n.jsx)("div",{css:(t=!!e.hidden,(0,i.css)("display:flex;flex-direction:column;margin-bottom:",t?0:l.D[4],"px;")),children:(0,n.jsx)(z.W,{formField:e,formData:f,setFieldInFormData:Y,validationErrors:j,pageId:s})},e.id);var t})),(0,n.jsx)("div",{css:M,children:"By submitting your response, you are agreeing to share your details with us for this feature."}),(0,n.jsx)("div",{css:R,"aria-hidden":"true",children:(0,n.jsx)("input",{name:"twitter-handle",type:"text",id:"twitter-handle",tabIndex:-1,placeholder:"@mytwitterhandle",value:A,onChange:function(e){return H(e.target.value)}})}),!!O&&(0,n.jsx)("div",{css:G,children:O}),(0,n.jsx)("div",{css:N,children:(0,n.jsx)(g.z,{priority:"primary",type:"submit",cssOverrides:q,children:"Submit"})})]})]})},Y=r(126),$=r(8918),X=r(3858),V=r(7660),J=r(2990),K=(0,i.css)("width:100%;justify-content:center;margin-top:",l.D[4],"px;:last-of-type{margin-bottom:",l.D[6],"px;}"),ee=(0,i.css)(j," margin-bottom:",l.D[2],"px;",c.OS.xsmall(),";"),te=function(e){return"whatsapp"===e.toLowerCase()?"WhatsApp":e.charAt(0).toUpperCase()+e.slice(1)},re=function(e){switch(e.toLowerCase()){case"whatsapp":return(0,n.jsx)($.H,{size:"small"});case"signal":return(0,n.jsx)(X.r,{size:"small"});case"telegram":return(0,n.jsx)(V.J,{size:"small"});default:return(0,n.jsx)(n.Fragment,{})}},ne=function(e){var t=new Map;return e.forEach((function(e){var r,n=e.name,i=e.value;t.has(i)||t.set(i,[]),null===(r=t.get(i))||void 0===r||r.push(n)})),(0,Y.Z)(t.entries()).reduce((function(e,t,r){var n=(0,o.Z)(t,2),i=n[0],a=n[1].map((function(e){return te(e)})).join(" or ");return e+(0===r?"":" or ")+"".concat(a," at ").concat(i)}),"Contact us on ")},ie=function(e){var t=e.contacts,r=(0,n.jsxs)("p",{css:ee,children:[ne(t),"."]}),i=(0,n.jsxs)("span",{children:["For more information, please see our guidance on"," ",t.map((function(e,r){return e.guidance&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("a",{href:e.guidance,"data-ignore":"global-link-styling",children:["contacting us via"," ",te(e.name)]},r),r===t.length-1?".":", "]})}))]}),a=(0,n.jsxs)("span",{children:["For true anonymity please use our"," ",(0,n.jsx)("a",{href:"https://www.theguardian.com/securedrop","data-ignore":"global-link-styling",children:"SecureDrop"})," ","service instead."]});return(0,n.jsxs)(n.Fragment,{children:[r,(0,n.jsxs)("p",{css:ee,children:[t.some((function(e){return!!e.guidance}))&&i," ",a]})]})},ae=function(e){var t=e.contacts;return(0,n.jsxs)("div",{className:"js-message-us-tab",children:[(0,n.jsx)(ie,{contacts:t}),t.map((function(e,t){return e.urlPrefix&&e.value?(0,n.jsxs)(J.Q,{"data-ignore":"global-link-styling",css:K,type:"submit",priority:"primary",href:"".concat(e.urlPrefix).concat(e.value),target:"_blank",rel:"noreferrer",icon:re(e.name),children:["Message us on ",te(e.name)]},t):(0,n.jsx)(n.Fragment,{})}))]})},se=function(e){return(0,i.css)("visibility:visible;padding-top:2px;padding-bottom:",l.D[6],"px;padding-left:",e?0:l.D[2],"px;padding-right:",e?0:l.D[2],"px;")},oe=function(e){return(0,i.css)(c.Se.xxsmall({fontWeight:"bold"}),";color:",e?d.n$[7]:d.UQ[500],";")},le=(0,i.css)(c.Se.xxsmall()," padding-bottom:",l.D[3],"px;"),ce={name:"1wma2ru",styles:"display:flex;flex-wrap:wrap;align-items:center;justify-content:center"},de=(0,i.css)("padding-left:",l.D[1],"px;display:flex;align-items:center;"),ue=function(e){var t=e.prompt,r=e.heading,i=e.description,a=e.formFields,s=e.formId,l=e.submissionURL,c=e.isNonCollapsible,d=e.contacts,m=e.pageId,f=e.format,h=(0,p.useState)("form"),x=(0,o.Z)(h,2),g=x[0],b=x[1],v=d&&d.length>0,y=!!r&&!c,j=[{id:"form",text:(0,n.jsx)("div",{children:"Tell us here"}),content:(0,n.jsx)(H,{formFields:a,submissionURL:l,formID:s,pageId:m})}];if(v){var w=(0,n.jsxs)("div",{css:ce,children:[(0,n.jsx)("div",{children:"Message us"}),(0,n.jsx)("div",{css:de,children:d.map((function(e){return re(e.name)}))})]});j.push({id:"contact",text:w,content:(0,n.jsx)(ae,{contacts:d})})}return(0,n.jsxs)("div",{id:s,children:[(0,n.jsxs)("div",{css:se(c),children:[!!t&&(0,n.jsx)("div",{css:oe(c),children:t}),y&&(0,n.jsx)("h4",{css:le,children:r}),!!i&&(0,n.jsx)(k,{description:i,useBrandColour:c}),(0,n.jsx)(L,{title:r,urlAnchor:s,useBrandColour:c,format:f})]}),(0,n.jsx)(u.m,{tabsLabel:"Tell us via online form or message us using your phone",tabElement:"button",tabs:j,selectedTab:g,onTabChange:function(e){b(e)}})]})},pe=r(4365),me=(0,i.css)(c.OS.xxsmall(),";background-color:",a.DG.brandAlt[400],";right:0;display:flex;align-items:center;padding-right:",l.D[1],"px;"),fe=function(e){var t=function(e){if(void 0!==e)return new Date(1e3*e)}(e.until);if(!t)return null;var r=function(e,t){var r,n=(r=e,(t.getTime()-r.getTime())/864e5);if(!(n<=0||n>7))return n<=1?"Closing today":1===Math.round(n)?"Open for 1 more day":"Open for ".concat(Math.round(n)," more days")}(new Date,t);return r?(0,n.jsxs)("span",{css:me,children:[(0,n.jsx)(pe.h,{size:"xsmall"}),r]}):null},he=(0,i.css)("background-color:",a.DG.neutral[97],";"),xe=function(e){var t=e.callout,r=e.pageId,i=e.format,a=t.prompt,o=t.title,l=t.description,c=t.formFields,d=t.activeUntil,u=t.calloutsUrl,p=t.formId,m=t.isNonCollapsible,f=t.contacts,h=function(e){return void 0!==e&&Math.floor((new Date).getTime()/1e3)>e};if(!m&&h(d))return null;if(m&&h(d))return(0,n.jsx)(O,{});var x=p.toString();return(0,n.jsx)(n.Fragment,{children:m?(0,n.jsx)(ue,{formId:x,prompt:a,heading:o,description:l,formFields:c,submissionURL:u,isExpired:h(d),isNonCollapsible:m,contacts:f,pageId:r,format:i}):(0,n.jsx)("aside",{children:(0,n.jsx)(s.C,{name:"".concat(t.formId," form"),renderExtra:function(){return(0,n.jsx)(fe,{until:d})},collapsedHeight:"160px",children:(0,n.jsx)("div",{css:he,children:(0,n.jsx)(ue,{formId:x,prompt:a,heading:o,description:l,formFields:c,submissionURL:u,isExpired:h(d),isNonCollapsible:m,contacts:f,pageId:r,format:i})})})})})}}}]);
//# sourceMappingURL=CalloutBlockComponent-importable.legacy.79e6e3bf5940958d4ce4.js.map