(self.webpackChunk_guardian_dotcom_rendering=self.webpackChunk_guardian_dotcom_rendering||[]).push([[4527],{9123:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var r=function(e){return Object.keys(e).map((function(t){var n=e[t],r=Array.isArray(n)?n.map((function(e){return encodeURIComponent(e)})).join(","):encodeURIComponent(n);return"".concat(t,"=").concat(r)})).join("&")}},854:(e,t,n)=>{"use strict";n.d(t,{Gm:()=>c,NX:()=>s,dw:()=>f});var r=n(4649);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var a="undefined"==typeof window?void 0:window.guardian.ophan,u=function(e){null==a||a.record({componentEvent:e})},c=function(e){return u(i(i({},e),{},{action:"VIEW"}))},s=function(){return{componentType:"SIGN_IN_GATE",id:arguments.length>0&&void 0!==arguments[0]?arguments[0]:""}},f=function(e,t,n){var r=s(e);u(i(i({},{component:r,abTest:n,value:t}),{},{action:"CLICK"}))}},3336:(e,t,n)=>{"use strict";n.r(t),n.d(t,{SignInGateSelector:()=>T});var r,o=n(5809),i=n(7800),a=n(4857),u=n(7791),c=n(824),s=n.n(c),f=function(e){return"boolean"==typeof e},d=n(2604),l=function(){var e=(0,u.Z)(s().mark((function e(){var t,n,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=r,e.t0){e.next=10;break}if(null===(t=null===(n=window.guardian)||void 0===n||null===(o=n.config)||void 0===o?void 0:o.switches)||void 0===t){e.next=6;break}e.t1=t,e.next=9;break;case 6:return e.next=8,fetch("https://www.theguardian.com/switches.json").then((function(e){return e.json()})).then((function(e){return function(e){return(0,d.K)(e)&&Object.values(e).every(f)}(e)?e:Promise.reject(new Error("Error getting remote switches â€“ config is malformed"))}));case 8:e.t1=e.sent;case 9:e.t0=r=e.t1;case 10:return e.abrupt("return",e.t0);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=n(3904),p=n(9123),m=["new","guest","current"],g=function(e){return m.includes(e)},h=["Contribution","SupporterPlus","Paper","GuardianWeekly"],w=function(e){return h.includes(e)};function b(e){return(0,d.K)(e)&&g(e.userType)&&w(e.product)}var y=n(3287),I=n(9154),O=n(854),S=n(8574),j=n(2774),C=function(e){var t=e.abTest,n=e.componentId,r=e.setShowGate,o=e.signInUrl,a=e.gateVariant,u=e.host,c=e.checkoutCompleteCookieData,s=e.personaliseSignInGateAfterCheckoutSwitch;return(0,v.useEffect)((function(){(0,O.Gm)({component:(0,O.NX)(n),abTest:t})}),[t,n]),a.gate?a.gate({guUrl:u,signInUrl:o,dismissGate:function(){!function(e,t){e(!1),(0,S.oG)(t.variant,t.name),(0,S.ne)(t.variant,t.name)}(r,t)},abTest:t,ophanComponentId:n,checkoutCompleteCookieData:c,personaliseSignInGateAfterCheckoutSwitch:s}):(0,i.jsx)(i.Fragment,{})},T=function(e){var t=e.format,n=e.contentType,r=e.sectionName,u=void 0===r?"":r,c=e.tags,s=e.isPaidContent,f=e.isPreview,d=e.host,m=void 0===d?"https://theguardian.com/":d,g=e.pageId,h=e.idUrl,w=void 0===h?"https://profile.theguardian.com":h,O=!!(0,a.e)({name:"GU_U",shouldMemoize:!0}),S=(0,v.useState)(void 0),T=(0,o.Z)(S,2),E=T[0],k=T[1],G=(0,v.useState)(void 0),P=(0,o.Z)(G,2),x=P[0],U=P[1],_=(0,v.useState)(void 0),N=(0,o.Z)(_,2),A=N[0],Z=N[1],D=(0,v.useState)(!1),M=(0,o.Z)(D,2),V=M[0],R=M[1],K=(0,I.C)(),W=window.guardian.config.ophan.pageViewId,$=(0,v.useState)(!1),z=(0,o.Z)($,2),F=z[0],J=z[1],L=(0,a.e)({name:"GU_CO_COMPLETE",shouldMemoize:!0}),X=null!==L?function(e){if(decodeURIComponent(e)!==e){var t,n=(t=b,function(e){try{var n=JSON.parse(e);return t(n)?{parsed:n,hasError:!1}:{hasError:!0}}catch(e){return{hasError:!0}}})(decodeURIComponent(e));return n.hasError?void 0:n.parsed}}(L):void 0;if((0,y.t)((function(){E&&document.dispatchEvent(new CustomEvent("article:sign-in-gate-dismissed"))}),[E]),(0,y.t)((function(){var e=(0,o.Z)(K,2),t=e[0],n=e[1];t&&n&&(U(t),Z(n))}),[K]),(0,y.t)((function(){l().then((function(e){e.personaliseSignInGateAfterCheckout?J(e.personaliseSignInGateAfterCheckout):J(!1)}))}),[]),(0,v.useEffect)((function(){x&&A&&x.canShow({isSignedIn:!!O,currentTest:A,contentType:n,sectionName:u,tags:c,isPaidContent:s,isPreview:f}).then(R)}),[A,x,O,n,u,c,s,f]),!A||!x)return null;var H=j.fK[A.id],q=F&&X?function(e){if(e){if(!X)return e;var t=X.userType,n=X.product;return"".concat(e,"_personalised_").concat(t,"_").concat(n)}}(H):H,B=function(e){var t,n,r=e.pageId,o=e.pageViewId,i=e.idUrl,u=e.currentTest,c=e.componentId,s="".concat(e.host,"/").concat(r),f={componentType:"signingate",componentId:c,abTestName:u.name,abTestVariant:u.variant,browserId:null!==(t=(0,a.e)({name:"bwid",shouldMemoize:!0}))&&void 0!==t?t:void 0,visitId:null!==(n=(0,a.e)({name:"vsid"}))&&void 0!==n?n:void 0,viewId:o};return"".concat(i,"/signin?returnUrl=").concat(s,"&componentEventParams=").concat(encodeURIComponent((0,p.A)(f)))}({pageId:g,host:m,pageViewId:W,idUrl:w,currentTest:A,componentId:q});return(0,i.jsx)(i.Fragment,{children:!E&&V&&!!q&&(0,i.jsx)(C,{format:t,abTest:A,componentId:q,setShowGate:function(e){return k(!e)},signInUrl:B,gateVariant:x,host:m,checkoutCompleteCookieData:X,personaliseSignInGateAfterCheckoutSwitch:F})})}},2460:(e,t,n)=>{"use strict";n.d(t,{HN:()=>a,lu:()=>o,x2:()=>i});var r="gu.history.dailyArticleCount",o=function(){var e=localStorage.getItem(r);if(e)try{var t=JSON.parse(e).value;if(!t.length)throw new Error("Invalid gu.history.dailyArticleCount value");return t}catch(e){return void localStorage.removeItem(r)}},i=function(){return Math.floor(Date.now()/864e5)},a=function(){var e,t,n=null!==(e=o())&&void 0!==e?e:[],a=i();if((null===(t=n[0])||void 0===t?void 0:t.day)===a)n[0].count+=1;else{n.unshift({day:a,count:1});var u=a-60,c=n.findIndex((function(e){return e.day&&e.day<u}));c>0&&n.splice(c)}localStorage.setItem(r,JSON.stringify({value:n}))}},9213:(e,t,n)=>{"use strict";n.d(t,{O:()=>u});var r=n(5809),o=n(3198),i=n.n(o),a=n(3904),u=function(e){var t,n=(0,a.useState)(!1),o=(0,r.Z)(n,2),u=o[0],c=o[1],s=(0,a.useState)(null!==(t=e.node)&&void 0!==t?t:null),f=(0,r.Z)(s,2),d=f[0],l=f[1],v=(0,a.useRef)(null),p=function(t){var n=(0,r.Z)(t,1)[0];n&&(n.isIntersecting?c(!0):e.repeat&&c(!1))},m=e.debounce?i()(p,200):p;return(0,a.useEffect)((function(){return v.current&&v.current.disconnect(),window.IntersectionObserver&&(v.current=new window.IntersectionObserver(m,e),d&&v.current.observe(d)),function(){var e;return null===(e=v.current)||void 0===e?void 0:e.disconnect()}}),[d,e,m]),[u,l]}},3287:(e,t,n)=>{"use strict";n.d(t,{t:()=>i});var r=n(5809),o=n(3904),i=function(e,t){var n=(0,o.useState)(!1),i=(0,r.Z)(n,2),a=i[0],u=i[1],c=t.every((function(e){return void 0!==e}));(0,o.useEffect)((function(){!a&&c&&(e(),u(!0))}),[a,c,e])}},3198:(e,t,n)=>{var r=NaN,o="[object Symbol]",i=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,c=/^0o[0-7]+$/i,s=parseInt,f="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,d="object"==typeof self&&self&&self.Object===Object&&self,l=f||d||Function("return this")(),v=Object.prototype.toString,p=Math.max,m=Math.min,g=function(){return l.Date.now()};function h(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function w(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&v.call(e)==o}(e))return r;if(h(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=h(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var n=u.test(e);return n||c.test(e)?s(e.slice(2),n?2:8):a.test(e)?r:+e}e.exports=function(e,t,n){var r,o,i,a,u,c,s=0,f=!1,d=!1,l=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function v(t){var n=r,i=o;return r=o=void 0,s=t,a=e.apply(i,n)}function b(e){var n=e-c;return void 0===c||n>=t||n<0||d&&e-s>=i}function y(){var e=g();if(b(e))return I(e);u=setTimeout(y,function(e){var n=t-(e-c);return d?m(n,i-(e-s)):n}(e))}function I(e){return u=void 0,l&&r?v(e):(r=o=void 0,a)}function O(){var e=g(),n=b(e);if(r=arguments,o=this,c=e,n){if(void 0===u)return function(e){return s=e,u=setTimeout(y,t),f?v(e):a}(c);if(d)return u=setTimeout(y,t),v(c)}return void 0===u&&(u=setTimeout(y,t)),a}return t=w(t)||0,h(n)&&(f=!!n.leading,i=(d="maxWait"in n)?p(w(n.maxWait)||0,t):i,l="trailing"in n?!!n.trailing:l),O.cancel=function(){void 0!==u&&clearTimeout(u),s=0,r=c=o=u=void 0},O.flush=function(){return void 0===u?a:I(g())},O}}}]);
//# sourceMappingURL=SignInGateSelector-importable.legacy.6eb35ac7787d1eb7864e.js.map