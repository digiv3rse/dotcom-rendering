"use strict";(self.webpackChunk_guardian_dotcom_rendering=self.webpackChunk_guardian_dotcom_rendering||[]).push([[9480],{9365:(n,t,e)=>{e.d(t,{F:()=>r});var s=e(828);const r=(n,t)=>{const e={componentType:"identityauthentication",componentId:n};return t&&(e.viewId=t),"componentEventParams=".concat(encodeURIComponent((0,s.A)(e)))}},828:(n,t,e)=>{e.d(t,{A:()=>s});const s=n=>Object.keys(n).map((t=>{const e=n[t],s=Array.isArray(e)?e.map((n=>encodeURIComponent(n))).join(","):encodeURIComponent(e);return"".concat(t,"=").concat(s)})).join("&")},4525:(n,t,e)=>{e.r(t),e.d(t,{DiscussionContainer:()=>M});var s=e(7800),r=e(1614),o=e(43),i=e(5999),c=e(5726),a=e(7357),u=e(4436),d=e(5158),l=e(498),p=e(3904),m=e(4180);var h=e(8588),f=e(3786),g=e(2188),x=e(9827);function j(n,t){return t||(t=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function v(){const n=j(["\n\tbackground-image: linear-gradient(\n\t\t0deg,\n\t\t",",\n\t\t"," 40%,\n\t\trgba(255, 255, 255, 0)\n\t);\n\theight: 80px;\n\tposition: absolute;\n\tbottom: 0;\n\tright: 0;\n\twidth: 100%;\n\tdisplay: block;\n"]);return v=function(){return n},n}function b(){const n=j(["\n\tmax-height: 280px;\n\tmin-height: 280px;\n\toverflow: hidden;\n"]);return b=function(){return n},n}function y(){const n=j(["\n\tposition: relative;\n"]);return y=function(){return n},n}function C(){const n=j(["\n\t\t\t\t\t\t\t\tpadding-bottom: ","px;\n\t\t\t\t\t\t\t"]);return C=function(){return n},n}const w=(0,o.css)(v(),a.n$[100],a.n$[100]),O=(0,o.css)(b()),S=(0,o.css)(y()),_=n=>{let{format:t,discussionApiUrl:e,shortUrlId:r,discussionD2Uid:a,discussionApiClientHeader:j,enableDiscussionSwitch:v,user:b,idApiUrl:y}=n;const[_,T]=(0,p.useState)(),[P,D]=(0,p.useState)(),[k,I]=(0,p.useState)(),[M,N]=(0,p.useState)(!1),[E,U]=(0,p.useState)((()=>{if("undefined"==typeof window)return;const{hash:n}=window.location;if(!n.includes("comment"))return;const[,t]=n.split("-");return t?parseInt(t,10):void 0})()),{commentCount:z,isClosedForComments:F}=(0,f.D)((0,c.p)(e,"discussion",r)),A=(0,m.b)(t),G="undefined"!=typeof window&&"#comments"===window.location.hash;return(0,p.useEffect)((()=>{void 0!==E&&(async(n,t)=>{const e=(0,c.p)(n,"comment",t.toString(),"context"),s=(()=>{let n,t,e;try{var s,r,o;e=JSON.parse(null!==(s=localStorage.getItem("gu.prefs.discussion.order"))&&void 0!==s?s:"{}"),n=JSON.parse(null!==(r=localStorage.getItem("gu.prefs.discussion.threading"))&&void 0!==r?r:"{}"),t=JSON.parse(null!==(o=localStorage.getItem("gu.prefs.discussion.pagesize"))&&void 0!==o?o:"{}")}catch(n){return{orderBy:"newest",pageSize:25,threads:"collapsed"}}return{orderBy:(null==e?void 0:e.value)?e.value:"newest",threads:(null==n?void 0:n.value)?n.value:"collapsed",pageSize:(null==t?void 0:t.value)?t.value:25}})(),r=new URLSearchParams((n=>({orderBy:"recommendations"===n.orderBy?"mostRecommended":n.orderBy,pageSize:String(n.pageSize),displayThreaded:String("collapsed"===n.threads||"expanded"===n.threads)}))(s));return fetch(e+"?"+r.toString()).then((n=>{if(!n.ok)throw Error(n.statusText||"getCommentContext | An api call returned HTTP status ".concat(n.status));return n})).then((n=>n.json())).catch((n=>{window.guardian.modules.sentry.reportError(n,"get-comment-page")}))})(e,E).then((n=>{T(n.page),D(n.pageSize),I(n.orderBy),N(!0)})).catch((n=>console.error("getCommentContext - error: ".concat(String(n)))))}),[e,E]),(0,p.useEffect)((()=>{G&&N(!0)}),[G]),(0,p.useEffect)((()=>{document.querySelectorAll(".discussion > .pending").forEach((n=>{n.classList.add("reveal"),n.classList.remove("pending")}))}),[]),(0,p.useEffect)((()=>{0!==z&&1!==z&&2!==z||N(!0)}),[z]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{css:[S,h.U,!M&&O],className:"discussion",children:(0,s.jsxs)("div",{className:"pending",children:[(0,s.jsx)(g.c,{when:"above",breakpoint:"leftCol",children:(0,s.jsx)("div",{"data-cy":"discussion",css:(0,o.css)(C(),u.D[2]),children:(0,s.jsx)(x.K,{palette:A,enableDiscussionSwitch:v,user:b,commentCount:z,isClosedForComments:F})})}),(0,s.jsx)(i.g,{user:b,baseUrl:e,pillar:t.theme,initialPage:_,pageSizeOverride:P,isClosedForComments:!!F||!v,orderByOverride:k,shortUrl:r,additionalHeaders:{"D2-X-UID":a,"GU-Client":j},expanded:M,commentToScrollTo:E,onPermalinkClick:n=>("undefined"==typeof window||(window.location.hash="#comment-".concat(n),U(n)),!1),apiKey:"dotcom-rendering",onExpand:()=>{N(!0)},idApiUrl:y}),!M&&(0,s.jsx)("div",{id:"discussion-overlay",css:w})]})}),!M&&(0,s.jsx)(l.o,{format:t,onClick:()=>{N(!0),(()=>{const n=new CustomEvent("comments-expanded");document.dispatchEvent(n)})()},icon:(0,s.jsx)(d.G,{}),children:"View more comments"})]})};var T=e(4466);function P(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}const D=n=>{const{discussionApiUrl:t}=n,{data:e}=(0,T.h)((0,c.p)(t,"profile/me?strict_sanctions_check=false"),{},{credentials:"include"});return e?(0,s.jsx)(_,function(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{},s=Object.keys(e);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(e).filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})))),s.forEach((function(t){P(n,t,e[t])}))}return n}({user:e.userProfile},n)):null};function k(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function I(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{},s=Object.keys(e);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(e).filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})))),s.forEach((function(t){k(n,t,e[t])}))}return n}const M=n=>(0,r.e)({name:"GU_U",shouldMemoize:!0})?(0,s.jsx)(D,I({},n)):(0,s.jsx)(_,I({},n))},2188:(n,t,e)=>{e.d(t,{c:()=>u});var s=e(7800),r=e(43),o=e(1810);function i(n,t){return t||(t=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function c(){const n=i(["\n\t\t\t"," {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t"]);return c=function(){return n},n}function a(){const n=i(["\n\t\t\t"," {\n\t\t\t\tdisplay: none;\n\t\t\t}\n\t\t"]);return a=function(){return n},n}const u=n=>{let t,{children:e,when:i,breakpoint:u,el:d}=n;return t="below"===i?(0,r.css)(c(),o.C4[u]):(0,r.css)(a(),o.Dp[u]),"li"===d?(0,s.jsx)("li",{css:t,children:e}):(0,s.jsx)("span",{css:t,children:e})}},9827:(n,t,e)=>{e.d(t,{K:()=>M});var s=e(7800),r=e(43),o=e(4436),i=e(1810),c=e(3196),a=e(683),u=e(7357),d=e(9365);function l(n,t){return t||(t=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function p(){const n=l(["\n\tpadding-top: ","px;\n\tpadding-bottom: ","px;\n"]);return p=function(){return n},n}function m(){const n=l(["\n\tborder-radius: 70px;\n\twidth: 60px;\n\theight: 60px;\n\t"," {\n\t\twidth: 36px;\n\t\theight: 36px;\n\t}\n"]);return m=function(){return n},n}function h(){const n=l(["\n\tpadding-bottom: ","px;\n\tpadding-right: ","px;\n"]);return h=function(){return n},n}function f(){const n=l(["\n\t",";\n\tpadding-bottom: ","px;\n"]);return f=function(){return n},n}function g(){const n=l(["\n\t","\n\t"," {\n\t\t","\n\t}\n\tcolor: ",";\n\tpadding-bottom: ","px;\n"]);return g=function(){return n},n}function x(){const n=l(["\n\t","\n\tcolor: ",";\n\tpadding-bottom: ","px;\n"]);return x=function(){return n},n}function j(){const n=l(["\n\tfont-weight: 700;\n\tcolor: ",";\n"]);return j=function(){return n},n}function v(){const n=l(["\n\tcolor: ",";\n\ttext-decoration: none;\n\tborder-bottom: 1px solid ",";\n\ttransition: border-color 0.15s ease-out;\n\t:hover {\n\t\tborder-color: ",";\n\t}\n"]);return v=function(){return n},n}function b(){const n=l(["\n\tdisplay: flex;\n\tflex-direction: column;\n\t"," {\n\t\tflex-direction: row;\n\t}\n"]);return b=function(){return n},n}function y(){const n=l(["\n\t\t\t\t\tcolor: ",";\n\t\t\t\t"]);return y=function(){return n},n}const C=(0,r.css)(p(),o.D[1],o.D[1]),w=(0,r.css)(m(),i.C4.desktop),O=(0,r.css)(h(),o.D[1],o.D[2]),S=(0,r.css)(f(),c.Se.xxsmall({fontWeight:"bold"}),o.D[1]),_=(0,r.css)(g(),c.OS.small(),i.C4.desktop,c.OS.xxsmall(),a.fL.supporting,o.D[1]),T=(0,r.css)(x(),c.Se.xxxsmall(),a.fL.supporting,o.D[1]),P=(0,r.css)(j(),a.fL.primary),D=n=>(0,r.css)(v(),n.text.signInLink,a.Cg.secondary,u.r[300]),k=(0,r.css)(b(),i.C4.desktop),I=n=>{let{count:t}=n;return(0,s.jsxs)("h2",{css:S,children:["comments"," ",(0,s.jsxs)("span",{css:(0,r.css)(y(),u.n$[60]),children:["(",null!=t?t:"â€¦",")"]})]})},M=n=>{let{commentCount:t,palette:e,enableDiscussionSwitch:r,user:o,isClosedForComments:i}=n;const c=(null==o?void 0:o.privateFields)&&!o.privateFields.canPostComment;return r?c?(0,s.jsxs)("div",{css:C,children:[(0,s.jsx)(I,{count:t}),(0,s.jsxs)("span",{css:T,children:["Commenting has been disabled for this account (",(0,s.jsx)("a",{href:"https://www.theguardian.com/community-faqs#321a",css:D(e),children:"why?"})," ",")"]})]}):o&&i?(0,s.jsxs)("div",{css:C,children:[(0,s.jsx)(I,{count:t}),(0,s.jsx)("span",{css:T,children:"This discussion is closed for comments"})]}):!o&&i?(0,s.jsxs)("div",{css:C,children:[(0,s.jsx)(I,{count:t}),(0,s.jsxs)("span",{css:T,children:["This discussion is now closed for comments but you can still"," ",(0,s.jsx)("a",{href:"https://profile.theguardian.com/signin?INTCMP=DOTCOM_COMMENTS_SIGNIN&".concat((0,d.F)("signin_to_comment")),css:D(e),children:"sign in"})," ","or"," ",(0,s.jsx)("a",{href:"https://profile.theguardian.com/register?INTCMP=DOTCOM_COMMENTS_REG&".concat((0,d.F)("register_to_comment")),css:D(e),children:"create your Guardian account"})," ","to join the discussion next time"]})]}):o?(0,s.jsxs)("div",{css:C,children:[(0,s.jsx)(I,{count:t}),(0,s.jsxs)("div",{css:k,children:[(0,s.jsx)("div",{css:O,children:(0,s.jsx)("img",{src:o.secureAvatarUrl||"https://avatar.guim.co.uk/no-user-image.gif",alt:o.displayName||"Guardian User",css:w})}),(0,s.jsxs)("div",{css:_,children:["Signed in as",(0,s.jsx)("div",{css:P,children:o.displayName||"Guardian User"})]})]})]}):(0,s.jsxs)("div",{css:C,children:[(0,s.jsx)(I,{count:t}),(0,s.jsxs)("span",{css:T,children:[(0,s.jsx)("a",{href:"https://profile.theguardian.com/signin?INTCMP=DOTCOM_COMMENTS_SIGNIN&".concat((0,d.F)("signin_to_comment")),css:D(e),children:"Sign in"})," ","or"," ",(0,s.jsx)("a",{href:"https://profile.theguardian.com/register?INTCMP=DOTCOM_COMMENTS_REG&".concat((0,d.F)("register_to_comment")),css:D(e),children:"create your Guardian account"})," ","to join the discussion"]})]}):o?(0,s.jsxs)("div",{css:C,children:[(0,s.jsx)(I,{count:t}),(0,s.jsx)("span",{css:T,children:"Commenting has been disabled at this time"})]}):(0,s.jsxs)("div",{css:C,children:[(0,s.jsx)(I,{count:t}),(0,s.jsxs)("span",{css:T,children:["Commenting has been disabled at this time but you can still"," ",(0,s.jsx)("a",{href:"https://profile.theguardian.com/signin?INTCMP=DOTCOM_COMMENTS_SIGNIN&".concat((0,d.F)("signin_to_comment")),css:D(e),children:"sign in"})," ","or"," ",(0,s.jsx)("a",{href:"https://profile.theguardian.com/register?INTCMP=DOTCOM_COMMENTS_REG&".concat((0,d.F)("register_to_comment")),css:D(e),children:"create your Guardian account"})," ","to join the discussion when it's back"]})]})}},8588:(n,t,e)=>{e.d(t,{U:()=>a});var s=e(43);function r(n,t){return t||(t=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(t)}}))}function o(){const n=r(["\n\t\t\t0% { opacity: 0; }\n\t\t\t100% { opacity: 1; }\n\t\t"]);return o=function(){return n},n}function i(){const n=r(["\n\t\t\t0% { opacity: 0; }\n\t\t\t100% { opacity: 1; }\n\t\t"]);return i=function(){return n},n}function c(){const n=r(["\n\t/* We're using classnames here because we add and remove these classes\n\t   using plain javascript */\n\t.reveal {\n\t\tanimation: "," 1s ease-out;\n\t}\n\t.reveal-slowly {\n\t\tanimation: "," 4s ease-out;\n\t}\n\t.pending {\n\t\tdisplay: none;\n\t}\n"]);return c=function(){return n},n}const a=(0,s.css)(c(),(0,s.keyframes)(o()),(0,s.keyframes)(i()))},4466:(n,t,e)=>{e.d(t,{h:()=>o});var s=e(6131);function r(n){if(!n.ok)throw Error(n.statusText||"useApi | An api call returned HTTP status ".concat(n.status));return n}const o=(n,t,e)=>{const{data:o,error:i}=(0,s.ZP)(n,(n=>t=>fetch(t,n).then(r).then((n=>n.json())))(e),t);return{data:o,error:i,loading:!!n&&!i&&!o}}},3786:(n,t,e)=>{e.d(t,{D:()=>r});var s=e(4466);const r=n=>{const{data:t}=(0,s.h)(n,{dedupingInterval:8e3});return{commentCount:null==t?void 0:t.discussion.commentCount,isClosedForComments:null==t?void 0:t.discussion.isClosedForComments}}}}]);
//# sourceMappingURL=DiscussionContainer-importable.modern.cb67bcd4c1c04f7c7a77.js.map